
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{The \clsnm{MBPT2} Class}
\label{MBPT2}\index{MBPT2}

The \clsnm{MBPT2} class derives from \clsnmref{Wavefunction}.
\clsnm{MBPT2} objects read the following input:

\begin{description}
  \item[\keywd{reference}] This gives the reference wavefunction.  It must
     be an \htmlref{object}{pkvobject} of type \clsnmref{CLSCF} for
     closed-shell molecules and \clsnmref{HSOSSCF} for open-shell
     molecules.  The is no default.

  \item[\keywd{nfzc}] The number of frozen core orbitals.  The default
     is 0.  If no atoms have an atomic number greater than 30, then
     the number of orbitals to be frozen can be automatically determined
     by specifying \keywd{nfzc = auto}.

  \item[\keywd{nfzv}] The number of frozen virtual orbitals.  The default
     is 0.

  \item[\keywd{memory}] The amount of memory, in bytes, that each processor
     may use.

  \item[\keywd{method}] This gives a string that must take on one of the
     values below.  The default is \keywd{mp} for closed-shell systems
     and \keywd{zapt} for open-shell systems.

      \begin{description}

        \item[\keywd{mp}] Use M\o{}ller-Plesset perturbation theory.  This
           is only valid for closed-shell systems.  Energies and
           gradients can be computed with this method.

        \item[\keywd{opt1}] Use the OPT1 variant of open-shell perturbation
           theory.  Only energies can be computed for open-shell systems.

        \item[\keywd{opt2}] Use the OPT2 variant of open-shell perturbation
           theory.  Only energies can be computed for open-shell systems.

        \item[\keywd{zapt}] Use the ZAPT variant of open-shell perturbation
           theory.  Only energies can be computed for open-shell systems.

     \end{description}

  \item[\keywd{algorithm}] This gives a string that must take on one of the
     values given below.  The default is \keywd{memgrp} for closed-shell
     systems.  For open-shell systems \keywd{v1} is used for a small number
     of processors and \keywd{v2} is used otherwise.

     \begin{description}

        \item[\keywd{memgrp}] Use the distributed shared memory algorithm
          (which uses a \clsnmref{MemoryGrp} object).  This is only valid
          for MP2 energies and gradients.

        \item[\keywd{v1}] Use algorithm V1.  Only energies can be
          computed.  The maximum number of processors that can be
          utilized is the number of virtual orbitals.  This algorithm
          computes few integrals than the others, but has higher
          communication requirements.

        \item[\keywd{v2}] Use algorithm V2.  Only energies can be
          computed.  The maximum number of processors that can be
          utilized is the number of shells.

        \item[\keywd{v2lb}] Use a modified V2 algorithm that may
          compute more two electron integrals, but may get better load
          balance on the $O(n_\mathrm{basis}^5)$ part of the
          calculation.  Only energies can be computed.  This is
          recommended only for computations involving large molecules
          (where the transformation is dominant) on very many
          processors (approaching the number of shells).

     \end{description}

     The \keywd{v1} and \keywd{v2} algorithms are discussed in Ida
     M. B. Nielsen and Edward T. Seidl, J. Comp. Chem. 16, 1301
     (1995).  The \keywd{memgrp} algorithm is discussed in Ida
     M. B. Nielsen, Chem. Phys. Lett. 255, 210 (1996).  

  \item[\keywd{memorygrp}] A \clsnmref{MemoryGrp}
     \htmlref{object}{pkvobject} that is used by the \type{memgrp}
     algorithm.  If this is not given the program will try to find an
     appropriate default.

  \item[\keywd{debug}] If this is nonzero, extra information is written to
     the output.  The default is 0.

\end{description}

