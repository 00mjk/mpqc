//
// Created by Eduard Valeyev on 7/12/18.
//

#include "catch.hpp"
#include "mpqc/chemistry/qc/lcao/scf/orbital_localization.h"

using namespace mpqc;

TEST_CASE("Foster-Boys Localizer", "[localizer]") {
  // only do in serial since this only uses Eigen
  if (TA::get_default_world().size() > 1)
    return;

  // FCH3F anion from BH76 test set, 3-21G basis
  // 6
  //
  // F                    0                   0   -1.79137122273729
  // C                    0                   0    -.36561700168727
  // H     -.51179109341343     .88644817665330    -.01758667541940
  // H     -.51179109341343    -.88644817665330    -.01758667541940
  // H     1.02358218682687                   0    -.01758667541940
  // F                    0                   0    2.20974825068278
  // this is a pathological example of FB localizer extramely sensitive to the
  // noise and taking a long time converging

  RowMatrixXd ao_s(33, 33);
  ao_s << 1, 0.191447444407957, 0, 0, 5.06584838699294e-17, 0.18031400189078, 0,
      0, -2.52776559628147e-18, 0.0199080570950185, 0.0818188507777989,
      0.0199080570950185, 0.0818188507777989, 0.0199080570950184,
      0.0818188507777988, 1.90145287297163e-13, 1.22238080871251e-05, 0, 0,
      4.82954055351829e-05, 0.0128607225116829, 0, 0, 0.0446616972082979,
      2.09590686220249e-41, 1.88256985075233e-16, 0, 0, -1.33931714693921e-15,
      8.34687777484152e-06, 0, 0, -5.21949520236495e-05, 0.191447444407957, 1,
      0, 0, 0, 0.761357406086864, 0, 0, -8.61281814502231e-17,
      0.199791329582372, 0.405301120792526, 0.199791329582372,
      0.405301120792526, 0.199791329582372, 0.405301120792526,
      0.00150738641706232, 0.0198564606890163, 0, 0, 0.0312885115676562,
      0.126281509027351, 0, 0, 0.281397403613173, 9.06447760242739e-09,
      2.01720047143969e-06, 0, 0, -5.36364048602423e-06, 0.00102819533554184, 0,
      0, -0.00425953285640236, 0, 0, 1, 0, 0, 0, 0.528958812039786, 0, 0,
      -0.14186543546692, -0.111418494318301, -0.14186543546692,
      -0.111418494318301, 0.283730870933842, 0.222836988636604, 0, 0,
      0.00940655207049297, 0, 0, 0, 0.0968609135334861, 0, 0, 0, 0,
      8.88708605787959e-07, 0, 0, 0, 0.000717271841246535, 0, 0, 0, 0, 0, 1, 0,
      0, 0, 0.528958812039786, 0, -0.245718142066593, -0.192982493062124,
      0.245718142066593, 0.192982493062124, 0, 0, 0, 0, 0, 0.00940655207049297,
      0, 0, 0, 0.0968609135334861, 0, 0, 0, 0, 8.88708605787959e-07, 0, 0, 0,
      0.000717271841246535, 0, 5.06584838699294e-17, 0, 0, 0, 1,
      -1.20923623529253e-16, 0, 0, 0.528958812039786, 0.0964719285409708,
      0.0757672718984749, 0.0964719285409708, 0.0757672718984749,
      0.0964719285409704, 0.0757672718984748, -0.00479894880093389,
      -0.0480023265061453, 0, 0, -0.0680828469993978, -0.181254205033954, 0, 0,
      -0.326960949695639, 5.20188559157688e-08, 8.89917666979564e-06, 0, 0,
      -2.28136208799566e-05, 0.00242447370030183, 0, 0, -0.0093822595541051,
      0.18031400189078, 0.761357406086864, 0, 0, -1.20923623529253e-16, 1, 0, 0,
      -9.82674699207067e-17, 0.342393482320297, 0.673049744775251,
      0.342393482320297, 0.673049744775251, 0.342393482320297,
      0.673049744775251, 0.0235882119919904, 0.125035400360445, 0, 0,
      0.0680383455137771, 0.313914922665618, 0, 0, 0.339263537316171,
      0.000984941399895602, 0.00675298758585051, 0, 0, -0.00643633775062442,
      0.0318490289163494, 0, 0, -0.0621749701493469, 0, 0, 0.528958812039787, 0,
      0, 0, 1, 0, 0, -0.238959011562868, -0.278451427161314, -0.238959011562868,
      -0.278451427161314, 0.477918023125739, 0.556902854322633, 0, 0,
      0.0570611686829047, 0, 0, 0, 0.284527405605961, 0, 0, 0, 0,
      0.00298835080339781, 0, 0, 0, 0.0288674443753376, 0, 0, 0, 0, 0,
      0.528958812039786, 0, 0, 0, 1, 0, -0.41388914895333, -0.482292019283466,
      0.41388914895333, 0.482292019283466, 0, 0, 0, 0, 0, 0.0570611686829047, 0,
      0, 0, 0.284527405605961, 0, 0, 0, 0, 0.00298835080339781, 0, 0, 0,
      0.0288674443753376, 0, -2.52776559628147e-18, -8.61281814502232e-17, 0, 0,
      0.528958812039786, -9.82674699207067e-17, 0, 0, 1, 0.162497909457934,
      0.189353707580882, 0.162497909457934, 0.189353707580882,
      0.162497909457934, 0.189353707580881, -0.0555327613827796,
      -0.270254874906903, 0, 0, -0.0917350323426839, -0.532431368156082, 0, 0,
      -0.290897769485613, 0.00418829423835446, 0.0264128836574454, 0, 0,
      -0.0224224702807599, 0.0975757804200155, 0, 0, -0.1616178370079,
      0.0199080570950185, 0.199791329582372, -0.14186543546692,
      -0.245718142066593, 0.0964719285409708, 0.342393482320297,
      -0.238959011562868, -0.41388914895333, 0.162497909457934, 1,
      0.645898940499237, 0.00805435165173698, 0.118462922833689,
      0.00805435165173724, 0.11846292283369, 1.99251156446652e-06,
      0.000133956736200306, -7.52438162036782e-05, -0.000130326112620147,
      0.000260782808026509, 0.00907390059909026, -0.00772287616812527,
      -0.013376413903756, 0.0267662305658849, 1.2719321900872e-08,
      2.93255585592713e-06, -1.6271872338562e-06, -2.81837096246644e-06,
      -7.08158270809879e-06, 0.00125574834348366, -0.00106615944706308,
      -0.00184664233128282, -0.00463996775989044, 0.0818188507777989,
      0.405301120792526, -0.111418494318301, -0.192982493062124,
      0.075767271898475, 0.673049744775251, -0.278451427161314,
      -0.482292019283466, 0.189353707580881, 0.645898940499237, 1,
      0.118462922833689, 0.357681196511282, 0.11846292283369, 0.357681196511284,
      0.00607747781331504, 0.0356495184454502, -0.00646446968818936,
      -0.011196789943933, 0.0224047987295714, 0.115576110575658,
      -0.042736127068732, -0.0740211434017643, 0.148116453729481,
      0.00188074073909546, 0.0120619395991937, -0.00216437229450125,
      -0.00374880278057063, -0.00941943317629459, 0.0488872987366331,
      -0.0180768655429719, -0.0313100495620188, -0.0786712283517392,
      0.0199080570950185, 0.199791329582372, -0.14186543546692,
      0.245718142066593, 0.0964719285409708, 0.342393482320297,
      -0.238959011562868, 0.41388914895333, 0.162497909457934,
      0.00805435165173698, 0.118462922833689, 1, 0.645898940499237,
      0.00805435165173724, 0.11846292283369, 1.99251156446652e-06,
      0.000133956736200306, -7.52438162036782e-05, 0.000130326112620147,
      0.000260782808026509, 0.00907390059909026, -0.00772287616812527,
      0.013376413903756, 0.0267662305658849, 1.2719321900872e-08,
      2.93255585592713e-06, -1.6271872338562e-06, 2.81837096246644e-06,
      -7.08158270809879e-06, 0.00125574834348366, -0.00106615944706308,
      0.00184664233128282, -0.00463996775989044, 0.0818188507777989,
      0.405301120792526, -0.111418494318301, 0.192982493062124,
      0.075767271898475, 0.673049744775251, -0.278451427161314,
      0.482292019283466, 0.189353707580881, 0.118462922833689,
      0.357681196511282, 0.645898940499237, 1, 0.11846292283369,
      0.357681196511284, 0.00607747781331504, 0.0356495184454502,
      -0.00646446968818936, 0.011196789943933, 0.0224047987295714,
      0.115576110575658, -0.042736127068732, 0.0740211434017643,
      0.148116453729481, 0.00188074073909546, 0.0120619395991937,
      -0.00216437229450125, 0.00374880278057063, -0.00941943317629459,
      0.0488872987366331, -0.0180768655429719, 0.0313100495620188,
      -0.0786712283517392, 0.0199080570950184, 0.199791329582372,
      0.283730870933842, 0, 0.0964719285409704, 0.342393482320297,
      0.477918023125739, 0, 0.162497909457934, 0.00805435165173724,
      0.11846292283369, 0.00805435165173724, 0.11846292283369, 1,
      0.645898940499237, 1.9925115644665e-06, 0.000133956736200305,
      0.000150487632407357, 0, 0.000260782808026508, 0.00907390059909023,
      0.0154457523362506, 0, 0.0267662305658848, 1.27193219008719e-08,
      2.93255585592711e-06, 3.25437446771242e-06, 0, -7.08158270809875e-06,
      0.00125574834348365, 0.00213231889412618, 0, -0.00463996775989042,
      0.0818188507777988, 0.405301120792526, 0.222836988636604, 0,
      0.0757672718984748, 0.673049744775251, 0.556902854322633, 0,
      0.189353707580881, 0.11846292283369, 0.357681196511284, 0.11846292283369,
      0.357681196511284, 0.645898940499237, 1, 0.00607747781331503,
      0.0356495184454501, 0.0129289393763788, 0, 0.0224047987295714,
      0.115576110575658, 0.0854722541374648, 0, 0.148116453729481,
      0.00188074073909546, 0.0120619395991937, 0.00432874458900253, 0,
      -0.00941943317629457, 0.048887298736633, 0.036153731085944, 0,
      -0.0786712283517391, 1.90145287297163e-13, 0.00150738641706232, 0, 0,
      -0.00479894880093389, 0.0235882119919904, 0, 0, -0.0555327613827796,
      1.99251156446651e-06, 0.00607747781331504, 1.99251156446651e-06,
      0.00607747781331504, 1.9925115644665e-06, 0.00607747781331503, 1,
      0.214713613964071, 0, 0, 9.40774688586289e-16, 0.183583300654873, 0, 0, 0,
      8.53306084758114e-168, 7.1741708863416e-46, 0, 0, -9.45134600100766e-45,
      4.65369774439942e-13, 0, 0, -4.72810381049709e-12, 1.22238080871251e-05,
      0.0198564606890164, 0, 0, -0.0480023265061454, 0.125035400360445, 0, 0,
      -0.270254874906903, 0.000133956736200306, 0.0356495184454502,
      0.000133956736200306, 0.0356495184454502, 0.000133956736200305,
      0.0356495184454501, 0.214713613964071, 1, 0, 0, -2.42584369749259e-16,
      0.732193301398789, 0, 0, 6.92121230491094e-17, 7.1741708863416e-46,
      1.89250388232771e-26, 0, 0, -1.44019006067142e-25, 1.57732318519412e-10,
      0, 0, -1.34487391957912e-09, 0, 0, 0.00940655207049298, 0, 0, 0,
      0.0570611686829047, 0, 0, -7.52438162036782e-05, -0.00646446968818936,
      -7.52438162036782e-05, -0.00646446968818936, 0.000150487632407357,
      0.0129289393763788, 0, 0, 1, 0, 0, 0, 0.4883697591583, 0, 0, 0, 0,
      9.18951033603827e-27, 0, 0, 0, 8.62006650728932e-11, 0, 0, 0, 0, 0,
      0.00940655207049297, 0, 0, 0, 0.0570611686829047, 0,
      -0.000130326112620147, -0.011196789943933, 0.000130326112620147,
      0.011196789943933, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0.4883697591583, 0, 0, 0, 0,
      9.18951033603827e-27, 0, 0, 0, 8.62006650728932e-11, 0,
      4.82954055351828e-05, 0.0312885115676562, 0, 0, -0.0680828469993979,
      0.0680383455137771, 0, 0, -0.0917350323426838, 0.000260782808026509,
      0.0224047987295714, 0.000260782808026509, 0.0224047987295714,
      0.000260782808026508, 0.0224047987295714, 9.40774688586289e-16,
      -2.42584369749259e-16, 0, 0, 1, -1.88709429716e-16, 0, 0, 0.4883697591583,
      9.45134600100766e-45, 1.44019006067142e-25, 0, 0, -1.08679102118373e-24,
      4.52675510763313e-10, 0, 0, -3.77614786467776e-09, 0.0128607225116829,
      0.126281509027351, 0, 0, -0.181254205033954, 0.313914922665618, 0, 0,
      -0.532431368156082, 0.00907390059909027, 0.115576110575658,
      0.00907390059909027, 0.115576110575658, 0.00907390059909024,
      0.115576110575658, 0.183583300654873, 0.732193301398789, 0, 0,
      -1.88709429716e-16, 1, 0, 0, 0, 4.65369774439942e-13,
      1.57732318519412e-10, 0, 0, -4.52675510763313e-10, 1.02719116602964e-06,
      0, 0, -5.39420763564676e-06, 0, 0, 0.0968609135334861, 0, 0, 0,
      0.284527405605961, 0, 0, -0.00772287616812528, -0.042736127068732,
      -0.00772287616812528, -0.042736127068732, 0.0154457523362507,
      0.0854722541374648, 0, 0, 0.4883697591583, 0, 0, 0, 1, 0, 0, 0, 0,
      8.62006650728932e-11, 0, 0, 0, 1.02719116602964e-06, 0, 0, 0, 0, 0,
      0.0968609135334861, 0, 0, 0, 0.284527405605961, 0, -0.013376413903756,
      -0.0740211434017643, 0.013376413903756, 0.0740211434017643, 0, 0, 0, 0, 0,
      0.4883697591583, 0, 0, 0, 1, 0, 0, 0, 0, 8.62006650728932e-11, 0, 0, 0,
      1.02719116602964e-06, 0, 0.0446616972082979, 0.281397403613173, 0, 0,
      -0.326960949695639, 0.339263537316171, 0, 0, -0.290897769485612,
      0.0267662305658849, 0.148116453729481, 0.0267662305658849,
      0.148116453729481, 0.0267662305658848, 0.148116453729481, 0,
      6.92121230491094e-17, 0, 0, 0.4883697591583, 0, 0, 0, 1,
      4.72810381049709e-12, 1.34487391957912e-09, 0, 0, -3.77614786467776e-09,
      5.39420763564676e-06, 0, 0, -2.73000345527615e-05, 2.09590686220249e-41,
      9.06447760242739e-09, 0, 0, 5.20188559157688e-08, 0.000984941399895602, 0,
      0, 0.00418829423835446, 1.2719321900872e-08, 0.00188074073909546,
      1.2719321900872e-08, 0.00188074073909546, 1.27193219008719e-08,
      0.00188074073909545, 8.53306084758114e-168, 7.1741708863416e-46, 0, 0,
      9.45134600100766e-45, 4.65369774439942e-13, 0, 0, 4.72810381049709e-12, 1,
      0.214713613964071, 0, 0, -9.47376694302358e-16, 0.183583300654873, 0, 0,
      0, 1.88256985075232e-16, 2.01720047143969e-06, 0, 0, 8.89917666979567e-06,
      0.00675298758585051, 0, 0, 0.0264128836574454, 2.93255585592713e-06,
      0.0120619395991937, 2.93255585592713e-06, 0.0120619395991937,
      2.93255585592711e-06, 0.0120619395991937, 7.1741708863416e-46,
      1.89250388232771e-26, 0, 0, 1.44019006067142e-25, 1.57732318519412e-10, 0,
      0, 1.34487391957912e-09, 0.214713613964071, 1, 0, 0, 5.21641100331199e-16,
      0.732193301398789, 0, 0, 0, 0, 0, 8.88708605787963e-07, 0, 0, 0,
      0.00298835080339781, 0, 0, -1.6271872338562e-06, -0.00216437229450125,
      -1.6271872338562e-06, -0.00216437229450125, 3.25437446771242e-06,
      0.00432874458900253, 0, 0, 9.18951033603827e-27, 0, 0, 0,
      8.62006650728932e-11, 0, 0, 0, 0, 1, 0, 0, 0, 0.4883697591583, 0, 0, 0, 0,
      0, 8.88708605787962e-07, 0, 0, 0, 0.00298835080339781, 0,
      -2.81837096246644e-06, -0.00374880278057063, 2.81837096246644e-06,
      0.00374880278057063, 0, 0, 0, 0, 0, 9.18951033603827e-27, 0, 0, 0,
      8.62006650728932e-11, 0, 0, 0, 0, 1, 0, 0, 0, 0.4883697591583, 0,
      -1.3393171469392e-15, -5.36364048602425e-06, 0, 0, -2.28136208799567e-05,
      -0.00643633775062442, 0, 0, -0.0224224702807599, -7.08158270809879e-06,
      -0.00941943317629459, -7.08158270809879e-06, -0.00941943317629459,
      -7.08158270809875e-06, -0.00941943317629457, -9.45134600100766e-45,
      -1.44019006067142e-25, 0, 0, -1.08679102118373e-24, -4.52675510763313e-10,
      0, 0, -3.77614786467776e-09, -9.47376694302358e-16, 5.21641100331199e-16,
      0, 0, 1, 0, 0, 0, 0.4883697591583, 8.34687777484151e-06,
      0.00102819533554184, 0, 0, 0.00242447370030183, 0.0318490289163494, 0, 0,
      0.0975757804200155, 0.00125574834348366, 0.0488872987366331,
      0.00125574834348366, 0.0488872987366331, 0.00125574834348365,
      0.048887298736633, 4.65369774439942e-13, 1.57732318519412e-10, 0, 0,
      4.52675510763313e-10, 1.02719116602964e-06, 0, 0, 5.39420763564676e-06,
      0.183583300654873, 0.732193301398789, 0, 0, 0, 1, 0, 0, 0, 0, 0,
      0.000717271841246535, 0, 0, 0, 0.0288674443753376, 0, 0,
      -0.00106615944706308, -0.0180768655429719, -0.00106615944706308,
      -0.0180768655429719, 0.00213231889412618, 0.036153731085944, 0, 0,
      8.62006650728932e-11, 0, 0, 0, 1.02719116602964e-06, 0, 0, 0, 0,
      0.4883697591583, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0.000717271841246535, 0, 0, 0,
      0.0288674443753376, 0, -0.00184664233128282, -0.0313100495620188,
      0.00184664233128282, 0.0313100495620188, 0, 0, 0, 0, 0,
      8.62006650728932e-11, 0, 0, 0, 1.02719116602964e-06, 0, 0, 0, 0,
      0.4883697591583, 0, 0, 0, 1, 0, -5.21949520236495e-05,
      -0.00425953285640236, 0, 0, -0.0093822595541051, -0.0621749701493469, 0,
      0, -0.1616178370079, -0.00463996775989044, -0.0786712283517392,
      -0.00463996775989044, -0.0786712283517392, -0.00463996775989043,
      -0.0786712283517391, -4.72810381049709e-12, -1.34487391957912e-09, 0, 0,
      -3.77614786467776e-09, -5.39420763564676e-06, 0, 0, -2.73000345527615e-05,
      0, 0, 0, 0, 0.4883697591583, 0, 0, 0, 1;

  RowMatrixXd ao_x(33, 33);
  ao_x << 0, 0, 0.0828819774872559, 0, 0, 0, 0.0122968960884087, 0, 0,
      -0.00226161675586982, -0.00224415081455854, -0.00226161675586982,
      -0.00224415081455854, 0.00452323351173964, 0.00448830162911712, 0, 0,
      1.60120545833032e-06, 0, 0, 0, 0.00133510528759952, 0, 0, 0, 0,
      2.48669343196379e-17, 0, 0, 0, 9.01366374465513e-07, 0, 0, 0, 0,
      0.608935134867267, 0, 0, 0, 0.388177460034424, 0, 0, -0.106731899481163,
      -0.0827130686587794, -0.106731899481163, -0.0827130686587794,
      0.213463798962328, 0.16542613731756, 0, 0, 0.00755484918880189, 0, 0, 0,
      0.073564239522464, 0, 0, 0, 0, 7.15144763549796e-07, 0, 0, 0,
      0.000573203477209271, 0, 0, 0.0828819774872559, 0.608935134867267, 0, 0,
      0, 0.597616131440864, 0, 0, -5.53761656983524e-17, 0.156763475693514,
      0.334350308420708, 0.156763475693514, 0.334350308420708,
      0.370428606706118, 0.394099897825027, 5.97416744321778e-05,
      0.00449626687998589, 0, 0, 0.00672458817926473, 0.0697304660732807, 0, 0,
      0.163048885125048, 3.73597644664805e-10, 4.40076638044233e-07, 0, 0,
      -1.16483099488171e-06, 0.000516366178748355, 0, 0, -0.00215100557004084,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0.123359620906563, 0.0344964415265529,
      -0.123359620906563, -0.0344964415265529, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -5.53761656983524e-17, 0, 0,
      -0.0484324862334093, -0.0135437221439086, -0.0484324862334093,
      -0.0135437221439086, 0.0968649724668191, 0.0270874442878174, 0, 0,
      -0.0186193439540101, 0, 0, 0, -0.0979220211712296, 0, 0, 0, 0,
      3.16027827966442e-06, 0, 0, 0, 0.00133976640261895, 0, 0, 0, 0,
      0.597616131440864, 0, 0, 0, 1.12979709920385, 0, 0, -0.269975198092346,
      -0.314593614676024, -0.269975198092346, -0.314593614676024,
      0.539950396184697, 0.629187229352054, 0, 0, 0.0644675428551272, 0, 0, 0,
      0.321458237497611, 0, 0, 0, 0, 0.00337623006908233, 0, 0, 0,
      0.0326143549166848, 0, 0, 0.0122968960884087, 0.388177460034424, 0, 0,
      -5.53761656983524e-17, 1.12979709920385, 0, 0, -1.11022302462516e-16,
      0.331637174645771, 0.915969289453414, 0.331637174645771,
      0.915969289453414, 0.897811551483642, 1.30642649560671,
      0.000681507565704133, 0.0264579631290975, 0, 0, 0.0127520030640093,
      0.204832144151377, 0, 0, 0.221372329772531, 2.8566178289141e-05,
      0.00140393194790411, 0, 0, -0.00121407138472492, 0.0207817609519127, 0, 0,
      -0.0405696942983636, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.326880928875609,
      0.225430573079631, -0.326880928875609, -0.225430573079631, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -5.53761656983524e-17,
      0, 0, 0, -1.11022302462516e-16, 0, 0, -0.128337424931968,
      -0.0885067824222534, -0.128337424931968, -0.0885067824222534,
      0.256674849863938, 0.177013564844509, 0, 0, -0.140987047728179, 0, 0, 0,
      -0.54522559087836, 0, 0, 0, 0, 0.0133294400555784, 0, 0, 0,
      0.0999205075372724, 0, 0, -0.00226161675586982, -0.106731899481163,
      0.156763475693514, 0.123359620906563, -0.0484324862334093,
      -0.269975198092346, 0.331637174645771, 0.326880928875609,
      -0.128337424931968, -0.967144999543077, -0.624677930514008,
      -0.00778972592453894, -0.114570823449859, 0.00389486296226968,
      -0.0540457504142142, -1.0355867326851e-07, -3.7025488747261e-05,
      6.76995273230266e-05, 3.55454355494099e-05, -7.11264865401001e-05,
      -0.00555972202805452, 0.00952855706165252, 0.0082112329539633,
      -0.0164306933126718, -6.71087109074579e-10, -8.05793479351883e-07,
      1.46536981807822e-06, 7.70994870717492e-07, 1.93724105776614e-06,
      -0.000767531426661987, 0.00131755076184049, 0.00112956462750656,
      0.00283820172729508, -0.00224415081455854, -0.0827130686587794,
      0.334350308420708, 0.0344964415265529, -0.0135437221439086,
      -0.314593614676024, 0.915969289453413, 0.225430573079631,
      -0.0885067824222534, -0.624677930514008, -0.967144999543076,
      -0.114570823449859, -0.345929580636471, 0.168616573864077,
      0.17296479031824, -7.046468205974e-05, -0.00301466956237444,
      0.0187324605998538, 0.000847148203251199, -0.0016951452231401,
      -0.0307658677784347, 0.131981663127626, 0.0197041127216032,
      -0.0394279683626212, -2.18349303189738e-05, -0.0010138671081607,
      0.0062721828753895, 0.000284255004833402, 0.000714233631316279,
      -0.0130135904512162, 0.0558266493044356, 0.00833460167644877,
      0.0209419455057041, -0.00226161675586982, -0.106731899481163,
      0.156763475693514, -0.123359620906563, -0.0484324862334093,
      -0.269975198092346, 0.331637174645771, -0.326880928875609,
      -0.128337424931968, -0.00778972592453894, -0.114570823449859,
      -0.967144999543077, -0.624677930514008, 0.00389486296226968,
      -0.0540457504142142, -1.0355867326851e-07, -3.7025488747261e-05,
      6.76995273230266e-05, -3.55454355494099e-05, -7.11264865401001e-05,
      -0.00555972202805452, 0.00952855706165252, -0.0082112329539633,
      -0.0164306933126718, -6.71087109074579e-10, -8.05793479351883e-07,
      1.46536981807822e-06, -7.70994870717492e-07, 1.93724105776614e-06,
      -0.000767531426661987, 0.00131755076184049, -0.00112956462750656,
      0.00283820172729508, -0.00224415081455854, -0.0827130686587794,
      0.334350308420708, -0.0344964415265529, -0.0135437221439086,
      -0.314593614676024, 0.915969289453413, -0.225430573079631,
      -0.0885067824222534, -0.114570823449859, -0.345929580636471,
      -0.624677930514008, -0.967144999543076, 0.168616573864077,
      0.17296479031824, -7.046468205974e-05, -0.00301466956237444,
      0.0187324605998538, -0.000847148203251199, -0.0016951452231401,
      -0.0307658677784347, 0.131981663127626, -0.0197041127216032,
      -0.0394279683626212, -2.18349303189738e-05, -0.0010138671081607,
      0.0062721828753895, -0.000284255004833402, 0.000714233631316279,
      -0.0130135904512162, 0.0558266493044356, -0.00833460167644877,
      0.0209419455057041, 0.00452323351173965, 0.213463798962328,
      0.370428606706118, 0, 0.0968649724668191, 0.539950396184697,
      0.897811551483642, 0, 0.256674849863938, 0.00389486296226967,
      0.168616573864077, 0.00389486296226967, 0.168616573864077,
      1.93428999908617, 1.24935586102803, 2.0711734653702e-07,
      7.40509774945222e-05, 0.00012926602767177, 0, 0.000142252973080201,
      0.0111194440561091, 0.023750829730701, 0, 0.0328613866253439,
      1.34217421814916e-09, 1.61158695870377e-06, 2.80077210653592e-06, 0,
      -3.87448211553229e-06, 0.00153506285332398, 0.00327401408711449, 0,
      -0.00567640345459019, 0.00448830162911712, 0.16542613731756,
      0.394099897825027, 0, 0.0270874442878174, 0.629187229352054,
      1.30642649560671, 0, 0.177013564844508, -0.0540457504142141,
      0.17296479031824, -0.0540457504142141, 0.17296479031824, 1.24935586102803,
      1.93428999908617, 0.000140929364119481, 0.00602933912474893,
      0.0201997643294256, 0, 0.00339029044628023, 0.0615317355568699,
      0.166110187479507, 0, 0.0788559367252431, 4.36698606379479e-05,
      0.00202773421632141, 0.00676452698606669, 0, -0.00142846726263257,
      0.0260271809024327, 0.0702626028688937, 0, -0.0418838910114085, 0, 0,
      5.97416744321778e-05, 0, 0, 0, 0.000681507565704133, 0, 0,
      -1.0355867326851e-07, -7.04646820597398e-05, -1.0355867326851e-07,
      -7.04646820597398e-05, 2.07117346537019e-07, 0.000140929364119482, 0, 0,
      0.0584153412812247, 0, 0, 0, 0.00812130938299834, 0, 0, 0, 0,
      4.65240559682284e-47, 0, 0, 0, 2.1878646799136e-14, 0, 0, 0, 0,
      0.0044962668799859, 0, 0, 0, 0.0264579631290975, 0, 0,
      -3.7025488747261e-05, -0.00301466956237444, -3.7025488747261e-05,
      -0.00301466956237444, 7.40509774945222e-05, 0.00602933912474892, 0, 0,
      0.369574756982322, 0, 0, 0, 0.220728736729064, 0, 0, 0, 0,
      4.56519918734971e-27, 0, 0, 0, 4.27386465153178e-11, 0, 0,
      1.60120545833031e-06, 0.00755484918880189, 0, 0, -0.0186193439540101,
      0.0644675428551272, 0, 0, -0.140987047728179, 6.76995273230266e-05,
      0.0187324605998538, 6.76995273230266e-05, 0.0187324605998538,
      0.00012926602767177, 0.0201997643294256, 0.0584153412812247,
      0.369574756982322, 0, 0, -2.15936941337612e-16, 0.351578874077324, 0, 0,
      -1.27744844311618e-17, 4.65240559682284e-47, 4.56519918734971e-27, 0, 0,
      -3.47410357040832e-26, 6.20561208033785e-11, 0, 0, -5.29479420132092e-10,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 3.55454355494099e-05, 0.000847148203251198,
      -3.55454355494099e-05, -0.000847148203251198, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00672458817926473, 0, 0, 0,
      0.0127520030640093, 0, 0, -7.11264865401001e-05, -0.0016951452231401,
      -7.11264865401001e-05, -0.0016951452231401, 0.000142252973080201,
      0.00339029044628022, 0, 0, -2.15936941337612e-16, 0, 0, 0,
      -1.27744844311618e-17, 0, 0, 0, 0, 3.47410357040832e-26, 0, 0, 0,
      1.22285532189439e-10, 0, 0, 0, 0, 0.0697304660732807, 0, 0, 0,
      0.204832144151377, 0, 0, -0.00555972202805453, -0.0307658677784347,
      -0.00555972202805453, -0.0307658677784347, 0.0111194440561091,
      0.0615317355568699, 0, 0, 0.351578874077324, 0, 0, 0, 0.71990303962159, 0,
      0, 0, 0, 6.20561208033785e-11, 0, 0, 0, 7.39478042697181e-07, 0, 0,
      0.00133510528759952, 0.073564239522464, 0, 0, -0.0979220211712296,
      0.321458237497611, 0, 0, -0.54522559087836, 0.00952855706165253,
      0.131981663127626, 0.00952855706165253, 0.131981663127626,
      0.023750829730701, 0.166110187479507, 0.00812130938299834,
      0.220728736729064, 0, 0, -1.27744844311618e-17, 0.71990303962159, 0, 0, 0,
      2.1878646799136e-14, 4.27386465153178e-11, 0, 0, -1.22285532189439e-10,
      7.39478042697181e-07, 0, 0, -3.88330647325209e-06, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0.00821123295396331, 0.0197041127216032, -0.00821123295396331,
      -0.0197041127216032, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0.163048885125048, 0, 0, 0, 0.221372329772531, 0, 0,
      -0.0164306933126719, -0.0394279683626212, -0.0164306933126719,
      -0.0394279683626212, 0.0328613866253439, 0.078855936725243, 0, 0,
      -1.27744844311618e-17, 0, 0, 0, 0, 0, 0, 0, 0, 5.29479420132092e-10, 0, 0,
      0, 3.88330647325209e-06, 0, 0, 0, 0, 3.73597644664805e-10, 0, 0, 0,
      2.8566178289141e-05, 0, 0, -6.71087109074578e-10, -2.18349303189738e-05,
      -6.71087109074578e-10, -2.18349303189738e-05, 1.34217421814916e-09,
      4.36698606379481e-05, 0, 0, 4.65240559682284e-47, 0, 0, 0,
      2.1878646799136e-14, 0, 0, 0, 0, 0.0584153412812247, 0, 0, 0,
      0.00812130938299834, 0, 0, 0, 0, 4.40076638044235e-07, 0, 0, 0,
      0.00140393194790411, 0, 0, -8.05793479351883e-07, -0.0010138671081607,
      -8.05793479351883e-07, -0.0010138671081607, 1.61158695870377e-06,
      0.00202773421632141, 0, 0, 4.56519918734971e-27, 0, 0, 0,
      4.27386465153178e-11, 0, 0, 0, 0, 0.369574756982322, 0, 0, 0,
      0.220728736729064, 0, 0, 2.48669343196377e-17, 7.15144763549799e-07, 0, 0,
      3.16027827966443e-06, 0.00337623006908233, 0, 0, 0.0133294400555784,
      1.46536981807822e-06, 0.0062721828753895, 1.46536981807822e-06,
      0.0062721828753895, 2.80077210653592e-06, 0.00676452698606668,
      4.65240559682284e-47, 4.56519918734971e-27, 0, 0, 3.47410357040832e-26,
      6.20561208033785e-11, 0, 0, 5.29479420132092e-10, 0.0584153412812247,
      0.369574756982322, 0, 0, 1.88913658180811e-16, 0.351578874077324, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 7.70994870717491e-07, 0.000284255004833402,
      -7.70994870717491e-07, -0.000284255004833402, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1.16483099488171e-06, 0, 0, 0,
      -0.00121407138472492, 0, 0, 1.93724105776614e-06, 0.000714233631316279,
      1.93724105776614e-06, 0.000714233631316279, -3.87448211553229e-06,
      -0.00142846726263257, 0, 0, -3.47410357040832e-26, 0, 0, 0,
      -1.22285532189439e-10, 0, 0, 0, 0, 1.88913658180811e-16, 0, 0, 0, 0, 0, 0,
      0, 0, 0.000516366178748355, 0, 0, 0, 0.0207817609519127, 0, 0,
      -0.000767531426661988, -0.0130135904512162, -0.000767531426661988,
      -0.0130135904512162, 0.00153506285332399, 0.0260271809024327, 0, 0,
      6.20561208033785e-11, 0, 0, 0, 7.39478042697181e-07, 0, 0, 0, 0,
      0.351578874077324, 0, 0, 0, 0.71990303962159, 0, 0, 9.01366374465513e-07,
      0.000573203477209271, 0, 0, 0.00133976640261895, 0.0326143549166848, 0, 0,
      0.0999205075372723, 0.00131755076184049, 0.0558266493044356,
      0.00131755076184049, 0.0558266493044356, 0.00327401408711449,
      0.0702626028688937, 2.1878646799136e-14, 4.27386465153178e-11, 0, 0,
      1.22285532189439e-10, 7.39478042697181e-07, 0, 0, 3.88330647325209e-06,
      0.00812130938299834, 0.220728736729064, 0, 0, 0, 0.71990303962159, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00112956462750656, 0.00833460167644878,
      -0.00112956462750656, -0.00833460167644878, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.00215100557004084, 0, 0, 0,
      -0.0405696942983636, 0, 0, 0.00283820172729508, 0.0209419455057041,
      0.00283820172729508, 0.0209419455057041, -0.0056764034545902,
      -0.0418838910114085, 0, 0, -5.29479420132092e-10, 0, 0, 0,
      -3.88330647325209e-06, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;

  RowMatrixXd ao_y(33, 33);
  ao_y << 0, 0, 0, 0.0828819774872559, 0, 0, 0, 0.0122968960884087, 0,
      -0.00391723512841567, -0.00388698323066253, 0.00391723512841567,
      0.00388698323066253, 0, 0, 0, 0, 0, 1.60120545833032e-06, 0, 0, 0,
      0.00133510528759952, 0, 0, 0, 0, 2.48669343196379e-17, 0, 0, 0,
      9.01366374465513e-07, 0, 0, 0, 0, 0.608935134867267, 0, 0, 0,
      0.388177460034424, 0, -0.184865072689711, -0.14326323736694,
      0.184865072689711, 0.14326323736694, 0, 0, 0, 0, 0, 0.00755484918880188,
      0, 0, 0, 0.073564239522464, 0, 0, 0, 0, 7.15144763549796e-07, 0, 0, 0,
      0.000573203477209271, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.123359620906563,
      0.0344964415265529, -0.123359620906563, -0.0344964415265529, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0828819774872559,
      0.608935134867267, 0, 0, 0, 0.597616131440864, 0, 0,
      -5.53761656983524e-17, 0.299206896368585, 0.374183368023588,
      0.299206896368585, 0.374183368023588, 0.0855417653559802,
      0.314433778619269, 5.97416744321778e-05, 0.00449626687998589, 0, 0,
      0.00672458817926473, 0.0697304660732807, 0, 0, 0.163048885125048,
      3.73597644664805e-10, 4.40076638044233e-07, 0, 0, -1.16483099488171e-06,
      0.000516366178748355, 0, 0, -0.00215100557004084, 0, 0, 0, 0, 0, 0, 0,
      -5.53761656983524e-17, 0, -0.083887526893146, -0.0234584148768456,
      0.083887526893146, 0.0234584148768456, 0, 0, 0, 0, 0, -0.0186193439540101,
      0, 0, 0, -0.0979220211712296, 0, 0, 0, 0, 3.16027827966442e-06, 0, 0, 0,
      0.00133976640261895, 0, 0, 0, 0, 0.597616131440864, 0, 0, 0,
      1.12979709920385, 0, -0.467610759879421, -0.544892124355626,
      0.467610759879421, 0.544892124355626, 0, 0, 0, 0, 0, 0.0644675428551272,
      0, 0, 0, 0.321458237497611, 0, 0, 0, 0, 0.00337623006908233, 0, 0, 0,
      0.0326143549166848, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.326880928875609,
      0.225430573079631, -0.326880928875609, -0.225430573079631, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0122968960884087,
      0.388177460034424, 0, 0, -5.53761656983524e-17, 1.12979709920385, 0, 0,
      -1.11022302462516e-16, 0.709086759204355, 1.17627409355561,
      0.709086759204355, 1.17627409355561, 0.142912382366485, 0.785816887402318,
      0.000681507565704133, 0.0264579631290975, 0, 0, 0.0127520030640093,
      0.204832144151377, 0, 0, 0.221372329772531, 2.8566178289141e-05,
      0.00140393194790411, 0, 0, -0.00121407138472492, 0.0207817609519127, 0, 0,
      -0.0405696942983636, 0, 0, 0, -5.53761656983524e-17, 0, 0, 0,
      -1.11022302462516e-16, 0, -0.222286940494728, -0.153298243969789,
      0.222286940494728, 0.153298243969789, 0, 0, 0, 0, 0, -0.140987047728179,
      0, 0, 0, -0.54522559087836, 0, 0, 0, 0, 0.0133294400555784, 0, 0, 0,
      0.0999205075372724, 0, -0.00391723512841567, -0.184865072689711,
      0.123359620906563, 0.299206896368585, -0.083887526893146,
      -0.467610759879421, 0.326880928875609, 0.709086759204355,
      -0.222286940494728, -1.67514427749481, -1.08197391401725,
      -6.7762635780344e-21, -0.128554152860458, -0.00674610053916924,
      -0.163498320070312, -1.79368883665486e-07, -6.41300276853265e-05,
      3.55454355494099e-05, 0.000108743860888856, -0.000123194688451319,
      -0.00962972102855042, 0.0082112329539633, 0.0190100721743516,
      -0.0284587956211301, -1.1623569692217e-09, -1.39567524664518e-06,
      7.70994870717492e-07, 2.35563801038337e-06, 3.35539993855946e-06,
      -0.0013294034273844, 0.00112956462750656, 0.0026218596453565,
      0.00491590959380488, -0.00388698323066252, -0.14326323736694,
      0.0344964415265529, 0.374183368023588, -0.0234584148768456,
      -0.544892124355626, 0.225430573079631, 1.17627409355561,
      -0.153298243969789, -1.08197391401725, -1.67514427749481,
      0.128554152860458, 0, -0.0349441672098524, -0.299583804751687,
      -0.000122048409466658, -0.00522156085006402, 0.000847148203251199,
      0.019710663086235, -0.00293607765268637, -0.0532880461311957,
      0.0197041127216032, 0.154734012695547, -0.068291244443279,
      -3.78192086921892e-05, -0.00175606934345728, 0.000284255004833402,
      0.00660041228250764, 0.00123708893791423, -0.0225401998503999,
      0.00833460167644877, 0.0654506183474078, 0.0362725136252185,
      0.00391723512841567, 0.184865072689711, -0.123359620906563,
      0.299206896368585, 0.083887526893146, 0.467610759879421,
      -0.326880928875609, 0.709086759204355, 0.222286940494728,
      6.7762635780344e-21, 0.128554152860458, 1.67514427749481,
      1.08197391401725, 0.00674610053916924, 0.163498320070312,
      1.79368883665486e-07, 6.41300276853265e-05, -3.55454355494099e-05,
      0.000108743860888856, 0.000123194688451319, 0.00962972102855042,
      -0.0082112329539633, 0.0190100721743516, 0.0284587956211301,
      1.1623569692217e-09, 1.39567524664518e-06, -7.70994870717492e-07,
      2.35563801038337e-06, -3.35539993855946e-06, 0.0013294034273844,
      -0.00112956462750656, 0.0026218596453565, -0.00491590959380488,
      0.00388698323066252, 0.14326323736694, -0.0344964415265529,
      0.374183368023588, 0.0234584148768456, 0.544892124355626,
      -0.225430573079631, 1.17627409355561, 0.153298243969789,
      -0.128554152860458, 0, 1.08197391401725, 1.67514427749481,
      0.0349441672098524, 0.299583804751687, 0.000122048409466658,
      0.00522156085006402, -0.000847148203251199, 0.019710663086235,
      0.00293607765268637, 0.0532880461311957, -0.0197041127216032,
      0.154734012695547, 0.068291244443279, 3.78192086921892e-05,
      0.00175606934345728, -0.000284255004833402, 0.00660041228250764,
      -0.00123708893791423, 0.0225401998503999, -0.00833460167644877,
      0.0654506183474078, -0.0362725136252185, 0, 0, 0, 0.0855417653559802, 0,
      0, 0, 0.142912382366485, 0, -0.00674610053916924, -0.0349441672098524,
      0.00674610053916924, 0.0349441672098524, 0, 0, 0, 0, 0,
      4.71773605401122e-05, 0, 0, 0, 0.00478779950530312, 0, 0, 0, 0,
      1.02023572192566e-06, 0, 0, 0, 0.000665396320082498, 0, 0, 0, 0,
      0.314433778619269, 0, 0, 0, 0.785816887402318, 0, -0.163498320070312,
      -0.299583804751687, 0.163498320070312, 0.299583804751687, 0, 0, 0, 0, 0,
      0.0182433593566632, 0, 0, 0, 0.120605488343666, 0, 0, 0, 0,
      0.00610806817183043, 0, 0, 0, 0.0510146647829496, 0, 0, 0, 0,
      5.97416744321778e-05, 0, 0, 0, 0.000681507565704133, 0,
      -1.79368883665485e-07, -0.000122048409466658, 1.79368883665485e-07,
      0.000122048409466658, 0, 0, 0, 0, 0, 0.0584153412812247, 0, 0, 0,
      0.00812130938299834, 0, 0, 0, 0, 4.65240559682284e-47, 0, 0, 0,
      2.1878646799136e-14, 0, 0, 0, 0, 0.0044962668799859, 0, 0, 0,
      0.0264579631290975, 0, -6.41300276853265e-05, -0.00522156085006403,
      6.41300276853265e-05, 0.00522156085006403, 0, 0, 0, 0, 0,
      0.369574756982322, 0, 0, 0, 0.220728736729064, 0, 0, 0, 0,
      4.56519918734971e-27, 0, 0, 0, 4.27386465153178e-11, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 3.55454355494099e-05, 0.0008471482032512, -3.55454355494099e-05,
      -0.0008471482032512, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 1.60120545833031e-06, 0.00755484918880189, 0, 0,
      -0.0186193439540101, 0.0644675428551272, 0, 0, -0.140987047728179,
      0.000108743860888856, 0.019710663086235, 0.000108743860888856,
      0.019710663086235, 4.71773605401122e-05, 0.0182433593566632,
      0.0584153412812247, 0.369574756982322, 0, 0, -2.15936941337612e-16,
      0.351578874077324, 0, 0, -1.27744844311618e-17, 4.65240559682284e-47,
      4.56519918734971e-27, 0, 0, -3.47410357040831e-26, 6.20561208033785e-11,
      0, 0, -5.29479420132092e-10, 0, 0, 0, 0.00672458817926473, 0, 0, 0,
      0.0127520030640093, 0, -0.000123194688451319, -0.00293607765268637,
      0.000123194688451319, 0.00293607765268637, 0, 0, 0, 0, 0,
      -2.15936941337612e-16, 0, 0, 0, -1.27744844311618e-17, 0, 0, 0, 0,
      3.47410357040831e-26, 0, 0, 0, 1.22285532189439e-10, 0, 0, 0, 0,
      0.0697304660732807, 0, 0, 0, 0.204832144151377, 0, -0.00962972102855042,
      -0.0532880461311957, 0.00962972102855042, 0.0532880461311957, 0, 0, 0, 0,
      0, 0.351578874077324, 0, 0, 0, 0.71990303962159, 0, 0, 0, 0,
      6.20561208033785e-11, 0, 0, 0, 7.39478042697181e-07, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0.0082112329539633, 0.0197041127216032, -0.0082112329539633,
      -0.0197041127216032, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0.00133510528759952, 0.073564239522464, 0, 0, -0.0979220211712296,
      0.321458237497611, 0, 0, -0.54522559087836, 0.0190100721743516,
      0.154734012695547, 0.0190100721743516, 0.154734012695547,
      0.00478779950530312, 0.120605488343666, 0.00812130938299834,
      0.220728736729064, 0, 0, -1.27744844311618e-17, 0.71990303962159, 0, 0, 0,
      2.1878646799136e-14, 4.27386465153178e-11, 0, 0, -1.22285532189439e-10,
      7.39478042697181e-07, 0, 0, -3.88330647325209e-06, 0, 0, 0,
      0.163048885125048, 0, 0, 0, 0.221372329772531, 0, -0.0284587956211302,
      -0.068291244443279, 0.0284587956211302, 0.068291244443279, 0, 0, 0, 0, 0,
      -1.27744844311618e-17, 0, 0, 0, 0, 0, 0, 0, 0, 5.29479420132092e-10, 0, 0,
      0, 3.88330647325209e-06, 0, 0, 0, 0, 3.73597644664805e-10, 0, 0, 0,
      2.8566178289141e-05, 0, -1.1623569692217e-09, -3.78192086921893e-05,
      1.1623569692217e-09, 3.78192086921893e-05, 0, 0, 0, 0, 0,
      4.65240559682284e-47, 0, 0, 0, 2.1878646799136e-14, 0, 0, 0, 0,
      0.0584153412812247, 0, 0, 0, 0.00812130938299834, 0, 0, 0, 0,
      4.40076638044235e-07, 0, 0, 0, 0.00140393194790411, 0,
      -1.39567524664518e-06, -0.00175606934345728, 1.39567524664518e-06,
      0.00175606934345728, 0, 0, 0, 0, 0, 4.56519918734971e-27, 0, 0, 0,
      4.27386465153178e-11, 0, 0, 0, 0, 0.369574756982322, 0, 0, 0,
      0.220728736729064, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7.70994870717492e-07,
      0.000284255004833403, -7.70994870717492e-07, -0.000284255004833403, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      2.48669343196377e-17, 7.15144763549799e-07, 0, 0, 3.16027827966443e-06,
      0.00337623006908233, 0, 0, 0.0133294400555784, 2.35563801038337e-06,
      0.00660041228250764, 2.35563801038337e-06, 0.00660041228250764,
      1.02023572192566e-06, 0.00610806817183043, 4.65240559682284e-47,
      4.56519918734971e-27, 0, 0, 3.47410357040831e-26, 6.20561208033785e-11, 0,
      0, 5.29479420132092e-10, 0.0584153412812247, 0.369574756982322, 0, 0,
      1.88913658180811e-16, 0.351578874077324, 0, 0, 0, 0, 0, 0,
      -1.16483099488171e-06, 0, 0, 0, -0.00121407138472492, 0,
      3.35539993855946e-06, 0.00123708893791423, -3.35539993855946e-06,
      -0.00123708893791423, 0, 0, 0, 0, 0, -3.47410357040831e-26, 0, 0, 0,
      -1.22285532189439e-10, 0, 0, 0, 0, 1.88913658180811e-16, 0, 0, 0, 0, 0, 0,
      0, 0, 0.000516366178748355, 0, 0, 0, 0.0207817609519127, 0,
      -0.0013294034273844, -0.0225401998503999, 0.0013294034273844,
      0.0225401998503999, 0, 0, 0, 0, 0, 6.20561208033785e-11, 0, 0, 0,
      7.39478042697181e-07, 0, 0, 0, 0, 0.351578874077324, 0, 0, 0,
      0.71990303962159, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00112956462750656,
      0.00833460167644877, -0.00112956462750656, -0.00833460167644877, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9.01366374465513e-07,
      0.000573203477209271, 0, 0, 0.00133976640261895, 0.0326143549166848, 0, 0,
      0.0999205075372724, 0.00262185964535651, 0.0654506183474078,
      0.00262185964535651, 0.0654506183474078, 0.000665396320082499,
      0.0510146647829496, 2.1878646799136e-14, 4.27386465153178e-11, 0, 0,
      1.22285532189439e-10, 7.39478042697181e-07, 0, 0, 3.88330647325209e-06,
      0.00812130938299834, 0.220728736729064, 0, 0, 0, 0.71990303962159, 0, 0,
      0, 0, 0, 0, -0.00215100557004084, 0, 0, 0, -0.0405696942983636, 0,
      0.00491590959380488, 0.0362725136252185, -0.00491590959380488,
      -0.0362725136252185, 0, 0, 0, 0, 0, -5.29479420132092e-10, 0, 0, 0,
      -3.88330647325209e-06, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;

  RowMatrixXd ao_z(33, 33);
  ao_z << -0.690915999673583, -0.132274102438076, 0, 0, 0.0828819774872559,
      -0.124581828871512, 0, 0, 0.0122968960884087, -0.0122168410557259,
      -0.0550038762263279, -0.0122168410557259, -0.0550038762263279,
      -0.0122168410557258, -0.0550038762263277, -4.94230348348742e-13,
      -1.73876812795586e-05, 0, 0, -6.70154410393737e-05, -0.0113840391117908,
      0, 0, -0.0381412688751667, 5.77641387577701e-41, 1.20776131872395e-16, 0,
      0, -8.34366626022164e-16, -2.72025382833416e-06, 0, 0,
      1.79934495665212e-05, -0.132274102438076, -0.690915999673582, 0, 0,
      0.608935134867267, -0.526034013335391, 0, 0, 0.388177460034424,
      -0.0654587521871048, -0.223782141116791, -0.0654587521871048,
      -0.223782141116791, -0.0654587521871045, -0.223782141116791,
      -0.00490319558704942, -0.0522650647378746, 0, 0, -0.0761366276416485,
      -0.22490944423619, 0, 0, -0.43480153849429, 3.55968365490086e-08,
      5.7674608831891e-06, 0, 0, -1.46523198674386e-05, 0.00122710696514648, 0,
      0, -0.00453043344722784, 0, 0, -0.690915999673582, 0, 0, 0,
      -0.36546610640662, 0, 0, 0.0495846129313461, 0.0634370982401457,
      0.0495846129313461, 0.0634370982401457, -0.0991692258626928,
      -0.126874196480293, 0, 0, -0.0251184812812764, 0, 0, 0,
      -0.164844776074515, 0, 0, 0, 0, 2.54625528487792e-06, 0, 0, 0,
      0.000844191811386385, 0, 0, 0, 0, 0, -0.690915999673582, 0, 0, 0,
      -0.36546610640662, 0, 0.0858830688707292, 0.109876277236672,
      -0.0858830688707292, -0.109876277236672, 0, 0, 0, 0, 0,
      -0.0251184812812764, 0, 0, 0, -0.164844776074515, 0, 0, 0, 0,
      2.54625528487792e-06, 0, 0, 0, 0.000844191811386385, 0,
      0.0828819774872559, 0.608935134867267, 0, 0, -0.690915999673582,
      0.597616131440864, 0, 0, -0.36546610640662, 0.0518230288667113,
      0.271295016960183, 0.0518230288667113, 0.271295016960183,
      0.0518230288667111, 0.271295016960183, 0.0156722554786953,
      0.130331240424938, 0, 0, 0.170041640062936, 0.378201734321818, 0, 0,
      0.61694301483419, 2.04688145874663e-07, 2.58745185351788e-05, 0, 0,
      -6.33810675158005e-05, 0.00336984616641871, 0, 0, -0.0118280208590196,
      -0.124581828871512, -0.526034013335392, 0, 0, 0.597616131440864,
      -0.690915999673583, 0, 0, 1.12979709920385, -0.0529754683867841,
      -0.251089567693069, -0.0529754683867841, -0.251089567693069,
      -0.052975468386784, -0.251089567693069, -0.0790382257900022,
      -0.391722132350141, 0, 0, -0.150650754942923, -0.818428257873848, 0, 0,
      -0.563058062167312, 0.00405141090917629, 0.0251754521691293, 0, 0,
      -0.0208858731489776, 0.0882358300187127, 0, 0, -0.139637681775715, 0, 0,
      -0.36546610640662, 0, 0, 0, -0.690915999673583, 0, 0, 0.0367631794230019,
      0.103879763735442, 0.0367631794230019, 0.103879763735442,
      -0.0735263588460044, -0.207759527470885, 0, 0, -0.180411522131271, 0, 0,
      0, -0.741810127757134, 0, 0, 0, 0, 0.0112647406728735, 0, 0, 0,
      0.0799755283486644, 0, 0, 0, 0, 0, -0.36546610640662, 0, 0, 0,
      -0.690915999673583, 0, 0.0636756946084107, 0.179925028668038,
      -0.0636756946084107, -0.179925028668038, 0, 0, 0, 0, 0,
      -0.180411522131271, 0, 0, 0, -0.741810127757134, 0, 0, 0, 0,
      0.0112647406728735, 0, 0, 0, 0.0799755283486644, 0, 0.0122968960884087,
      0.388177460034424, 0, 0, -0.36546610640662, 1.12979709920385, 0, 0,
      -0.690915999673583, 0.117912530876502, 0.715176134699203,
      0.117912530876502, 0.715176134699203, 0.117912530876502,
      0.715176134699202, 0.18676031153209, 0.872671699176284, 0, 0,
      0.161885286127489, 1.59296901059, 0, 0, 0.434565461641862,
      0.0172568068930739, 0.099809067710195, 0, 0, -0.0724274961709533,
      0.291109625506176, 0, 0, -0.388401739332659, -0.0122168410557259,
      -0.0654587521871048, 0.0495846129313461, 0.0858830688707292,
      0.0518230288667113, -0.0529754683867841, 0.0367631794230019,
      0.0636756946084106, 0.117912530876502, -0.0332339999842864,
      -0.0214658053784022, -0.000267678322667264, -0.00393699677559333,
      -0.000267678322667273, -0.00393699677559337, -6.38613464788044e-06,
      -0.000325146165427161, 0.000183588955196071, 0.000317985398108085,
      -0.000589112047337423, -0.0114478866238363, 0.00971279480219091,
      0.0168230540808857, -0.0288751648430789, 5.01929885971293e-08,
      8.73897760679058e-06, -4.85759830671792e-06, -8.41360706999607e-06,
      -2.01202227674282e-05, 0.00190345089536892, -0.00161388714667711,
      -0.00279533453572715, -0.00635830388659052, -0.0550038762263279,
      -0.223782141116791, 0.0634370982401457, 0.109876277236672,
      0.271295016960183, -0.251089567693069, 0.103879763735442,
      0.179925028668038, 0.715176134699203, -0.0214658053784022,
      -0.0332339999842864, -0.00393699677559333, -0.0118871768792355,
      -0.00393699677559337, -0.0118871768792356, -0.0203292648536786,
      -0.110232431889348, 0.0201883840194497, 0.0349673068443988,
      -0.0517262905061016, -0.284618879654165, 0.10524241165823,
      0.182285204103136, -0.244147564072268, 0.0077586064349193,
      0.0459560870828329, -0.00832379331486575, -0.0144172329330498,
      -0.0301174070395555, 0.147508854405482, -0.054543773053421,
      -0.0944725861650324, -0.186361976363747, -0.0122168410557259,
      -0.0654587521871048, 0.0495846129313461, -0.0858830688707292,
      0.0518230288667113, -0.0529754683867841, 0.0367631794230019,
      -0.0636756946084106, 0.117912530876502, -0.000267678322667264,
      -0.00393699677559333, -0.0332339999842864, -0.0214658053784022,
      -0.000267678322667273, -0.00393699677559337, -6.38613464788044e-06,
      -0.000325146165427161, 0.000183588955196071, -0.000317985398108085,
      -0.000589112047337423, -0.0114478866238363, 0.00971279480219091,
      -0.0168230540808857, -0.0288751648430789, 5.01929885971293e-08,
      8.73897760679058e-06, -4.85759830671792e-06, 8.41360706999607e-06,
      -2.01202227674282e-05, 0.00190345089536892, -0.00161388714667711,
      0.00279533453572715, -0.00635830388659052, -0.0550038762263279,
      -0.223782141116791, 0.0634370982401457, -0.109876277236672,
      0.271295016960183, -0.251089567693069, 0.103879763735442,
      -0.179925028668038, 0.715176134699203, -0.00393699677559333,
      -0.0118871768792355, -0.0214658053784022, -0.0332339999842864,
      -0.00393699677559337, -0.0118871768792356, -0.0203292648536786,
      -0.110232431889348, 0.0201883840194497, -0.0349673068443988,
      -0.0517262905061016, -0.284618879654165, 0.10524241165823,
      -0.182285204103136, -0.244147564072268, 0.0077586064349193,
      0.0459560870828329, -0.00832379331486575, 0.0144172329330498,
      -0.0301174070395555, 0.147508854405482, -0.054543773053421,
      0.0944725861650324, -0.186361976363747, -0.0122168410557258,
      -0.0654587521871045, -0.0991692258626928, 0, 0.0518230288667111,
      -0.052975468386784, -0.0735263588460043, 0, 0.117912530876502,
      -0.000267678322667273, -0.00393699677559337, -0.000267678322667273,
      -0.00393699677559337, -0.0332339999842864, -0.0214658053784022,
      -6.38613464788039e-06, -0.000325146165427159, -0.000367177910392144, 0,
      -0.000589112047337419, -0.0114478866238363, -0.0194255896043819, 0,
      -0.0288751648430788, 5.01929885971289e-08, 8.73897760679051e-06,
      9.71519661343587e-06, 0, -2.0120222767428e-05, 0.00190345089536892,
      0.00322777429335424, 0, -0.0063583038865905, -0.0550038762263277,
      -0.223782141116791, -0.126874196480293, 0, 0.271295016960183,
      -0.251089567693069, -0.207759527470885, 0, 0.715176134699203,
      -0.00393699677559337, -0.0118871768792356, -0.00393699677559337,
      -0.0118871768792356, -0.0214658053784022, -0.0332339999842864,
      -0.0203292648536786, -0.110232431889348, -0.0403767680388997, 0,
      -0.0517262905061016, -0.284618879654164, -0.210484823316462, 0,
      -0.244147564072268, 0.00775860643491928, 0.0459560870828329,
      0.0166475866297316, 0, -0.0301174070395554, 0.147508854405482,
      0.109087546106843, 0, -0.186361976363747, -4.94230348348742e-13,
      -0.00490319558704942, 0, 0, 0.0156722554786953, -0.0790382257900022, 0, 0,
      0.18676031153209, -6.38613464788043e-06, -0.0203292648536786,
      -6.38613464788043e-06, -0.0203292648536786, -6.38613464788038e-06,
      -0.0203292648536786, -3.38520099840072, -0.726848740361398, 0, 0,
      0.0584153412812215, -0.621466372666576, 0, 0, 0.00812130938299834,
      3.37319574900281e-168, -1.69947097643616e-45, 0, 0, 2.24355764845709e-44,
      -1.46047635960933e-12, 0, 0, 1.4862026092721e-11, -1.73876812795586e-05,
      -0.0522650647378747, 0, 0, 0.130331240424938, -0.391722132350141, 0, 0,
      0.872671699176284, -0.000325146165427161, -0.110232431889348,
      -0.000325146165427161, -0.110232431889348, -0.000325146165427159,
      -0.110232431889348, -0.726848740361398, -3.38520099840071, 0, 0,
      0.369574756982323, -2.4786214949175, 0, 0, 0.220728736729064,
      2.26667383994995e-45, 7.4812381686564e-27, 0, 0, -5.23668100551493e-26,
      -3.09517210336573e-10, 0, 0, 2.68109364350915e-09, 0, 0,
      -0.0251184812812764, 0, 0, 0, -0.180411522131271, 0, 0,
      0.000183588955196071, 0.0201883840194497, 0.000183588955196071,
      0.0201883840194497, -0.000367177910392144, -0.0403767680388997, 0, 0,
      -3.38520099840071, 0, 0, 0, -1.65322979629139, 0, 0, 0, 0,
      3.63269613971271e-27, 0, 0, 0, -1.69521045278125e-10, 0, 0, 0, 0, 0,
      -0.0251184812812764, 0, 0, 0, -0.180411522131271, 0, 0.000317985398108085,
      0.0349673068443988, -0.000317985398108085, -0.0349673068443988, 0, 0, 0,
      0, 0, -3.38520099840071, 0, 0, 0, -1.65322979629139, 0, 0, 0, 0,
      3.63269613971271e-27, 0, 0, 0, -1.69521045278125e-10, 0,
      -6.70154410393736e-05, -0.0761366276416486, 0, 0, 0.170041640062936,
      -0.150650754942923, 0, 0, 0.161885286127489, -0.000589112047337423,
      -0.0517262905061016, -0.000589112047337423, -0.0517262905061016,
      -0.000589112047337419, -0.0517262905061016, 0.0584153412812215,
      0.369574756982323, 0, 0, -3.38520099840071, 0.351578874077325, 0, 0,
      -1.65322979629139, 2.99079807536653e-44, 6.14972084298486e-26, 0, 0,
      -4.29618271590151e-25, -8.28169328054988e-10, 0, 0, 7.01984292249041e-09,
      -0.0113840391117908, -0.22490944423619, 0, 0, 0.378201734321818,
      -0.818428257873848, 0, 0, 1.59296901059, -0.0114478866238364,
      -0.284618879654165, -0.0114478866238364, -0.284618879654165,
      -0.0114478866238363, -0.284618879654164, -0.621466372666576,
      -2.4786214949175, 0, 0, 0.351578874077325, -3.38520099840072, 0, 0,
      0.71990303962159, 1.82840607976367e-12, 4.34223220480837e-10, 0, 0,
      -1.18606273485457e-09, 4.06057912460171e-07, 0, 0, -1.39290078253528e-06,
      0, 0, -0.164844776074515, 0, 0, 0, -0.741810127757134, 0, 0,
      0.00971279480219092, 0.10524241165823, 0.00971279480219092,
      0.10524241165823, -0.019425589604382, -0.210484823316462, 0, 0,
      -1.65322979629139, 0, 0, 0, -3.38520099840072, 0, 0, 0, 0,
      2.37672842664528e-10, 0, 0, 0, 4.06057912460171e-07, 0, 0, 0, 0, 0,
      -0.164844776074515, 0, 0, 0, -0.741810127757134, 0, 0.0168230540808858,
      0.182285204103136, -0.0168230540808858, -0.182285204103136, 0, 0, 0, 0, 0,
      -1.65322979629139, 0, 0, 0, -3.38520099840072, 0, 0, 0, 0,
      2.37672842664528e-10, 0, 0, 0, 4.06057912460171e-07, 0,
      -0.0381412688751667, -0.43480153849429, 0, 0, 0.61694301483419,
      -0.563058062167312, 0, 0, 0.434565461641863, -0.0288751648430789,
      -0.244147564072268, -0.0288751648430789, -0.244147564072268,
      -0.0288751648430788, -0.244147564072268, 0.00812130938299834,
      0.220728736729064, 0, 0, -1.65322979629139, 0.71990303962159, 0, 0,
      -3.38520099840071, 1.86001500694025e-11, 3.74437517155662e-09, 0, 0,
      -1.00053333935557e-08, 2.87185686792964e-06, 0, 0, -1.0791949353919e-05,
      5.77641387577701e-41, 3.55968365490086e-08, 0, 0, 2.04688145874663e-07,
      0.00405141090917629, 0, 0, 0.0172568068930739, 5.01929885971293e-08,
      0.0077586064349193, 5.01929885971293e-08, 0.0077586064349193,
      5.01929885971288e-08, 0.00775860643491928, 3.37319574900282e-168,
      2.26667383994995e-45, 0, 0, 2.99079807536653e-44, 1.82840607976367e-12, 0,
      0, 1.86001500694025e-11, 4.17581899802719, 0.896605188326244, 0, 0,
      0.0584153412812207, 0.766610634595159, 0, 0, 0.00812130938299834,
      1.20776131872394e-16, 5.76746088318912e-06, 0, 0, 2.58745185351789e-05,
      0.0251754521691293, 0, 0, 0.0998090677101951, 8.73897760679058e-06,
      0.0459560870828329, 8.73897760679058e-06, 0.0459560870828329,
      8.73897760679052e-06, 0.0459560870828329, -1.69947097643616e-45,
      7.48123816865641e-27, 0, 0, 6.14972084298486e-26, 4.34223220480837e-10, 0,
      0, 3.74437517155661e-09, 0.896605188326244, 4.17581899802719, 0, 0,
      0.369574756982324, 3.05750669820932, 0, 0, 0.220728736729064, 0, 0,
      2.54625528487792e-06, 0, 0, 0, 0.0112647406728735, 0, 0,
      -4.85759830671792e-06, -0.00832379331486574, -4.85759830671792e-06,
      -0.00832379331486574, 9.71519661343587e-06, 0.0166475866297316, 0, 0,
      3.63269613971272e-27, 0, 0, 0, 2.37672842664528e-10, 0, 0, 0, 0,
      4.17581899802719, 0, 0, 0, 2.03934371835519, 0, 0, 0, 0, 0,
      2.54625528487792e-06, 0, 0, 0, 0.0112647406728735, 0,
      -8.41360706999607e-06, -0.0144172329330498, 8.41360706999607e-06,
      0.0144172329330498, 0, 0, 0, 0, 0, 3.63269613971272e-27, 0, 0, 0,
      2.37672842664528e-10, 0, 0, 0, 0, 4.17581899802719, 0, 0, 0,
      2.03934371835519, 0, -8.34366626022158e-16, -1.46523198674387e-05, 0, 0,
      -6.33810675158008e-05, -0.0208858731489776, 0, 0, -0.0724274961709532,
      -2.01202227674282e-05, -0.0301174070395555, -2.01202227674282e-05,
      -0.0301174070395555, -2.0120222767428e-05, -0.0301174070395555,
      2.24355764845709e-44, -5.23668100551493e-26, 0, 0, -4.2961827159015e-25,
      -1.18606273485457e-09, 0, 0, -1.00053333935557e-08, 0.0584153412812207,
      0.369574756982324, 0, 0, 4.17581899802719, 0.351578874077324, 0, 0,
      2.03934371835519, -2.72025382833416e-06, 0.00122710696514648, 0, 0,
      0.00336984616641871, 0.0882358300187127, 0, 0, 0.291109625506176,
      0.00190345089536893, 0.147508854405482, 0.00190345089536893,
      0.147508854405482, 0.00190345089536892, 0.147508854405482,
      -1.46047635960933e-12, -3.09517210336573e-10, 0, 0, -8.28169328054988e-10,
      4.06057912460171e-07, 0, 0, 2.87185686792964e-06, 0.766610634595159,
      3.05750669820932, 0, 0, 0.351578874077324, 4.17581899802719, 0, 0,
      0.71990303962159, 0, 0, 0.000844191811386385, 0, 0, 0, 0.0799755283486644,
      0, 0, -0.00161388714667711, -0.054543773053421, -0.00161388714667711,
      -0.054543773053421, 0.00322777429335425, 0.109087546106843, 0, 0,
      -1.69521045278125e-10, 0, 0, 0, 4.06057912460171e-07, 0, 0, 0, 0,
      2.03934371835519, 0, 0, 0, 4.17581899802719, 0, 0, 0, 0, 0,
      0.000844191811386385, 0, 0, 0, 0.0799755283486644, 0,
      -0.00279533453572716, -0.0944725861650325, 0.00279533453572716,
      0.0944725861650325, 0, 0, 0, 0, 0, -1.69521045278125e-10, 0, 0, 0,
      4.06057912460171e-07, 0, 0, 0, 0, 2.03934371835519, 0, 0, 0,
      4.17581899802719, 0, 1.79934495665212e-05, -0.00453043344722784, 0, 0,
      -0.0118280208590196, -0.139637681775715, 0, 0, -0.388401739332659,
      -0.00635830388659053, -0.186361976363747, -0.00635830388659053,
      -0.186361976363747, -0.00635830388659051, -0.186361976363747,
      1.4862026092721e-11, 2.68109364350915e-09, 0, 0, 7.01984292249041e-09,
      -1.39290078253528e-06, 0, 0, -1.0791949353919e-05, 0.00812130938299834,
      0.220728736729064, 0, 0, 2.03934371835519, 0.71990303962159, 0, 0,
      4.17581899802719;

  using Tile = TA::Tensor<double>;
  using Policy = TA::SparsePolicy;
  mpqc::lcao::scf::FosterBoysLocalizer<Tile, Policy> localizer(
      KeyVal{}.assign("max_iter", 10000).assign("convergence", 1e-13));
  localizer.initialize(ao_s, {ao_x, ao_y, ao_z});

  RowMatrixXd C(33, 14);
  RowMatrixXd Uref(14, 14);
  double target_precision;
  {
    C << 0.000776767742576427, -3.6605282451509e-05, -0.987024180439495,
        0.0505332856990213, 0.0103102788732939, 0.198023654536438,
        4.03559829197491e-17, 1.55910787716471e-15, -0.0260343669146733,
        -1.86540117741125e-15, 2.07489834093561e-15, -2.01425648327293e-15,
        -3.0985711491265e-15, 0.0224885576359423, 0.00295719976112434,
        -0.000487139396508805, -0.0971968675735148, -0.0560261273282672,
        -0.00738294389829847, -0.213687650066721, -2.47490008110439e-15,
        1.41687725694217e-15, 0.0231821699166157, 1.22945578427567e-15,
        7.18458677718756e-15, 9.4422942632327e-16, 4.42941530470848e-15,
        -0.0397360323317157, 3.85578528860991e-16, 1.07411134800809e-16,
        6.69748218953333e-17, 1.1141557098623e-17, -3.10792969146951e-16,
        -2.88547198189128e-15, 0.080826184336932, -0.237093351644533,
        -7.29232179709167e-15, 0.0872762454681855, -0.298555090304013,
        -0.0332201374887998, -0.00383816329925286, -5.33205323914201e-15,
        -4.18443319279994e-16, 4.05234974463837e-16, -8.90135643086639e-17,
        -8.03118073281385e-16, 1.18351420823867e-16, -6.06942889340151e-16,
        0.237093351644528, 0.0808261843369315, 8.34711905120197e-16,
        -0.298555090304007, -0.0872762454681893, 0.00383816329925134,
        -0.0332201374887988, -2.74691479486124e-15, 0.00140228882283225,
        -0.000841200980844305, 0.000228283370354589, 0.0614528757574807,
        -0.00267585927798504, -0.0413656372156248, 1.23670211657106e-15,
        -1.5603002750043e-15, 0.270148915305808, 5.57283709070582e-15,
        -6.35991343126821e-15, 1.85085561513198e-15, 4.04405212157976e-15,
        -0.0306389648980741, -0.0138059040412811, 3.76128419757317e-05,
        0.0637867706827337, -0.0823913529114872, -0.0191279996914322,
        -0.558338506326475, 5.53923975429884e-15, -1.77472391950269e-14,
        0.0907175185508152, 1.34504096412449e-14, -3.60892647367994e-14,
        1.72008467466855e-14, 1.92748037677391e-14, -0.105246077382104,
        -1.03254978113202e-15, 7.45835502055374e-17, -1.94697802666788e-16,
        5.29016316513683e-15, 8.70973247559763e-16, 8.84765695545977e-15,
        0.0824429425232541, -0.241835906552213, -6.63796175288888e-15,
        0.0483606649018616, -0.165432444985214, -0.0692536154575837,
        -0.00800137221826922, -8.10448810711708e-15, 1.40789014385572e-15,
        -1.89346658953285e-16, 1.60411915043837e-16, -2.10324056589983e-16,
        -9.07605369030771e-16, 3.74636850529808e-15, 0.241835906552208,
        0.0824429425232508, -3.15443783877008e-15, -0.165432444985219,
        -0.0483606649018621, 0.00800137221826205, -0.069253615457585,
        -4.84920674395122e-15, 0.00700743980691881, 0.00267712276165067,
        0.0056769531133128, 0.00740975149563536, -0.0312452348026251,
        -0.0256171225213577, 1.08166921426221e-15, -1.60295604258143e-15,
        0.125666128060674, 4.57365798419821e-15, -5.2987974624495e-15,
        -8.4564533021426e-15, -1.62333258425e-14, 0.142184115363128,
        0.00108055712241893, -0.000651848057427765, 0.000901718896716222,
        -0.0116681308261667, -0.00293127116620374, -0.133186577862739,
        -0.136004213061135, 0.026869194737739, 0.0837804619852712,
        0.15899809874993, 0.166353873425238, 0.00978341356812485,
        0.0225979351687188, -0.037294158270942, 0.00143364782177838,
        0.000466130501247529, -0.0145902249709652, 0.00188680940613495,
        -0.0116617031142296, -0.0217674903396561, -0.0750878880868259,
        0.0148344749183826, 0.0670426020954009, 0.167991540010987,
        0.175763380840497, -0.0321636088742215, -0.074292182689662,
        0.0213094107307608, 0.0010805571224192, -0.000651848057427863,
        0.000901718896716334, -0.0116681308261666, -0.00293127116620425,
        -0.133186577862741, 0.0912715117526815, 0.104348506163788,
        0.0837804619852755, -0.223565729779162, 0.0545194559582456,
        0.0146786791451214, -0.0197716522700741, -0.037294158270946,
        0.00143364782177645, 0.000466130501247241, -0.0145902249709651,
        0.00188680940613384, -0.0116617031142287, -0.0217674903396673,
        0.0503909761745335, 0.057610781140531, 0.0670426020954097,
        -0.236211322868397, 0.0576032508501583, -0.0482571130747295,
        0.0650005937072738, 0.0213094107307701, 0.00108055712241882,
        -0.000651848057427287, 0.000901718896716292, -0.0116681308261646,
        -0.00293127116620315, -0.133186577862732, 0.0447327013084515,
        -0.13121770090152, 0.0837804619852602, 0.0645676310292318,
        -0.220873329383474, -0.0244620927132381, -0.0028262828986297,
        -0.0372941582709489, 0.00143364782177877, 0.000466130501246697,
        -0.0145902249709648, 0.00188680940612633, -0.0116617031142321,
        -0.0217674903396851, 0.0246969119122907, -0.0724452560589018,
        0.0670426020954002, 0.0682197828574002, -0.233366631690626,
        0.0804207219489353, 0.00929158898237096, 0.0213094107307792,
        -0.981967681837632, 0.000284709086421325, 0.000134339014472953,
        0.244087239864368, -0.00256608725669541, -0.068203279823324,
        -1.25513174997397e-15, 2.49562031581238e-15, -0.032501362453109,
        -3.09799953270661e-16, -1.10184671716668e-15, 7.2942413108213e-16,
        1.13682629606614e-15, -0.00944557286391486, -0.0960906696585202,
        -0.000399668261926068, -1.29953234236631e-05, -0.231696549015856,
        0.00489808847964564, 0.0597692136777229, 2.20295881654472e-15,
        -4.06913247075237e-15, 0.0373060033772037, -1.25179311355492e-16,
        9.07205108608268e-16, 2.48610157060364e-16, 4.07528338572298e-16,
        -0.00295109781929637, 1.4297854474945e-16, 5.37600871743551e-17,
        -2.77182713955743e-17, 4.29902735729858e-15, -1.0820473570769e-16,
        -2.60498952312299e-15, 0.128813603219993, -0.377858353396036,
        -1.15426284582869e-15, -0.100654266180675, 0.344318701702249,
        0.0107473384929076, 0.00124171792431742, 2.12655035444091e-15,
        7.24417780816158e-17, -7.81414840457858e-17, 1.1890554162404e-17,
        7.19884947155215e-16, -8.18113347882648e-17, -2.10622446738934e-16,
        0.37785835339604, 0.128813603219992, -5.13216963485886e-15,
        0.344318701702247, 0.100654266180671, -0.00124171792431662,
        0.0107473384929073, 6.03268774607735e-16, -0.00266042713551044,
        -7.24969048149806e-05, -0.00122013035999767, -0.0466752244231299,
        -0.00247013663880487, -0.157931715882792, -4.97589581491871e-15,
        6.21881291393915e-15, -0.415566876404381, -5.25773285122041e-15,
        5.44719547239701e-15, -3.77636124976364e-15, -5.90254085878773e-15,
        0.0464637431992585, 0.0334611065795785, 0.00149142181442292,
        -0.00474320642391708, -0.772851938279287, -0.000777923962867279,
        0.297743436214023, 2.81173210281477e-15, -4.58841016185823e-15,
        0.127259302583869, 1.62901900134544e-15, 5.75715710754443e-15,
        -7.87475363561279e-15, -1.25262910329912e-14, 0.101018624435789,
        9.99194953596156e-17, 7.00468025219071e-17, -9.34219829802839e-18,
        6.67824121562531e-15, -1.66176799220822e-16, -3.70940712391006e-15,
        0.14005018722544, -0.410819446199586, 2.26952706517736e-16,
        -0.120786973210493, 0.413188783510955, 0.0162412491505254,
        0.00187646924834674, 2.82678389029621e-15, -1.55990461268637e-16,
        3.43415596867522e-17, -3.98563280783925e-17, 9.32240499438042e-16,
        1.7020825648811e-17, -8.39997064209282e-16, 0.41081944619959,
        0.140050187225437, -5.76325737839402e-15, 0.413188783510954,
        0.120786973210489, -0.00187646924834537, 0.0162412491505254,
        1.11048548200211e-15, 0.00659920683435165, 0.000508940449310694,
        0.000909765271235383, -0.0654101041315042, -0.0074786366147989,
        -0.148959146179183, -6.85816508246803e-15, 1.05125684769098e-14,
        -0.499066210304825, -6.03803308351674e-15, 9.13468182253694e-15,
        -7.84516100122179e-15, -1.20328331667561e-14, 0.0945668672021729,
        0.000361558151585441, 0.981610316904251, 2.52430253562684e-05,
        0.000260430150005121, 0.253277683409867, -0.0190869333800856,
        1.7527022502141e-16, -9.31927329786123e-17, 0.009917796480067,
        1.98554750441052e-16, -3.47483783778485e-16, 6.39778784500779e-16,
        -2.56886857510888e-15, 0.00359679655101198, 0.000397174834003468,
        0.092656616528922, 0.000343553691355367, -0.000559169905879325,
        -0.227482128471185, 0.0153579490439111, -1.14398749257194e-18,
        2.75233453836468e-16, -0.00752017936903863, -4.04512426364963e-16,
        3.71093748966932e-16, -6.71486372647353e-16, 2.86399591509141e-15,
        -0.00443401960486776, -2.58422398543009e-18, -2.15508803565004e-18,
        -2.30342392204003e-18, -2.12132109571451e-17, -1.21443476090271e-15,
        -1.74277921945098e-16, 0.00172854151813439, -0.00507045712170167,
        -2.27803139265784e-16, 0.00442277285632576, -0.0151294472216482,
        0.504273758186281, 0.0582624028000882, 5.07758640053347e-14,
        -6.1756584246898e-17, -7.35370674941888e-17, 4.59420039934835e-18,
        -2.26688094253294e-17, 4.08561415531558e-15, -4.420623781852e-16,
        0.00507045712170143, 0.00172854151813423, 3.69260196857761e-16,
        -0.0151294472216479, -0.0044227728563266, -0.0582624028000888,
        0.504273758186281, 6.10963960256743e-14, -0.000244756099290502,
        -0.000344252497242355, -0.000435384168359957, 0.000455348461287099,
        0.00125355128522658, 0.0133117174321457, -1.52420708535824e-16,
        4.49422530613256e-16, -0.027549820203761, -1.35713345528152e-15,
        1.29698461277141e-15, 4.36705019588119e-14, 6.40205143606703e-14,
        -0.495082245780093, -0.000737823649294801, -0.0237848491641667,
        -0.000602783797108216, -0.000201550506288005, -0.8334772016955,
        0.0698302906036618, -6.42932920362872e-16, 1.73233282999585e-16,
        -0.0403246039420598, -7.21803939493138e-16, 4.1902377513486e-16,
        -1.66999927646079e-15, 8.37612421037034e-15, -0.0142087996176424,
        -6.92105177652466e-18, 2.14574914171352e-17, -1.41348511305747e-17,
        5.53192350693136e-17, -1.77344172115902e-15, -1.73746909798257e-16,
        0.00145668524386869, -0.0042730012506863, 1.52973628124161e-16,
        0.00477535303527012, -0.016335555557307, 0.640034091131815,
        0.0739477782017263, 6.54855109001485e-14, 6.8615285908767e-17,
        2.89209968782049e-17, 3.55187534510584e-18, 1.56997244453288e-17,
        5.61586730138525e-15, -3.30341696288985e-16, 0.00427300125068598,
        0.00145668524386839, 1.93361185910118e-16, -0.0163355555573061,
        -0.00477535303527112, -0.0739477782017262, 0.640034091131814,
        7.67743320783318e-14, 0.000751799608008414, 0.000654474172098166,
        0.00125822344330775, -0.00105229836602688, -0.000298780371278217,
        0.0061150721182163, -1.73203721377515e-16, 5.6751904187309e-16,
        -0.0257534219880749, -1.69566047939714e-15, 1.87487596489573e-15,
        5.45704185900182e-14, 8.22595594773918e-14, -0.629989093195035;
    // obtained by FBLocalizer with convergence=1e-15
    Uref << 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0.461046436783375, 0.000712242239920799, 0.0688544190937407,
        0.461046451933513, 0.461046436718864, 0.589985100040991,
        -0.0688544179675878, 0.068854419246996, -0.000712242805393511,
        0.000712245122266132, -0.00134252863509007, 0, 0, 0,
        -0.00756904578595427, 0.500356913206422, 0.0344002743538301,
        -0.00756904697453966, -0.00756904953372126, 0.00276159299592025,
        -0.0344002757385922, 0.0344002746539644, -0.500356911569501,
        0.500356913770082, -0.495175973486036, 0, 0, 0, -0.206449793587346,
        -0.0435995341951171, 0.507369425031536, -0.206449807665156,
        -0.206449794229409, 0.306478321417801, -0.507369423440655,
        0.507369425805345, 0.0435995345591478, -0.0435995350756266,
        -0.0152486986413989, 0, 0, 0, 0.20706681273142, -0.00781488080727023,
        -0.332263844643079, 0.422500716287531, -0.629567548625525,
        5.19188765898897e-09, -0.495108319750935, -0.162844473790764,
        0.00383012007441977, 0.0116449967709603, 1.32897487462113e-09, 0, 0, 0,
        -0.607411905697498, -0.00893456280568414, -0.379869219240073,
        0.483031068492222, 0.124380813523298, 5.85716087262714e-09,
        0.0978143205458519, 0.477683539332915, -0.0112351661105725,
        -0.00230060119413008, 3.71446703543247e-10, 0, 0, 0, -0.279035094871344,
        0.0352227955528477, -0.259857290286382, -0.279035117899997,
        -0.279035097195663, 0.74517056112285, 0.259857291621126,
        -0.259857290109651, -0.0352227964313391, 0.0352227967652075,
        0.0695679344509778, 0, 0, 0, -0.141611097126883, 0.0323759564512195,
        0.622721044824943, 0.490322984696353, -0.348711910619905,
        4.75313110775092e-09, 0.44287404626372, -0.179846998964114,
        0.00935044280196657, -0.0230255151033909, -9.98990778826836e-10, 0, 0,
        0, 0.484417024607374, -0.00789530714777881, -0.151858739445581,
        -0.119569704789714, -0.364847312500568, -3.50849234062509e-09,
        0.463362874324126, 0.61522161262935, -0.0319860556290438,
        -0.024090749350982, 9.02862984131068e-10, 0, 0, 0, 0.0112052432147771,
        0.486250735501181, -0.0199864839216938, -0.00672375868992015,
        -0.00448148484164257, -4.24310488195494e-10, 0.0133210938134306,
        0.0333075778387567, 0.810339249967755, 0.3240885160755,
        4.71611062548911e-09, 0, 0, 0, 0.001294577865258, -0.654962176163704,
        0.02692107579663, 0.00905673425966695, -0.0103513150688936,
        -1.70114750989983e-09, 0.0307693400846195, 0.00384826551896173,
        0.0936244010163069, 0.748586577143576, 1.21870498425237e-09, 0, 0, 0,
        0.0151694808406579, 0.282549500482176, 0.0495931332470524,
        0.0151694824338914, 0.0151694805913262, -0.0519791176390103,
        -0.0495931318658471, 0.0495931308068321, -0.282549505637473,
        0.282549499524094, 0.865867618394986;
    target_precision = 1e-12;
  }

  auto C_ta = math::eigen_to_array<Tile, Policy>(
      TA::get_default_world(), C, TA::TiledRange1{0, size_t(C.rows())},
      TA::TiledRange1{0, size_t(C.cols())});
  auto U_ta = localizer.compute(C_ta, 3);
  auto U = math::array_to_eigen(U_ta);

  //std::cout << U - Uref << std::endl;
  REQUIRE((U - Uref).lpNorm<Eigen::Infinity>() < target_precision);

  mpqc::lcao::scf::FosterBoysLocalizer<Tile, Policy> localizer1(
      KeyVal{}.assign("max_iter", 1).assign("convergence", 1e20));
  localizer1.initialize(ao_s, {ao_x, ao_y, ao_z});

  RowMatrixXd C1(33, 14);
  C1 << 0.000776767742576378, -3.66052824513071e-05, -0.987024180439495,
      -0.0505332856990213, 0.0103102788732924, 0.198023654536436,
      2.10215702220764e-15, -1.38319069185225e-15, 0.0260343669146699,
      -3.34234279946398e-16, 3.18128034557884e-15, -1.68281264085689e-15,
      -2.8381530850658e-15, 0.0224885576359428, 0.00295719976112465,
      -0.000487139396509049, -0.0971968675735157, 0.0560261273282662,
      -0.0073829438982982, -0.213687650066717, 1.70746472688205e-15,
      1.96342985566539e-15, -0.0231821699166174, -4.15608398291056e-15,
      3.07497592804207e-15, 4.08594617926574e-15, 3.90344310571251e-15,
      -0.0397360323317118, 4.37829802953787e-16, 9.59721732843351e-17,
      -3.16244782565051e-17, 2.0693849412919e-16, -3.44326070042809e-16,
      -4.96517195324482e-16, -0.201084885399029, 0.149368665832444,
      9.33428962707632e-15, 0.00594524167264372, -0.310993471106559,
      0.0333635406282294, 0.00227666181835057, 3.24164108632488e-16,
      -2.27406020152132e-16, 2.99018873861816e-16, -6.97215978059864e-17,
      -2.53894968511782e-17, 1.0629090303209e-17, 1.43311458070037e-15,
      -0.149368665832443, -0.201084885399032, -1.61311002933109e-15,
      0.310993471106555, 0.00594524167263683, 0.0022766618183517,
      -0.0333635406282284, -2.82253303961249e-15, 0.00140228882283224,
      -0.00084120098084413, 0.000228283370354482, -0.06145287575748,
      -0.00267585927798463, -0.0413656372156256, -6.41046350665813e-16,
      5.48769510053028e-15, -0.270148915305806, -4.20351370273182e-16,
      -9.54660444106974e-15, 2.7244222011112e-15, 3.76309202080312e-15,
      -0.0306389648980769, -0.0138059040412816, 3.76128419755899e-05,
      0.063786770682736, 0.0823913529114894, -0.0191279996914229,
      -0.558338506326472, -2.09897320010588e-14, 5.52688300242016e-15,
      -0.0907175185507822, 1.14411086910599e-14, -3.29147099738853e-14,
      4.67278685869521e-15, 1.70244823739226e-14, -0.10524607738212,
      -1.0170710629589e-15, -9.34751715037019e-17, 3.83534217364376e-16,
      -4.0729639616226e-15, 6.26153340540698e-16, 2.44119296259654e-15,
      -0.205107166511061, 0.152356472509798, 4.66239245353089e-15,
      0.00329431953387698, -0.172324679667018, 0.0695525662333539,
      0.00474612912568805, -9.87733470761853e-16, 1.3255109010809e-15,
      6.50288897303812e-18, 1.12218203091855e-16, -7.72872465344862e-16,
      -1.58332560975842e-15, 1.98296150423603e-15, -0.152356472509792,
      -0.205107166511059, -6.97471065096655e-16, 0.172324679667004,
      0.00329431953387851, 0.00474612912569414, -0.0695525662333623,
      -7.05983379467285e-15, 0.00700743980691895, 0.0026771227616508,
      0.0056769531133129, -0.00740975149563343, -0.0312452348026228,
      -0.0256171225213567, -2.84594268004711e-15, 1.29555390710019e-15,
      -0.125666128060676, 1.38562790022888e-15, -7.13816498037334e-15,
      -1.2525571117165e-14, -1.55683585738058e-14, 0.14218411536312,
      0.00108055712241892, -0.000651848057427688, 0.000901718896716069,
      0.0116681308261673, -0.00293127116620319, -0.133186577862742,
      0.127236313716015, 0.055045618065333, -0.0837804619852716,
      -0.20145025521725, 0.111228599211603, -0.0137356933934793,
      0.0204380180530022, -0.0372941582709446, 0.00143364782177843,
      0.000466130501247516, -0.0145902249709654, -0.00188680940613552,
      -0.0116617031142323, -0.0217674903396675, 0.0702471333045774,
      0.0303906703765384, -0.0670426020954171, -0.212844926295529,
      0.117520044715827, 0.0451569860404969, -0.0671913145901134,
      0.0213094107307691, 0.00108055712241918, -0.000651848057427842,
      0.000901718896716145, 0.0116681308261667, -0.00293127116620353,
      -0.133186577862742, -0.0159472532464168, -0.137712688994623,
      -0.0837804619852747, 0.197051920153231, 0.118846739011195,
      -0.0108319961401571, -0.0221144684438431, -0.0372941582709486,
      0.00143364782177653, 0.00046613050124713, -0.0145902249709652,
      -0.00188680940613354, -0.0116617031142304, -0.0217674903396716,
      -0.00880447406816141, -0.07603113717306, -0.0670426020954208,
      0.208197807325542, 0.125569090880644, 0.0356108923284466,
      0.0727027543644575, 0.0213094107307826, 0.00108055712241877,
      -0.000651848057427102, 0.000901718896716352, 0.0116681308261644,
      -0.00293127116620228, -0.133186577862731, -0.111289060469591,
      0.0826670709292884, -0.0837804619852571, 0.00439833506401951,
      -0.230075338222788, 0.0245676895336453, 0.00167645039085457,
      -0.0372941582709458, 0.0014336478217788, 0.000466130501246769,
      -0.0145902249709661, -0.00188680940612646, -0.0116617031142342,
      -0.0217674903396787, -0.061442659236402, 0.0456404667965255,
      -0.0670426020954071, 0.00464711896997759, -0.243089135596449,
      -0.0807678783689441, -0.00551143977435786, 0.021309410730777,
      -0.981967681837632, 0.000284709086395241, 0.000134339014472829,
      -0.244087239864368, -0.00256608725669555, -0.0682032798233228,
      1.6140447132173e-15, -1.73536712673805e-15, 0.0325013624531073,
      9.41835566122312e-17, -1.10777080413669e-15, 7.60661425423109e-16,
      1.13180345726555e-15, -0.00944557286391442, -0.0960906696585206,
      -0.00039966826192876, -1.29953234235873e-05, 0.23169654901585,
      0.00489808847964574, 0.0597692136777187, -3.09718026377307e-15,
      2.63188640529796e-15, -0.0373060033771992, -1.70415095958616e-16,
      1.10655540726649e-15, 2.48657609008897e-16, 3.65416391932522e-16,
      -0.0029510978192979, 1.3386530913552e-16, 4.81618142719001e-17,
      -1.18848981081511e-17, -4.16562805052163e-15, -1.23901356349143e-16,
      -1.7941136909559e-15, -0.320471253886627, 0.238050530430006,
      1.89131150872078e-15, -0.00685654996517817, 0.358663682807264,
      -0.010793732102234, -0.000736542863615244, 5.27059103018523e-16,
      1.31215733759472e-16, -7.25562596577864e-17, 1.00143003466627e-17,
      2.28481348308807e-16, -1.2927226780328e-16, 2.37925109637797e-16,
      -0.238050530430009, -0.320471253886626, -5.62202993522382e-15,
      -0.358663682807267, -0.00685654996518301, -0.000736542863615647,
      0.0107937321022338, 8.16587876747958e-16, -0.00266042713551044,
      -7.24969048150534e-05, -0.00122013035999764, 0.0466752244231254,
      -0.00247013663880362, -0.157931715882789, 4.22894090114767e-15,
      -9.05626621144745e-15, 0.415566876404377, -9.37433600557009e-16,
      7.53703131048877e-15, -3.52539593492477e-15, -5.49970228857809e-15,
      0.0464637431992584, 0.0334611065795786, 0.00149142181442379,
      -0.00474320642391754, 0.772851938279293, -0.000777923962867647,
      0.297743436214024, -2.19806102735842e-15, 4.1877939678722e-15,
      -0.127259302583871, -1.01386494098609e-15, 4.76848668906989e-15,
      -8.07479541765755e-15, -1.19391265103086e-14, 0.101018624435788,
      9.99922609181219e-17, 9.70168701409234e-17, -7.62074893667179e-17,
      -6.6725680842564e-15, -1.63199502801374e-16, -2.18148533571193e-15,
      -0.348426392750947, 0.258815998640297, 1.00934344193069e-15,
      -0.00822798623829371, 0.430403025034776, -0.0163113586170279,
      -0.00111305474987255, 8.30075658249856e-16, -1.71405340685154e-16,
      2.22897990955671e-18, -3.51916197311766e-17, -2.56216427925584e-16,
      3.15292822803758e-17, -1.19671708704393e-16, -0.258815998640299,
      -0.34842639275094, -6.20877289237523e-15, -0.430403025034775,
      -0.00822798623829979, -0.00111305474987283, 0.0163113586170288,
      1.57126206757945e-15, 0.00659920683435165, 0.000508940449310862,
      0.000909765271235123, 0.0654101041314978, -0.00747863661479887,
      -0.148959146179182, 7.43885132938904e-15, -1.23763549099409e-14,
      0.499066210304827, -2.64240654792503e-15, 1.000225704012e-14,
      -7.24747755060985e-15, -1.12822681052861e-14, 0.0945668672021747,
      0.000361558151559139, 0.981610316904251, 2.52430253565102e-05,
      -0.000260430150005351, 0.253277683409867, -0.0190869333800842,
      -3.28653910345529e-16, 1.64081576545464e-16, -0.00991779648006658,
      3.17605887894946e-17, -4.39857330983167e-16, -6.87208543400444e-16,
      -2.73689043352087e-15, 0.00359679655100986, 0.000397174834000947,
      0.092656616528922, 0.00034355369135544, 0.000559169905879666,
      -0.227482128471184, 0.0153579490439099, 1.57743082501968e-16,
      -1.30064685848313e-16, 0.00752017936903829, 1.8565951314317e-16,
      3.82112245849363e-16, 1.00046120186813e-15, 2.99211912056413e-15,
      -0.00443401960486508, -2.68589668616168e-18, 2.26864600721584e-17,
      -1.03999072066866e-17, 3.33945252381335e-17, -9.9432147098185e-16,
      -1.27938108723552e-16, -0.0043003832969843, 0.00319438487066812,
      1.65180829380674e-16, 0.000301278467617242, -0.0157597691688775,
      -0.506450583615704, -0.0345591830150014, -3.81220521515597e-14,
      -6.19405506756542e-17, -7.79557596710952e-17, 4.86589258820157e-18,
      2.04581560860368e-17, 4.1927842428812e-15, -3.77843289193074e-16,
      -0.00319438487066774, -0.004300383296984, -2.65642466319598e-16,
      0.0157597691688764, 0.000301278467617043, -0.0345591830150006,
      0.506450583615703, 5.93732437932687e-14, -0.000244756099290498,
      -0.000344252497242406, -0.000435384168359972, -0.000455348461287231,
      0.00125355128522259, 0.0133117174321461, 1.31675462252498e-16,
      -7.24908549441084e-16, 0.0275498202037626, 3.47528738628971e-16,
      1.85234764718925e-15, 3.19814842587187e-14, 5.91622144016146e-14,
      -0.495082245780088, -0.00073782364929418, -0.0237848491641666,
      -0.000602783797108244, 0.000201550506288872, -0.833477201695501,
      0.0698302906036568, 1.06342054860814e-15, -6.25257268113016e-16,
      0.0403246039420586, -1.81653992054307e-16, 1.34417903109727e-15,
      2.25886059823882e-15, 8.80379221723056e-15, -0.0142087996176364,
      -6.31656834405272e-18, 1.10380835417559e-17, 1.01315038467258e-17,
      -4.61801293038765e-17, -1.56513561807355e-15, -3.07767948189494e-16,
      -0.00362404074531992, 0.00269198816199773, -3.14371725186622e-16,
      0.000325296164088569, -0.0170161263036874, -0.642796960431793,
      -0.0438631892542256, -4.76269035255768e-14, 6.92787058569652e-17,
      2.98302951936603e-17, 2.32169623856658e-18, -3.46926185798699e-17,
      5.75256157700933e-15, -3.25228334591889e-16, -0.00269198816199769,
      -0.00362404074531956, -1.75147377186258e-16, 0.0170161263036858,
      0.000325296164088111, -0.0438631892542252, 0.642796960431792,
      7.42482404180029e-14, 0.000751799608008418, 0.000654474172098202,
      0.00125822344330779, 0.00105229836602682, -0.000298780371283471,
      0.00611507211821741, 2.02767534905681e-16, -8.78223480185965e-16,
      0.0257534219880772, 5.93924603023809e-16, 2.58332569163118e-15,
      4.14407373288704e-14, 7.62917298139682e-14, -0.629989093195039;
  RowMatrixXd U1ref(14, 14);
  U1ref << 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0.838243768712187, 0.0108415063660903, 0.0528567547502203,
      0.251097420462515, -0.252080092458232, 0.408911077162743,
      -0.0232972491935711, 0.00860681268575769, -0.00305120704986135,
      0.00267201921860237, 0.000405257132086747, 0, 0, 0, 0.0044823714443139,
      0.431771374943499, 0.0437703383752363, -0.0222906895019945,
      0.0102799258945381, 0.000230868974345315, -0.00988272549416146,
      0.0238910704812146, 0.476988647513169, -0.529760030745831,
      -0.549729596296761, 0, 0, 0, 0.208310421499577, -0.0227879740578296,
      0.569761396917625, -0.449698509783336, 0.173862466976027,
      -0.146367508135221, -0.315750493544573, 0.523468993603638,
      -0.0467657860569087, 0.0409013155034332, -0.000977118185417492, 0, 0, 0,
      -0.0312275903542826, -0.000428385164385465, 0.0661210867585299,
      0.770651035002302, -0.0535943598237032, -0.471038121979345,
      -0.226463367546346, 0.352999369769446, 0.0100180217551127,
      -0.00156061886346089, 0.00183364954317236, 0, 0, 0, 0.0848771130551899,
      0.00116324551515324, -0.121370109884345, 0.146142388464042,
      0.725151708327059, 0.173708757614866, -0.555507529645122,
      -0.303148719692651, -0.00733722159263083, -0.0119312666336213,
      0.00159279952334632, 0, 0, 0, -0.491740356856404, -0.0192384700859108,
      0.283407601967158, 0.226913551618679, -0.16600184609657,
      0.714503159293934, -0.188989893040995, 0.216534420067473,
      -0.040786969630513, 0.0249785713572685, -0.05521282218593, 0, 0, 0,
      0.0351833339537974, 0.000522915544901572, 0.439723021866411,
      0.253259015915479, 0.517616940673029, 0.0736763908212978,
      0.683181609172562, -0.016729902857769, -0.00243275275885878,
      0.0287706729834155, -0.00769519084358986, 0, 0, 0, 0.0417302871030616,
      0.00051721377629168, -0.612225942506977, -0.0574678734778577,
      0.286007616416101, 0.201882385745881, 0.190588998259692,
      0.678133180183247, 0.0314892019535173, 0.0192094664667149,
      -0.00538055577340157, 0, 0, 0, -0.000728931629521008, -0.431594589937054,
      0.027148025547958, -0.00536824032991703, -0.0073654413148543,
      0.0108522626176656, -0.0238272024772016, -0.0175505167205006,
      0.819552955660375, 0.374254134191797, 0.0133702529637186, 0, 0, 0,
      -0.000815609275339577, 0.608963240552261, -0.0188733065393378,
      -0.00143436057982489, -0.00806039991540981, -0.0211513717566441,
      -0.0144901040216196, -0.0262756036579571, -0.0168522819472675,
      0.748093759494921, -0.259738048636299, 0, 0, 0, -0.0310759579947603,
      0.505424905415857, 0.0443795377315057, -0.000724233311133207,
      -0.000974983355703762, 0.0452985694526273, -0.0151910393648117,
      0.0282412496102879, 0.309061764696328, -0.126484574810685,
      0.791840333041421;
  auto C1_ta = math::eigen_to_array<Tile, Policy>(
      TA::get_default_world(), C1, TA::TiledRange1{0, size_t(C1.rows())},
      TA::TiledRange1{0, size_t(C1.cols())});
  auto U1_ta = localizer1.compute(C1_ta, 3);
  auto U1 = math::array_to_eigen(U1_ta);

  //std::cout << U1 - U1ref << std::endl;
  REQUIRE((U1 - U1ref).lpNorm<Eigen::Infinity>() < 1e-14);
}