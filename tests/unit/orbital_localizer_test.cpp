//
// Created by Eduard Valeyev on 7/12/18.
//

#include "catch.hpp"
#include "mpqc/chemistry/qc/lcao/scf/orbital_localization.h"

using namespace mpqc;

TEST_CASE("Foster-Boys Localizer", "[localizer]") {
  // FCH3F anion from BH76 test set, 3-21G basis
  // 6
  //
  // F                    0                   0   -1.79137122273729
  // C                    0                   0    -.36561700168727
  // H     -.51179109341343     .88644817665330    -.01758667541940
  // H     -.51179109341343    -.88644817665330    -.01758667541940
  // H     1.02358218682687                   0    -.01758667541940
  // F                    0                   0    2.20974825068278
  // this is a pathological example of FB localizer extramely sensitive to the
  // noise and taking a long time converging

  RowMatrixXd ao_s(33, 33);
  ao_s << 1, 0.191447444407957, 0, 0, 5.06584838699294e-17, 0.18031400189078, 0,
      0, -2.52776559628147e-18, 0.0199080570950185, 0.0818188507777989,
      0.0199080570950185, 0.0818188507777989, 0.0199080570950184,
      0.0818188507777988, 1.90145287297163e-13, 1.22238080871251e-05, 0, 0,
      4.82954055351829e-05, 0.0128607225116829, 0, 0, 0.0446616972082979,
      2.09590686220249e-41, 1.88256985075233e-16, 0, 0, -1.33931714693921e-15,
      8.34687777484152e-06, 0, 0, -5.21949520236495e-05, 0.191447444407957, 1,
      0, 0, 0, 0.761357406086864, 0, 0, -8.61281814502231e-17,
      0.199791329582372, 0.405301120792526, 0.199791329582372,
      0.405301120792526, 0.199791329582372, 0.405301120792526,
      0.00150738641706232, 0.0198564606890163, 0, 0, 0.0312885115676562,
      0.126281509027351, 0, 0, 0.281397403613173, 9.06447760242739e-09,
      2.01720047143969e-06, 0, 0, -5.36364048602423e-06, 0.00102819533554184, 0,
      0, -0.00425953285640236, 0, 0, 1, 0, 0, 0, 0.528958812039786, 0, 0,
      -0.14186543546692, -0.111418494318301, -0.14186543546692,
      -0.111418494318301, 0.283730870933842, 0.222836988636604, 0, 0,
      0.00940655207049297, 0, 0, 0, 0.0968609135334861, 0, 0, 0, 0,
      8.88708605787959e-07, 0, 0, 0, 0.000717271841246535, 0, 0, 0, 0, 0, 1, 0,
      0, 0, 0.528958812039786, 0, -0.245718142066593, -0.192982493062124,
      0.245718142066593, 0.192982493062124, 0, 0, 0, 0, 0, 0.00940655207049297,
      0, 0, 0, 0.0968609135334861, 0, 0, 0, 0, 8.88708605787959e-07, 0, 0, 0,
      0.000717271841246535, 0, 5.06584838699294e-17, 0, 0, 0, 1,
      -1.20923623529253e-16, 0, 0, 0.528958812039786, 0.0964719285409708,
      0.0757672718984749, 0.0964719285409708, 0.0757672718984749,
      0.0964719285409704, 0.0757672718984748, -0.00479894880093389,
      -0.0480023265061453, 0, 0, -0.0680828469993978, -0.181254205033954, 0, 0,
      -0.326960949695639, 5.20188559157688e-08, 8.89917666979564e-06, 0, 0,
      -2.28136208799566e-05, 0.00242447370030183, 0, 0, -0.0093822595541051,
      0.18031400189078, 0.761357406086864, 0, 0, -1.20923623529253e-16, 1, 0, 0,
      -9.82674699207067e-17, 0.342393482320297, 0.673049744775251,
      0.342393482320297, 0.673049744775251, 0.342393482320297,
      0.673049744775251, 0.0235882119919904, 0.125035400360445, 0, 0,
      0.0680383455137771, 0.313914922665618, 0, 0, 0.339263537316171,
      0.000984941399895602, 0.00675298758585051, 0, 0, -0.00643633775062442,
      0.0318490289163494, 0, 0, -0.0621749701493469, 0, 0, 0.528958812039787, 0,
      0, 0, 1, 0, 0, -0.238959011562868, -0.278451427161314, -0.238959011562868,
      -0.278451427161314, 0.477918023125739, 0.556902854322633, 0, 0,
      0.0570611686829047, 0, 0, 0, 0.284527405605961, 0, 0, 0, 0,
      0.00298835080339781, 0, 0, 0, 0.0288674443753376, 0, 0, 0, 0, 0,
      0.528958812039786, 0, 0, 0, 1, 0, -0.41388914895333, -0.482292019283466,
      0.41388914895333, 0.482292019283466, 0, 0, 0, 0, 0, 0.0570611686829047, 0,
      0, 0, 0.284527405605961, 0, 0, 0, 0, 0.00298835080339781, 0, 0, 0,
      0.0288674443753376, 0, -2.52776559628147e-18, -8.61281814502232e-17, 0, 0,
      0.528958812039786, -9.82674699207067e-17, 0, 0, 1, 0.162497909457934,
      0.189353707580882, 0.162497909457934, 0.189353707580882,
      0.162497909457934, 0.189353707580881, -0.0555327613827796,
      -0.270254874906903, 0, 0, -0.0917350323426839, -0.532431368156082, 0, 0,
      -0.290897769485613, 0.00418829423835446, 0.0264128836574454, 0, 0,
      -0.0224224702807599, 0.0975757804200155, 0, 0, -0.1616178370079,
      0.0199080570950185, 0.199791329582372, -0.14186543546692,
      -0.245718142066593, 0.0964719285409708, 0.342393482320297,
      -0.238959011562868, -0.41388914895333, 0.162497909457934, 1,
      0.645898940499237, 0.00805435165173698, 0.118462922833689,
      0.00805435165173724, 0.11846292283369, 1.99251156446652e-06,
      0.000133956736200306, -7.52438162036782e-05, -0.000130326112620147,
      0.000260782808026509, 0.00907390059909026, -0.00772287616812527,
      -0.013376413903756, 0.0267662305658849, 1.2719321900872e-08,
      2.93255585592713e-06, -1.6271872338562e-06, -2.81837096246644e-06,
      -7.08158270809879e-06, 0.00125574834348366, -0.00106615944706308,
      -0.00184664233128282, -0.00463996775989044, 0.0818188507777989,
      0.405301120792526, -0.111418494318301, -0.192982493062124,
      0.075767271898475, 0.673049744775251, -0.278451427161314,
      -0.482292019283466, 0.189353707580881, 0.645898940499237, 1,
      0.118462922833689, 0.357681196511282, 0.11846292283369, 0.357681196511284,
      0.00607747781331504, 0.0356495184454502, -0.00646446968818936,
      -0.011196789943933, 0.0224047987295714, 0.115576110575658,
      -0.042736127068732, -0.0740211434017643, 0.148116453729481,
      0.00188074073909546, 0.0120619395991937, -0.00216437229450125,
      -0.00374880278057063, -0.00941943317629459, 0.0488872987366331,
      -0.0180768655429719, -0.0313100495620188, -0.0786712283517392,
      0.0199080570950185, 0.199791329582372, -0.14186543546692,
      0.245718142066593, 0.0964719285409708, 0.342393482320297,
      -0.238959011562868, 0.41388914895333, 0.162497909457934,
      0.00805435165173698, 0.118462922833689, 1, 0.645898940499237,
      0.00805435165173724, 0.11846292283369, 1.99251156446652e-06,
      0.000133956736200306, -7.52438162036782e-05, 0.000130326112620147,
      0.000260782808026509, 0.00907390059909026, -0.00772287616812527,
      0.013376413903756, 0.0267662305658849, 1.2719321900872e-08,
      2.93255585592713e-06, -1.6271872338562e-06, 2.81837096246644e-06,
      -7.08158270809879e-06, 0.00125574834348366, -0.00106615944706308,
      0.00184664233128282, -0.00463996775989044, 0.0818188507777989,
      0.405301120792526, -0.111418494318301, 0.192982493062124,
      0.075767271898475, 0.673049744775251, -0.278451427161314,
      0.482292019283466, 0.189353707580881, 0.118462922833689,
      0.357681196511282, 0.645898940499237, 1, 0.11846292283369,
      0.357681196511284, 0.00607747781331504, 0.0356495184454502,
      -0.00646446968818936, 0.011196789943933, 0.0224047987295714,
      0.115576110575658, -0.042736127068732, 0.0740211434017643,
      0.148116453729481, 0.00188074073909546, 0.0120619395991937,
      -0.00216437229450125, 0.00374880278057063, -0.00941943317629459,
      0.0488872987366331, -0.0180768655429719, 0.0313100495620188,
      -0.0786712283517392, 0.0199080570950184, 0.199791329582372,
      0.283730870933842, 0, 0.0964719285409704, 0.342393482320297,
      0.477918023125739, 0, 0.162497909457934, 0.00805435165173724,
      0.11846292283369, 0.00805435165173724, 0.11846292283369, 1,
      0.645898940499237, 1.9925115644665e-06, 0.000133956736200305,
      0.000150487632407357, 0, 0.000260782808026508, 0.00907390059909023,
      0.0154457523362506, 0, 0.0267662305658848, 1.27193219008719e-08,
      2.93255585592711e-06, 3.25437446771242e-06, 0, -7.08158270809875e-06,
      0.00125574834348365, 0.00213231889412618, 0, -0.00463996775989042,
      0.0818188507777988, 0.405301120792526, 0.222836988636604, 0,
      0.0757672718984748, 0.673049744775251, 0.556902854322633, 0,
      0.189353707580881, 0.11846292283369, 0.357681196511284, 0.11846292283369,
      0.357681196511284, 0.645898940499237, 1, 0.00607747781331503,
      0.0356495184454501, 0.0129289393763788, 0, 0.0224047987295714,
      0.115576110575658, 0.0854722541374648, 0, 0.148116453729481,
      0.00188074073909546, 0.0120619395991937, 0.00432874458900253, 0,
      -0.00941943317629457, 0.048887298736633, 0.036153731085944, 0,
      -0.0786712283517391, 1.90145287297163e-13, 0.00150738641706232, 0, 0,
      -0.00479894880093389, 0.0235882119919904, 0, 0, -0.0555327613827796,
      1.99251156446651e-06, 0.00607747781331504, 1.99251156446651e-06,
      0.00607747781331504, 1.9925115644665e-06, 0.00607747781331503, 1,
      0.214713613964071, 0, 0, 9.40774688586289e-16, 0.183583300654873, 0, 0, 0,
      8.53306084758114e-168, 7.1741708863416e-46, 0, 0, -9.45134600100766e-45,
      4.65369774439942e-13, 0, 0, -4.72810381049709e-12, 1.22238080871251e-05,
      0.0198564606890164, 0, 0, -0.0480023265061454, 0.125035400360445, 0, 0,
      -0.270254874906903, 0.000133956736200306, 0.0356495184454502,
      0.000133956736200306, 0.0356495184454502, 0.000133956736200305,
      0.0356495184454501, 0.214713613964071, 1, 0, 0, -2.42584369749259e-16,
      0.732193301398789, 0, 0, 6.92121230491094e-17, 7.1741708863416e-46,
      1.89250388232771e-26, 0, 0, -1.44019006067142e-25, 1.57732318519412e-10,
      0, 0, -1.34487391957912e-09, 0, 0, 0.00940655207049298, 0, 0, 0,
      0.0570611686829047, 0, 0, -7.52438162036782e-05, -0.00646446968818936,
      -7.52438162036782e-05, -0.00646446968818936, 0.000150487632407357,
      0.0129289393763788, 0, 0, 1, 0, 0, 0, 0.4883697591583, 0, 0, 0, 0,
      9.18951033603827e-27, 0, 0, 0, 8.62006650728932e-11, 0, 0, 0, 0, 0,
      0.00940655207049297, 0, 0, 0, 0.0570611686829047, 0,
      -0.000130326112620147, -0.011196789943933, 0.000130326112620147,
      0.011196789943933, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0.4883697591583, 0, 0, 0, 0,
      9.18951033603827e-27, 0, 0, 0, 8.62006650728932e-11, 0,
      4.82954055351828e-05, 0.0312885115676562, 0, 0, -0.0680828469993979,
      0.0680383455137771, 0, 0, -0.0917350323426838, 0.000260782808026509,
      0.0224047987295714, 0.000260782808026509, 0.0224047987295714,
      0.000260782808026508, 0.0224047987295714, 9.40774688586289e-16,
      -2.42584369749259e-16, 0, 0, 1, -1.88709429716e-16, 0, 0, 0.4883697591583,
      9.45134600100766e-45, 1.44019006067142e-25, 0, 0, -1.08679102118373e-24,
      4.52675510763313e-10, 0, 0, -3.77614786467776e-09, 0.0128607225116829,
      0.126281509027351, 0, 0, -0.181254205033954, 0.313914922665618, 0, 0,
      -0.532431368156082, 0.00907390059909027, 0.115576110575658,
      0.00907390059909027, 0.115576110575658, 0.00907390059909024,
      0.115576110575658, 0.183583300654873, 0.732193301398789, 0, 0,
      -1.88709429716e-16, 1, 0, 0, 0, 4.65369774439942e-13,
      1.57732318519412e-10, 0, 0, -4.52675510763313e-10, 1.02719116602964e-06,
      0, 0, -5.39420763564676e-06, 0, 0, 0.0968609135334861, 0, 0, 0,
      0.284527405605961, 0, 0, -0.00772287616812528, -0.042736127068732,
      -0.00772287616812528, -0.042736127068732, 0.0154457523362507,
      0.0854722541374648, 0, 0, 0.4883697591583, 0, 0, 0, 1, 0, 0, 0, 0,
      8.62006650728932e-11, 0, 0, 0, 1.02719116602964e-06, 0, 0, 0, 0, 0,
      0.0968609135334861, 0, 0, 0, 0.284527405605961, 0, -0.013376413903756,
      -0.0740211434017643, 0.013376413903756, 0.0740211434017643, 0, 0, 0, 0, 0,
      0.4883697591583, 0, 0, 0, 1, 0, 0, 0, 0, 8.62006650728932e-11, 0, 0, 0,
      1.02719116602964e-06, 0, 0.0446616972082979, 0.281397403613173, 0, 0,
      -0.326960949695639, 0.339263537316171, 0, 0, -0.290897769485612,
      0.0267662305658849, 0.148116453729481, 0.0267662305658849,
      0.148116453729481, 0.0267662305658848, 0.148116453729481, 0,
      6.92121230491094e-17, 0, 0, 0.4883697591583, 0, 0, 0, 1,
      4.72810381049709e-12, 1.34487391957912e-09, 0, 0, -3.77614786467776e-09,
      5.39420763564676e-06, 0, 0, -2.73000345527615e-05, 2.09590686220249e-41,
      9.06447760242739e-09, 0, 0, 5.20188559157688e-08, 0.000984941399895602, 0,
      0, 0.00418829423835446, 1.2719321900872e-08, 0.00188074073909546,
      1.2719321900872e-08, 0.00188074073909546, 1.27193219008719e-08,
      0.00188074073909545, 8.53306084758114e-168, 7.1741708863416e-46, 0, 0,
      9.45134600100766e-45, 4.65369774439942e-13, 0, 0, 4.72810381049709e-12, 1,
      0.214713613964071, 0, 0, -9.47376694302358e-16, 0.183583300654873, 0, 0,
      0, 1.88256985075232e-16, 2.01720047143969e-06, 0, 0, 8.89917666979567e-06,
      0.00675298758585051, 0, 0, 0.0264128836574454, 2.93255585592713e-06,
      0.0120619395991937, 2.93255585592713e-06, 0.0120619395991937,
      2.93255585592711e-06, 0.0120619395991937, 7.1741708863416e-46,
      1.89250388232771e-26, 0, 0, 1.44019006067142e-25, 1.57732318519412e-10, 0,
      0, 1.34487391957912e-09, 0.214713613964071, 1, 0, 0, 5.21641100331199e-16,
      0.732193301398789, 0, 0, 0, 0, 0, 8.88708605787963e-07, 0, 0, 0,
      0.00298835080339781, 0, 0, -1.6271872338562e-06, -0.00216437229450125,
      -1.6271872338562e-06, -0.00216437229450125, 3.25437446771242e-06,
      0.00432874458900253, 0, 0, 9.18951033603827e-27, 0, 0, 0,
      8.62006650728932e-11, 0, 0, 0, 0, 1, 0, 0, 0, 0.4883697591583, 0, 0, 0, 0,
      0, 8.88708605787962e-07, 0, 0, 0, 0.00298835080339781, 0,
      -2.81837096246644e-06, -0.00374880278057063, 2.81837096246644e-06,
      0.00374880278057063, 0, 0, 0, 0, 0, 9.18951033603827e-27, 0, 0, 0,
      8.62006650728932e-11, 0, 0, 0, 0, 1, 0, 0, 0, 0.4883697591583, 0,
      -1.3393171469392e-15, -5.36364048602425e-06, 0, 0, -2.28136208799567e-05,
      -0.00643633775062442, 0, 0, -0.0224224702807599, -7.08158270809879e-06,
      -0.00941943317629459, -7.08158270809879e-06, -0.00941943317629459,
      -7.08158270809875e-06, -0.00941943317629457, -9.45134600100766e-45,
      -1.44019006067142e-25, 0, 0, -1.08679102118373e-24, -4.52675510763313e-10,
      0, 0, -3.77614786467776e-09, -9.47376694302358e-16, 5.21641100331199e-16,
      0, 0, 1, 0, 0, 0, 0.4883697591583, 8.34687777484151e-06,
      0.00102819533554184, 0, 0, 0.00242447370030183, 0.0318490289163494, 0, 0,
      0.0975757804200155, 0.00125574834348366, 0.0488872987366331,
      0.00125574834348366, 0.0488872987366331, 0.00125574834348365,
      0.048887298736633, 4.65369774439942e-13, 1.57732318519412e-10, 0, 0,
      4.52675510763313e-10, 1.02719116602964e-06, 0, 0, 5.39420763564676e-06,
      0.183583300654873, 0.732193301398789, 0, 0, 0, 1, 0, 0, 0, 0, 0,
      0.000717271841246535, 0, 0, 0, 0.0288674443753376, 0, 0,
      -0.00106615944706308, -0.0180768655429719, -0.00106615944706308,
      -0.0180768655429719, 0.00213231889412618, 0.036153731085944, 0, 0,
      8.62006650728932e-11, 0, 0, 0, 1.02719116602964e-06, 0, 0, 0, 0,
      0.4883697591583, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0.000717271841246535, 0, 0, 0,
      0.0288674443753376, 0, -0.00184664233128282, -0.0313100495620188,
      0.00184664233128282, 0.0313100495620188, 0, 0, 0, 0, 0,
      8.62006650728932e-11, 0, 0, 0, 1.02719116602964e-06, 0, 0, 0, 0,
      0.4883697591583, 0, 0, 0, 1, 0, -5.21949520236495e-05,
      -0.00425953285640236, 0, 0, -0.0093822595541051, -0.0621749701493469, 0,
      0, -0.1616178370079, -0.00463996775989044, -0.0786712283517392,
      -0.00463996775989044, -0.0786712283517392, -0.00463996775989043,
      -0.0786712283517391, -4.72810381049709e-12, -1.34487391957912e-09, 0, 0,
      -3.77614786467776e-09, -5.39420763564676e-06, 0, 0, -2.73000345527615e-05,
      0, 0, 0, 0, 0.4883697591583, 0, 0, 0, 1;

  RowMatrixXd ao_x(33, 33);
  ao_x << 0, 0, 0.0828819774872559, 0, 0, 0, 0.0122968960884087, 0, 0,
      -0.00226161675586982, -0.00224415081455854, -0.00226161675586982,
      -0.00224415081455854, 0.00452323351173964, 0.00448830162911712, 0, 0,
      1.60120545833032e-06, 0, 0, 0, 0.00133510528759952, 0, 0, 0, 0,
      2.48669343196379e-17, 0, 0, 0, 9.01366374465513e-07, 0, 0, 0, 0,
      0.608935134867267, 0, 0, 0, 0.388177460034424, 0, 0, -0.106731899481163,
      -0.0827130686587794, -0.106731899481163, -0.0827130686587794,
      0.213463798962328, 0.16542613731756, 0, 0, 0.00755484918880189, 0, 0, 0,
      0.073564239522464, 0, 0, 0, 0, 7.15144763549796e-07, 0, 0, 0,
      0.000573203477209271, 0, 0, 0.0828819774872559, 0.608935134867267, 0, 0,
      0, 0.597616131440864, 0, 0, -5.53761656983524e-17, 0.156763475693514,
      0.334350308420708, 0.156763475693514, 0.334350308420708,
      0.370428606706118, 0.394099897825027, 5.97416744321778e-05,
      0.00449626687998589, 0, 0, 0.00672458817926473, 0.0697304660732807, 0, 0,
      0.163048885125048, 3.73597644664805e-10, 4.40076638044233e-07, 0, 0,
      -1.16483099488171e-06, 0.000516366178748355, 0, 0, -0.00215100557004084,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0.123359620906563, 0.0344964415265529,
      -0.123359620906563, -0.0344964415265529, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -5.53761656983524e-17, 0, 0,
      -0.0484324862334093, -0.0135437221439086, -0.0484324862334093,
      -0.0135437221439086, 0.0968649724668191, 0.0270874442878174, 0, 0,
      -0.0186193439540101, 0, 0, 0, -0.0979220211712296, 0, 0, 0, 0,
      3.16027827966442e-06, 0, 0, 0, 0.00133976640261895, 0, 0, 0, 0,
      0.597616131440864, 0, 0, 0, 1.12979709920385, 0, 0, -0.269975198092346,
      -0.314593614676024, -0.269975198092346, -0.314593614676024,
      0.539950396184697, 0.629187229352054, 0, 0, 0.0644675428551272, 0, 0, 0,
      0.321458237497611, 0, 0, 0, 0, 0.00337623006908233, 0, 0, 0,
      0.0326143549166848, 0, 0, 0.0122968960884087, 0.388177460034424, 0, 0,
      -5.53761656983524e-17, 1.12979709920385, 0, 0, -1.11022302462516e-16,
      0.331637174645771, 0.915969289453414, 0.331637174645771,
      0.915969289453414, 0.897811551483642, 1.30642649560671,
      0.000681507565704133, 0.0264579631290975, 0, 0, 0.0127520030640093,
      0.204832144151377, 0, 0, 0.221372329772531, 2.8566178289141e-05,
      0.00140393194790411, 0, 0, -0.00121407138472492, 0.0207817609519127, 0, 0,
      -0.0405696942983636, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.326880928875609,
      0.225430573079631, -0.326880928875609, -0.225430573079631, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -5.53761656983524e-17,
      0, 0, 0, -1.11022302462516e-16, 0, 0, -0.128337424931968,
      -0.0885067824222534, -0.128337424931968, -0.0885067824222534,
      0.256674849863938, 0.177013564844509, 0, 0, -0.140987047728179, 0, 0, 0,
      -0.54522559087836, 0, 0, 0, 0, 0.0133294400555784, 0, 0, 0,
      0.0999205075372724, 0, 0, -0.00226161675586982, -0.106731899481163,
      0.156763475693514, 0.123359620906563, -0.0484324862334093,
      -0.269975198092346, 0.331637174645771, 0.326880928875609,
      -0.128337424931968, -0.967144999543077, -0.624677930514008,
      -0.00778972592453894, -0.114570823449859, 0.00389486296226968,
      -0.0540457504142142, -1.0355867326851e-07, -3.7025488747261e-05,
      6.76995273230266e-05, 3.55454355494099e-05, -7.11264865401001e-05,
      -0.00555972202805452, 0.00952855706165252, 0.0082112329539633,
      -0.0164306933126718, -6.71087109074579e-10, -8.05793479351883e-07,
      1.46536981807822e-06, 7.70994870717492e-07, 1.93724105776614e-06,
      -0.000767531426661987, 0.00131755076184049, 0.00112956462750656,
      0.00283820172729508, -0.00224415081455854, -0.0827130686587794,
      0.334350308420708, 0.0344964415265529, -0.0135437221439086,
      -0.314593614676024, 0.915969289453413, 0.225430573079631,
      -0.0885067824222534, -0.624677930514008, -0.967144999543076,
      -0.114570823449859, -0.345929580636471, 0.168616573864077,
      0.17296479031824, -7.046468205974e-05, -0.00301466956237444,
      0.0187324605998538, 0.000847148203251199, -0.0016951452231401,
      -0.0307658677784347, 0.131981663127626, 0.0197041127216032,
      -0.0394279683626212, -2.18349303189738e-05, -0.0010138671081607,
      0.0062721828753895, 0.000284255004833402, 0.000714233631316279,
      -0.0130135904512162, 0.0558266493044356, 0.00833460167644877,
      0.0209419455057041, -0.00226161675586982, -0.106731899481163,
      0.156763475693514, -0.123359620906563, -0.0484324862334093,
      -0.269975198092346, 0.331637174645771, -0.326880928875609,
      -0.128337424931968, -0.00778972592453894, -0.114570823449859,
      -0.967144999543077, -0.624677930514008, 0.00389486296226968,
      -0.0540457504142142, -1.0355867326851e-07, -3.7025488747261e-05,
      6.76995273230266e-05, -3.55454355494099e-05, -7.11264865401001e-05,
      -0.00555972202805452, 0.00952855706165252, -0.0082112329539633,
      -0.0164306933126718, -6.71087109074579e-10, -8.05793479351883e-07,
      1.46536981807822e-06, -7.70994870717492e-07, 1.93724105776614e-06,
      -0.000767531426661987, 0.00131755076184049, -0.00112956462750656,
      0.00283820172729508, -0.00224415081455854, -0.0827130686587794,
      0.334350308420708, -0.0344964415265529, -0.0135437221439086,
      -0.314593614676024, 0.915969289453413, -0.225430573079631,
      -0.0885067824222534, -0.114570823449859, -0.345929580636471,
      -0.624677930514008, -0.967144999543076, 0.168616573864077,
      0.17296479031824, -7.046468205974e-05, -0.00301466956237444,
      0.0187324605998538, -0.000847148203251199, -0.0016951452231401,
      -0.0307658677784347, 0.131981663127626, -0.0197041127216032,
      -0.0394279683626212, -2.18349303189738e-05, -0.0010138671081607,
      0.0062721828753895, -0.000284255004833402, 0.000714233631316279,
      -0.0130135904512162, 0.0558266493044356, -0.00833460167644877,
      0.0209419455057041, 0.00452323351173965, 0.213463798962328,
      0.370428606706118, 0, 0.0968649724668191, 0.539950396184697,
      0.897811551483642, 0, 0.256674849863938, 0.00389486296226967,
      0.168616573864077, 0.00389486296226967, 0.168616573864077,
      1.93428999908617, 1.24935586102803, 2.0711734653702e-07,
      7.40509774945222e-05, 0.00012926602767177, 0, 0.000142252973080201,
      0.0111194440561091, 0.023750829730701, 0, 0.0328613866253439,
      1.34217421814916e-09, 1.61158695870377e-06, 2.80077210653592e-06, 0,
      -3.87448211553229e-06, 0.00153506285332398, 0.00327401408711449, 0,
      -0.00567640345459019, 0.00448830162911712, 0.16542613731756,
      0.394099897825027, 0, 0.0270874442878174, 0.629187229352054,
      1.30642649560671, 0, 0.177013564844508, -0.0540457504142141,
      0.17296479031824, -0.0540457504142141, 0.17296479031824, 1.24935586102803,
      1.93428999908617, 0.000140929364119481, 0.00602933912474893,
      0.0201997643294256, 0, 0.00339029044628023, 0.0615317355568699,
      0.166110187479507, 0, 0.0788559367252431, 4.36698606379479e-05,
      0.00202773421632141, 0.00676452698606669, 0, -0.00142846726263257,
      0.0260271809024327, 0.0702626028688937, 0, -0.0418838910114085, 0, 0,
      5.97416744321778e-05, 0, 0, 0, 0.000681507565704133, 0, 0,
      -1.0355867326851e-07, -7.04646820597398e-05, -1.0355867326851e-07,
      -7.04646820597398e-05, 2.07117346537019e-07, 0.000140929364119482, 0, 0,
      0.0584153412812247, 0, 0, 0, 0.00812130938299834, 0, 0, 0, 0,
      4.65240559682284e-47, 0, 0, 0, 2.1878646799136e-14, 0, 0, 0, 0,
      0.0044962668799859, 0, 0, 0, 0.0264579631290975, 0, 0,
      -3.7025488747261e-05, -0.00301466956237444, -3.7025488747261e-05,
      -0.00301466956237444, 7.40509774945222e-05, 0.00602933912474892, 0, 0,
      0.369574756982322, 0, 0, 0, 0.220728736729064, 0, 0, 0, 0,
      4.56519918734971e-27, 0, 0, 0, 4.27386465153178e-11, 0, 0,
      1.60120545833031e-06, 0.00755484918880189, 0, 0, -0.0186193439540101,
      0.0644675428551272, 0, 0, -0.140987047728179, 6.76995273230266e-05,
      0.0187324605998538, 6.76995273230266e-05, 0.0187324605998538,
      0.00012926602767177, 0.0201997643294256, 0.0584153412812247,
      0.369574756982322, 0, 0, -2.15936941337612e-16, 0.351578874077324, 0, 0,
      -1.27744844311618e-17, 4.65240559682284e-47, 4.56519918734971e-27, 0, 0,
      -3.47410357040832e-26, 6.20561208033785e-11, 0, 0, -5.29479420132092e-10,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 3.55454355494099e-05, 0.000847148203251198,
      -3.55454355494099e-05, -0.000847148203251198, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00672458817926473, 0, 0, 0,
      0.0127520030640093, 0, 0, -7.11264865401001e-05, -0.0016951452231401,
      -7.11264865401001e-05, -0.0016951452231401, 0.000142252973080201,
      0.00339029044628022, 0, 0, -2.15936941337612e-16, 0, 0, 0,
      -1.27744844311618e-17, 0, 0, 0, 0, 3.47410357040832e-26, 0, 0, 0,
      1.22285532189439e-10, 0, 0, 0, 0, 0.0697304660732807, 0, 0, 0,
      0.204832144151377, 0, 0, -0.00555972202805453, -0.0307658677784347,
      -0.00555972202805453, -0.0307658677784347, 0.0111194440561091,
      0.0615317355568699, 0, 0, 0.351578874077324, 0, 0, 0, 0.71990303962159, 0,
      0, 0, 0, 6.20561208033785e-11, 0, 0, 0, 7.39478042697181e-07, 0, 0,
      0.00133510528759952, 0.073564239522464, 0, 0, -0.0979220211712296,
      0.321458237497611, 0, 0, -0.54522559087836, 0.00952855706165253,
      0.131981663127626, 0.00952855706165253, 0.131981663127626,
      0.023750829730701, 0.166110187479507, 0.00812130938299834,
      0.220728736729064, 0, 0, -1.27744844311618e-17, 0.71990303962159, 0, 0, 0,
      2.1878646799136e-14, 4.27386465153178e-11, 0, 0, -1.22285532189439e-10,
      7.39478042697181e-07, 0, 0, -3.88330647325209e-06, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0.00821123295396331, 0.0197041127216032, -0.00821123295396331,
      -0.0197041127216032, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0.163048885125048, 0, 0, 0, 0.221372329772531, 0, 0,
      -0.0164306933126719, -0.0394279683626212, -0.0164306933126719,
      -0.0394279683626212, 0.0328613866253439, 0.078855936725243, 0, 0,
      -1.27744844311618e-17, 0, 0, 0, 0, 0, 0, 0, 0, 5.29479420132092e-10, 0, 0,
      0, 3.88330647325209e-06, 0, 0, 0, 0, 3.73597644664805e-10, 0, 0, 0,
      2.8566178289141e-05, 0, 0, -6.71087109074578e-10, -2.18349303189738e-05,
      -6.71087109074578e-10, -2.18349303189738e-05, 1.34217421814916e-09,
      4.36698606379481e-05, 0, 0, 4.65240559682284e-47, 0, 0, 0,
      2.1878646799136e-14, 0, 0, 0, 0, 0.0584153412812247, 0, 0, 0,
      0.00812130938299834, 0, 0, 0, 0, 4.40076638044235e-07, 0, 0, 0,
      0.00140393194790411, 0, 0, -8.05793479351883e-07, -0.0010138671081607,
      -8.05793479351883e-07, -0.0010138671081607, 1.61158695870377e-06,
      0.00202773421632141, 0, 0, 4.56519918734971e-27, 0, 0, 0,
      4.27386465153178e-11, 0, 0, 0, 0, 0.369574756982322, 0, 0, 0,
      0.220728736729064, 0, 0, 2.48669343196377e-17, 7.15144763549799e-07, 0, 0,
      3.16027827966443e-06, 0.00337623006908233, 0, 0, 0.0133294400555784,
      1.46536981807822e-06, 0.0062721828753895, 1.46536981807822e-06,
      0.0062721828753895, 2.80077210653592e-06, 0.00676452698606668,
      4.65240559682284e-47, 4.56519918734971e-27, 0, 0, 3.47410357040832e-26,
      6.20561208033785e-11, 0, 0, 5.29479420132092e-10, 0.0584153412812247,
      0.369574756982322, 0, 0, 1.88913658180811e-16, 0.351578874077324, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 7.70994870717491e-07, 0.000284255004833402,
      -7.70994870717491e-07, -0.000284255004833402, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1.16483099488171e-06, 0, 0, 0,
      -0.00121407138472492, 0, 0, 1.93724105776614e-06, 0.000714233631316279,
      1.93724105776614e-06, 0.000714233631316279, -3.87448211553229e-06,
      -0.00142846726263257, 0, 0, -3.47410357040832e-26, 0, 0, 0,
      -1.22285532189439e-10, 0, 0, 0, 0, 1.88913658180811e-16, 0, 0, 0, 0, 0, 0,
      0, 0, 0.000516366178748355, 0, 0, 0, 0.0207817609519127, 0, 0,
      -0.000767531426661988, -0.0130135904512162, -0.000767531426661988,
      -0.0130135904512162, 0.00153506285332399, 0.0260271809024327, 0, 0,
      6.20561208033785e-11, 0, 0, 0, 7.39478042697181e-07, 0, 0, 0, 0,
      0.351578874077324, 0, 0, 0, 0.71990303962159, 0, 0, 9.01366374465513e-07,
      0.000573203477209271, 0, 0, 0.00133976640261895, 0.0326143549166848, 0, 0,
      0.0999205075372723, 0.00131755076184049, 0.0558266493044356,
      0.00131755076184049, 0.0558266493044356, 0.00327401408711449,
      0.0702626028688937, 2.1878646799136e-14, 4.27386465153178e-11, 0, 0,
      1.22285532189439e-10, 7.39478042697181e-07, 0, 0, 3.88330647325209e-06,
      0.00812130938299834, 0.220728736729064, 0, 0, 0, 0.71990303962159, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00112956462750656, 0.00833460167644878,
      -0.00112956462750656, -0.00833460167644878, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.00215100557004084, 0, 0, 0,
      -0.0405696942983636, 0, 0, 0.00283820172729508, 0.0209419455057041,
      0.00283820172729508, 0.0209419455057041, -0.0056764034545902,
      -0.0418838910114085, 0, 0, -5.29479420132092e-10, 0, 0, 0,
      -3.88330647325209e-06, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;

  RowMatrixXd ao_y(33, 33);
  ao_y << 0, 0, 0, 0.0828819774872559, 0, 0, 0, 0.0122968960884087, 0,
      -0.00391723512841567, -0.00388698323066253, 0.00391723512841567,
      0.00388698323066253, 0, 0, 0, 0, 0, 1.60120545833032e-06, 0, 0, 0,
      0.00133510528759952, 0, 0, 0, 0, 2.48669343196379e-17, 0, 0, 0,
      9.01366374465513e-07, 0, 0, 0, 0, 0.608935134867267, 0, 0, 0,
      0.388177460034424, 0, -0.184865072689711, -0.14326323736694,
      0.184865072689711, 0.14326323736694, 0, 0, 0, 0, 0, 0.00755484918880188,
      0, 0, 0, 0.073564239522464, 0, 0, 0, 0, 7.15144763549796e-07, 0, 0, 0,
      0.000573203477209271, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.123359620906563,
      0.0344964415265529, -0.123359620906563, -0.0344964415265529, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0828819774872559,
      0.608935134867267, 0, 0, 0, 0.597616131440864, 0, 0,
      -5.53761656983524e-17, 0.299206896368585, 0.374183368023588,
      0.299206896368585, 0.374183368023588, 0.0855417653559802,
      0.314433778619269, 5.97416744321778e-05, 0.00449626687998589, 0, 0,
      0.00672458817926473, 0.0697304660732807, 0, 0, 0.163048885125048,
      3.73597644664805e-10, 4.40076638044233e-07, 0, 0, -1.16483099488171e-06,
      0.000516366178748355, 0, 0, -0.00215100557004084, 0, 0, 0, 0, 0, 0, 0,
      -5.53761656983524e-17, 0, -0.083887526893146, -0.0234584148768456,
      0.083887526893146, 0.0234584148768456, 0, 0, 0, 0, 0, -0.0186193439540101,
      0, 0, 0, -0.0979220211712296, 0, 0, 0, 0, 3.16027827966442e-06, 0, 0, 0,
      0.00133976640261895, 0, 0, 0, 0, 0.597616131440864, 0, 0, 0,
      1.12979709920385, 0, -0.467610759879421, -0.544892124355626,
      0.467610759879421, 0.544892124355626, 0, 0, 0, 0, 0, 0.0644675428551272,
      0, 0, 0, 0.321458237497611, 0, 0, 0, 0, 0.00337623006908233, 0, 0, 0,
      0.0326143549166848, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.326880928875609,
      0.225430573079631, -0.326880928875609, -0.225430573079631, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0122968960884087,
      0.388177460034424, 0, 0, -5.53761656983524e-17, 1.12979709920385, 0, 0,
      -1.11022302462516e-16, 0.709086759204355, 1.17627409355561,
      0.709086759204355, 1.17627409355561, 0.142912382366485, 0.785816887402318,
      0.000681507565704133, 0.0264579631290975, 0, 0, 0.0127520030640093,
      0.204832144151377, 0, 0, 0.221372329772531, 2.8566178289141e-05,
      0.00140393194790411, 0, 0, -0.00121407138472492, 0.0207817609519127, 0, 0,
      -0.0405696942983636, 0, 0, 0, -5.53761656983524e-17, 0, 0, 0,
      -1.11022302462516e-16, 0, -0.222286940494728, -0.153298243969789,
      0.222286940494728, 0.153298243969789, 0, 0, 0, 0, 0, -0.140987047728179,
      0, 0, 0, -0.54522559087836, 0, 0, 0, 0, 0.0133294400555784, 0, 0, 0,
      0.0999205075372724, 0, -0.00391723512841567, -0.184865072689711,
      0.123359620906563, 0.299206896368585, -0.083887526893146,
      -0.467610759879421, 0.326880928875609, 0.709086759204355,
      -0.222286940494728, -1.67514427749481, -1.08197391401725,
      -6.7762635780344e-21, -0.128554152860458, -0.00674610053916924,
      -0.163498320070312, -1.79368883665486e-07, -6.41300276853265e-05,
      3.55454355494099e-05, 0.000108743860888856, -0.000123194688451319,
      -0.00962972102855042, 0.0082112329539633, 0.0190100721743516,
      -0.0284587956211301, -1.1623569692217e-09, -1.39567524664518e-06,
      7.70994870717492e-07, 2.35563801038337e-06, 3.35539993855946e-06,
      -0.0013294034273844, 0.00112956462750656, 0.0026218596453565,
      0.00491590959380488, -0.00388698323066252, -0.14326323736694,
      0.0344964415265529, 0.374183368023588, -0.0234584148768456,
      -0.544892124355626, 0.225430573079631, 1.17627409355561,
      -0.153298243969789, -1.08197391401725, -1.67514427749481,
      0.128554152860458, 0, -0.0349441672098524, -0.299583804751687,
      -0.000122048409466658, -0.00522156085006402, 0.000847148203251199,
      0.019710663086235, -0.00293607765268637, -0.0532880461311957,
      0.0197041127216032, 0.154734012695547, -0.068291244443279,
      -3.78192086921892e-05, -0.00175606934345728, 0.000284255004833402,
      0.00660041228250764, 0.00123708893791423, -0.0225401998503999,
      0.00833460167644877, 0.0654506183474078, 0.0362725136252185,
      0.00391723512841567, 0.184865072689711, -0.123359620906563,
      0.299206896368585, 0.083887526893146, 0.467610759879421,
      -0.326880928875609, 0.709086759204355, 0.222286940494728,
      6.7762635780344e-21, 0.128554152860458, 1.67514427749481,
      1.08197391401725, 0.00674610053916924, 0.163498320070312,
      1.79368883665486e-07, 6.41300276853265e-05, -3.55454355494099e-05,
      0.000108743860888856, 0.000123194688451319, 0.00962972102855042,
      -0.0082112329539633, 0.0190100721743516, 0.0284587956211301,
      1.1623569692217e-09, 1.39567524664518e-06, -7.70994870717492e-07,
      2.35563801038337e-06, -3.35539993855946e-06, 0.0013294034273844,
      -0.00112956462750656, 0.0026218596453565, -0.00491590959380488,
      0.00388698323066252, 0.14326323736694, -0.0344964415265529,
      0.374183368023588, 0.0234584148768456, 0.544892124355626,
      -0.225430573079631, 1.17627409355561, 0.153298243969789,
      -0.128554152860458, 0, 1.08197391401725, 1.67514427749481,
      0.0349441672098524, 0.299583804751687, 0.000122048409466658,
      0.00522156085006402, -0.000847148203251199, 0.019710663086235,
      0.00293607765268637, 0.0532880461311957, -0.0197041127216032,
      0.154734012695547, 0.068291244443279, 3.78192086921892e-05,
      0.00175606934345728, -0.000284255004833402, 0.00660041228250764,
      -0.00123708893791423, 0.0225401998503999, -0.00833460167644877,
      0.0654506183474078, -0.0362725136252185, 0, 0, 0, 0.0855417653559802, 0,
      0, 0, 0.142912382366485, 0, -0.00674610053916924, -0.0349441672098524,
      0.00674610053916924, 0.0349441672098524, 0, 0, 0, 0, 0,
      4.71773605401122e-05, 0, 0, 0, 0.00478779950530312, 0, 0, 0, 0,
      1.02023572192566e-06, 0, 0, 0, 0.000665396320082498, 0, 0, 0, 0,
      0.314433778619269, 0, 0, 0, 0.785816887402318, 0, -0.163498320070312,
      -0.299583804751687, 0.163498320070312, 0.299583804751687, 0, 0, 0, 0, 0,
      0.0182433593566632, 0, 0, 0, 0.120605488343666, 0, 0, 0, 0,
      0.00610806817183043, 0, 0, 0, 0.0510146647829496, 0, 0, 0, 0,
      5.97416744321778e-05, 0, 0, 0, 0.000681507565704133, 0,
      -1.79368883665485e-07, -0.000122048409466658, 1.79368883665485e-07,
      0.000122048409466658, 0, 0, 0, 0, 0, 0.0584153412812247, 0, 0, 0,
      0.00812130938299834, 0, 0, 0, 0, 4.65240559682284e-47, 0, 0, 0,
      2.1878646799136e-14, 0, 0, 0, 0, 0.0044962668799859, 0, 0, 0,
      0.0264579631290975, 0, -6.41300276853265e-05, -0.00522156085006403,
      6.41300276853265e-05, 0.00522156085006403, 0, 0, 0, 0, 0,
      0.369574756982322, 0, 0, 0, 0.220728736729064, 0, 0, 0, 0,
      4.56519918734971e-27, 0, 0, 0, 4.27386465153178e-11, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 3.55454355494099e-05, 0.0008471482032512, -3.55454355494099e-05,
      -0.0008471482032512, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 1.60120545833031e-06, 0.00755484918880189, 0, 0,
      -0.0186193439540101, 0.0644675428551272, 0, 0, -0.140987047728179,
      0.000108743860888856, 0.019710663086235, 0.000108743860888856,
      0.019710663086235, 4.71773605401122e-05, 0.0182433593566632,
      0.0584153412812247, 0.369574756982322, 0, 0, -2.15936941337612e-16,
      0.351578874077324, 0, 0, -1.27744844311618e-17, 4.65240559682284e-47,
      4.56519918734971e-27, 0, 0, -3.47410357040831e-26, 6.20561208033785e-11,
      0, 0, -5.29479420132092e-10, 0, 0, 0, 0.00672458817926473, 0, 0, 0,
      0.0127520030640093, 0, -0.000123194688451319, -0.00293607765268637,
      0.000123194688451319, 0.00293607765268637, 0, 0, 0, 0, 0,
      -2.15936941337612e-16, 0, 0, 0, -1.27744844311618e-17, 0, 0, 0, 0,
      3.47410357040831e-26, 0, 0, 0, 1.22285532189439e-10, 0, 0, 0, 0,
      0.0697304660732807, 0, 0, 0, 0.204832144151377, 0, -0.00962972102855042,
      -0.0532880461311957, 0.00962972102855042, 0.0532880461311957, 0, 0, 0, 0,
      0, 0.351578874077324, 0, 0, 0, 0.71990303962159, 0, 0, 0, 0,
      6.20561208033785e-11, 0, 0, 0, 7.39478042697181e-07, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0.0082112329539633, 0.0197041127216032, -0.0082112329539633,
      -0.0197041127216032, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0.00133510528759952, 0.073564239522464, 0, 0, -0.0979220211712296,
      0.321458237497611, 0, 0, -0.54522559087836, 0.0190100721743516,
      0.154734012695547, 0.0190100721743516, 0.154734012695547,
      0.00478779950530312, 0.120605488343666, 0.00812130938299834,
      0.220728736729064, 0, 0, -1.27744844311618e-17, 0.71990303962159, 0, 0, 0,
      2.1878646799136e-14, 4.27386465153178e-11, 0, 0, -1.22285532189439e-10,
      7.39478042697181e-07, 0, 0, -3.88330647325209e-06, 0, 0, 0,
      0.163048885125048, 0, 0, 0, 0.221372329772531, 0, -0.0284587956211302,
      -0.068291244443279, 0.0284587956211302, 0.068291244443279, 0, 0, 0, 0, 0,
      -1.27744844311618e-17, 0, 0, 0, 0, 0, 0, 0, 0, 5.29479420132092e-10, 0, 0,
      0, 3.88330647325209e-06, 0, 0, 0, 0, 3.73597644664805e-10, 0, 0, 0,
      2.8566178289141e-05, 0, -1.1623569692217e-09, -3.78192086921893e-05,
      1.1623569692217e-09, 3.78192086921893e-05, 0, 0, 0, 0, 0,
      4.65240559682284e-47, 0, 0, 0, 2.1878646799136e-14, 0, 0, 0, 0,
      0.0584153412812247, 0, 0, 0, 0.00812130938299834, 0, 0, 0, 0,
      4.40076638044235e-07, 0, 0, 0, 0.00140393194790411, 0,
      -1.39567524664518e-06, -0.00175606934345728, 1.39567524664518e-06,
      0.00175606934345728, 0, 0, 0, 0, 0, 4.56519918734971e-27, 0, 0, 0,
      4.27386465153178e-11, 0, 0, 0, 0, 0.369574756982322, 0, 0, 0,
      0.220728736729064, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7.70994870717492e-07,
      0.000284255004833403, -7.70994870717492e-07, -0.000284255004833403, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      2.48669343196377e-17, 7.15144763549799e-07, 0, 0, 3.16027827966443e-06,
      0.00337623006908233, 0, 0, 0.0133294400555784, 2.35563801038337e-06,
      0.00660041228250764, 2.35563801038337e-06, 0.00660041228250764,
      1.02023572192566e-06, 0.00610806817183043, 4.65240559682284e-47,
      4.56519918734971e-27, 0, 0, 3.47410357040831e-26, 6.20561208033785e-11, 0,
      0, 5.29479420132092e-10, 0.0584153412812247, 0.369574756982322, 0, 0,
      1.88913658180811e-16, 0.351578874077324, 0, 0, 0, 0, 0, 0,
      -1.16483099488171e-06, 0, 0, 0, -0.00121407138472492, 0,
      3.35539993855946e-06, 0.00123708893791423, -3.35539993855946e-06,
      -0.00123708893791423, 0, 0, 0, 0, 0, -3.47410357040831e-26, 0, 0, 0,
      -1.22285532189439e-10, 0, 0, 0, 0, 1.88913658180811e-16, 0, 0, 0, 0, 0, 0,
      0, 0, 0.000516366178748355, 0, 0, 0, 0.0207817609519127, 0,
      -0.0013294034273844, -0.0225401998503999, 0.0013294034273844,
      0.0225401998503999, 0, 0, 0, 0, 0, 6.20561208033785e-11, 0, 0, 0,
      7.39478042697181e-07, 0, 0, 0, 0, 0.351578874077324, 0, 0, 0,
      0.71990303962159, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00112956462750656,
      0.00833460167644877, -0.00112956462750656, -0.00833460167644877, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9.01366374465513e-07,
      0.000573203477209271, 0, 0, 0.00133976640261895, 0.0326143549166848, 0, 0,
      0.0999205075372724, 0.00262185964535651, 0.0654506183474078,
      0.00262185964535651, 0.0654506183474078, 0.000665396320082499,
      0.0510146647829496, 2.1878646799136e-14, 4.27386465153178e-11, 0, 0,
      1.22285532189439e-10, 7.39478042697181e-07, 0, 0, 3.88330647325209e-06,
      0.00812130938299834, 0.220728736729064, 0, 0, 0, 0.71990303962159, 0, 0,
      0, 0, 0, 0, -0.00215100557004084, 0, 0, 0, -0.0405696942983636, 0,
      0.00491590959380488, 0.0362725136252185, -0.00491590959380488,
      -0.0362725136252185, 0, 0, 0, 0, 0, -5.29479420132092e-10, 0, 0, 0,
      -3.88330647325209e-06, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;

  RowMatrixXd ao_z(33, 33);
  ao_z << -0.690915999673583, -0.132274102438076, 0, 0, 0.0828819774872559,
      -0.124581828871512, 0, 0, 0.0122968960884087, -0.0122168410557259,
      -0.0550038762263279, -0.0122168410557259, -0.0550038762263279,
      -0.0122168410557258, -0.0550038762263277, -4.94230348348742e-13,
      -1.73876812795586e-05, 0, 0, -6.70154410393737e-05, -0.0113840391117908,
      0, 0, -0.0381412688751667, 5.77641387577701e-41, 1.20776131872395e-16, 0,
      0, -8.34366626022164e-16, -2.72025382833416e-06, 0, 0,
      1.79934495665212e-05, -0.132274102438076, -0.690915999673582, 0, 0,
      0.608935134867267, -0.526034013335391, 0, 0, 0.388177460034424,
      -0.0654587521871048, -0.223782141116791, -0.0654587521871048,
      -0.223782141116791, -0.0654587521871045, -0.223782141116791,
      -0.00490319558704942, -0.0522650647378746, 0, 0, -0.0761366276416485,
      -0.22490944423619, 0, 0, -0.43480153849429, 3.55968365490086e-08,
      5.7674608831891e-06, 0, 0, -1.46523198674386e-05, 0.00122710696514648, 0,
      0, -0.00453043344722784, 0, 0, -0.690915999673582, 0, 0, 0,
      -0.36546610640662, 0, 0, 0.0495846129313461, 0.0634370982401457,
      0.0495846129313461, 0.0634370982401457, -0.0991692258626928,
      -0.126874196480293, 0, 0, -0.0251184812812764, 0, 0, 0,
      -0.164844776074515, 0, 0, 0, 0, 2.54625528487792e-06, 0, 0, 0,
      0.000844191811386385, 0, 0, 0, 0, 0, -0.690915999673582, 0, 0, 0,
      -0.36546610640662, 0, 0.0858830688707292, 0.109876277236672,
      -0.0858830688707292, -0.109876277236672, 0, 0, 0, 0, 0,
      -0.0251184812812764, 0, 0, 0, -0.164844776074515, 0, 0, 0, 0,
      2.54625528487792e-06, 0, 0, 0, 0.000844191811386385, 0,
      0.0828819774872559, 0.608935134867267, 0, 0, -0.690915999673582,
      0.597616131440864, 0, 0, -0.36546610640662, 0.0518230288667113,
      0.271295016960183, 0.0518230288667113, 0.271295016960183,
      0.0518230288667111, 0.271295016960183, 0.0156722554786953,
      0.130331240424938, 0, 0, 0.170041640062936, 0.378201734321818, 0, 0,
      0.61694301483419, 2.04688145874663e-07, 2.58745185351788e-05, 0, 0,
      -6.33810675158005e-05, 0.00336984616641871, 0, 0, -0.0118280208590196,
      -0.124581828871512, -0.526034013335392, 0, 0, 0.597616131440864,
      -0.690915999673583, 0, 0, 1.12979709920385, -0.0529754683867841,
      -0.251089567693069, -0.0529754683867841, -0.251089567693069,
      -0.052975468386784, -0.251089567693069, -0.0790382257900022,
      -0.391722132350141, 0, 0, -0.150650754942923, -0.818428257873848, 0, 0,
      -0.563058062167312, 0.00405141090917629, 0.0251754521691293, 0, 0,
      -0.0208858731489776, 0.0882358300187127, 0, 0, -0.139637681775715, 0, 0,
      -0.36546610640662, 0, 0, 0, -0.690915999673583, 0, 0, 0.0367631794230019,
      0.103879763735442, 0.0367631794230019, 0.103879763735442,
      -0.0735263588460044, -0.207759527470885, 0, 0, -0.180411522131271, 0, 0,
      0, -0.741810127757134, 0, 0, 0, 0, 0.0112647406728735, 0, 0, 0,
      0.0799755283486644, 0, 0, 0, 0, 0, -0.36546610640662, 0, 0, 0,
      -0.690915999673583, 0, 0.0636756946084107, 0.179925028668038,
      -0.0636756946084107, -0.179925028668038, 0, 0, 0, 0, 0,
      -0.180411522131271, 0, 0, 0, -0.741810127757134, 0, 0, 0, 0,
      0.0112647406728735, 0, 0, 0, 0.0799755283486644, 0, 0.0122968960884087,
      0.388177460034424, 0, 0, -0.36546610640662, 1.12979709920385, 0, 0,
      -0.690915999673583, 0.117912530876502, 0.715176134699203,
      0.117912530876502, 0.715176134699203, 0.117912530876502,
      0.715176134699202, 0.18676031153209, 0.872671699176284, 0, 0,
      0.161885286127489, 1.59296901059, 0, 0, 0.434565461641862,
      0.0172568068930739, 0.099809067710195, 0, 0, -0.0724274961709533,
      0.291109625506176, 0, 0, -0.388401739332659, -0.0122168410557259,
      -0.0654587521871048, 0.0495846129313461, 0.0858830688707292,
      0.0518230288667113, -0.0529754683867841, 0.0367631794230019,
      0.0636756946084106, 0.117912530876502, -0.0332339999842864,
      -0.0214658053784022, -0.000267678322667264, -0.00393699677559333,
      -0.000267678322667273, -0.00393699677559337, -6.38613464788044e-06,
      -0.000325146165427161, 0.000183588955196071, 0.000317985398108085,
      -0.000589112047337423, -0.0114478866238363, 0.00971279480219091,
      0.0168230540808857, -0.0288751648430789, 5.01929885971293e-08,
      8.73897760679058e-06, -4.85759830671792e-06, -8.41360706999607e-06,
      -2.01202227674282e-05, 0.00190345089536892, -0.00161388714667711,
      -0.00279533453572715, -0.00635830388659052, -0.0550038762263279,
      -0.223782141116791, 0.0634370982401457, 0.109876277236672,
      0.271295016960183, -0.251089567693069, 0.103879763735442,
      0.179925028668038, 0.715176134699203, -0.0214658053784022,
      -0.0332339999842864, -0.00393699677559333, -0.0118871768792355,
      -0.00393699677559337, -0.0118871768792356, -0.0203292648536786,
      -0.110232431889348, 0.0201883840194497, 0.0349673068443988,
      -0.0517262905061016, -0.284618879654165, 0.10524241165823,
      0.182285204103136, -0.244147564072268, 0.0077586064349193,
      0.0459560870828329, -0.00832379331486575, -0.0144172329330498,
      -0.0301174070395555, 0.147508854405482, -0.054543773053421,
      -0.0944725861650324, -0.186361976363747, -0.0122168410557259,
      -0.0654587521871048, 0.0495846129313461, -0.0858830688707292,
      0.0518230288667113, -0.0529754683867841, 0.0367631794230019,
      -0.0636756946084106, 0.117912530876502, -0.000267678322667264,
      -0.00393699677559333, -0.0332339999842864, -0.0214658053784022,
      -0.000267678322667273, -0.00393699677559337, -6.38613464788044e-06,
      -0.000325146165427161, 0.000183588955196071, -0.000317985398108085,
      -0.000589112047337423, -0.0114478866238363, 0.00971279480219091,
      -0.0168230540808857, -0.0288751648430789, 5.01929885971293e-08,
      8.73897760679058e-06, -4.85759830671792e-06, 8.41360706999607e-06,
      -2.01202227674282e-05, 0.00190345089536892, -0.00161388714667711,
      0.00279533453572715, -0.00635830388659052, -0.0550038762263279,
      -0.223782141116791, 0.0634370982401457, -0.109876277236672,
      0.271295016960183, -0.251089567693069, 0.103879763735442,
      -0.179925028668038, 0.715176134699203, -0.00393699677559333,
      -0.0118871768792355, -0.0214658053784022, -0.0332339999842864,
      -0.00393699677559337, -0.0118871768792356, -0.0203292648536786,
      -0.110232431889348, 0.0201883840194497, -0.0349673068443988,
      -0.0517262905061016, -0.284618879654165, 0.10524241165823,
      -0.182285204103136, -0.244147564072268, 0.0077586064349193,
      0.0459560870828329, -0.00832379331486575, 0.0144172329330498,
      -0.0301174070395555, 0.147508854405482, -0.054543773053421,
      0.0944725861650324, -0.186361976363747, -0.0122168410557258,
      -0.0654587521871045, -0.0991692258626928, 0, 0.0518230288667111,
      -0.052975468386784, -0.0735263588460043, 0, 0.117912530876502,
      -0.000267678322667273, -0.00393699677559337, -0.000267678322667273,
      -0.00393699677559337, -0.0332339999842864, -0.0214658053784022,
      -6.38613464788039e-06, -0.000325146165427159, -0.000367177910392144, 0,
      -0.000589112047337419, -0.0114478866238363, -0.0194255896043819, 0,
      -0.0288751648430788, 5.01929885971289e-08, 8.73897760679051e-06,
      9.71519661343587e-06, 0, -2.0120222767428e-05, 0.00190345089536892,
      0.00322777429335424, 0, -0.0063583038865905, -0.0550038762263277,
      -0.223782141116791, -0.126874196480293, 0, 0.271295016960183,
      -0.251089567693069, -0.207759527470885, 0, 0.715176134699203,
      -0.00393699677559337, -0.0118871768792356, -0.00393699677559337,
      -0.0118871768792356, -0.0214658053784022, -0.0332339999842864,
      -0.0203292648536786, -0.110232431889348, -0.0403767680388997, 0,
      -0.0517262905061016, -0.284618879654164, -0.210484823316462, 0,
      -0.244147564072268, 0.00775860643491928, 0.0459560870828329,
      0.0166475866297316, 0, -0.0301174070395554, 0.147508854405482,
      0.109087546106843, 0, -0.186361976363747, -4.94230348348742e-13,
      -0.00490319558704942, 0, 0, 0.0156722554786953, -0.0790382257900022, 0, 0,
      0.18676031153209, -6.38613464788043e-06, -0.0203292648536786,
      -6.38613464788043e-06, -0.0203292648536786, -6.38613464788038e-06,
      -0.0203292648536786, -3.38520099840072, -0.726848740361398, 0, 0,
      0.0584153412812215, -0.621466372666576, 0, 0, 0.00812130938299834,
      3.37319574900281e-168, -1.69947097643616e-45, 0, 0, 2.24355764845709e-44,
      -1.46047635960933e-12, 0, 0, 1.4862026092721e-11, -1.73876812795586e-05,
      -0.0522650647378747, 0, 0, 0.130331240424938, -0.391722132350141, 0, 0,
      0.872671699176284, -0.000325146165427161, -0.110232431889348,
      -0.000325146165427161, -0.110232431889348, -0.000325146165427159,
      -0.110232431889348, -0.726848740361398, -3.38520099840071, 0, 0,
      0.369574756982323, -2.4786214949175, 0, 0, 0.220728736729064,
      2.26667383994995e-45, 7.4812381686564e-27, 0, 0, -5.23668100551493e-26,
      -3.09517210336573e-10, 0, 0, 2.68109364350915e-09, 0, 0,
      -0.0251184812812764, 0, 0, 0, -0.180411522131271, 0, 0,
      0.000183588955196071, 0.0201883840194497, 0.000183588955196071,
      0.0201883840194497, -0.000367177910392144, -0.0403767680388997, 0, 0,
      -3.38520099840071, 0, 0, 0, -1.65322979629139, 0, 0, 0, 0,
      3.63269613971271e-27, 0, 0, 0, -1.69521045278125e-10, 0, 0, 0, 0, 0,
      -0.0251184812812764, 0, 0, 0, -0.180411522131271, 0, 0.000317985398108085,
      0.0349673068443988, -0.000317985398108085, -0.0349673068443988, 0, 0, 0,
      0, 0, -3.38520099840071, 0, 0, 0, -1.65322979629139, 0, 0, 0, 0,
      3.63269613971271e-27, 0, 0, 0, -1.69521045278125e-10, 0,
      -6.70154410393736e-05, -0.0761366276416486, 0, 0, 0.170041640062936,
      -0.150650754942923, 0, 0, 0.161885286127489, -0.000589112047337423,
      -0.0517262905061016, -0.000589112047337423, -0.0517262905061016,
      -0.000589112047337419, -0.0517262905061016, 0.0584153412812215,
      0.369574756982323, 0, 0, -3.38520099840071, 0.351578874077325, 0, 0,
      -1.65322979629139, 2.99079807536653e-44, 6.14972084298486e-26, 0, 0,
      -4.29618271590151e-25, -8.28169328054988e-10, 0, 0, 7.01984292249041e-09,
      -0.0113840391117908, -0.22490944423619, 0, 0, 0.378201734321818,
      -0.818428257873848, 0, 0, 1.59296901059, -0.0114478866238364,
      -0.284618879654165, -0.0114478866238364, -0.284618879654165,
      -0.0114478866238363, -0.284618879654164, -0.621466372666576,
      -2.4786214949175, 0, 0, 0.351578874077325, -3.38520099840072, 0, 0,
      0.71990303962159, 1.82840607976367e-12, 4.34223220480837e-10, 0, 0,
      -1.18606273485457e-09, 4.06057912460171e-07, 0, 0, -1.39290078253528e-06,
      0, 0, -0.164844776074515, 0, 0, 0, -0.741810127757134, 0, 0,
      0.00971279480219092, 0.10524241165823, 0.00971279480219092,
      0.10524241165823, -0.019425589604382, -0.210484823316462, 0, 0,
      -1.65322979629139, 0, 0, 0, -3.38520099840072, 0, 0, 0, 0,
      2.37672842664528e-10, 0, 0, 0, 4.06057912460171e-07, 0, 0, 0, 0, 0,
      -0.164844776074515, 0, 0, 0, -0.741810127757134, 0, 0.0168230540808858,
      0.182285204103136, -0.0168230540808858, -0.182285204103136, 0, 0, 0, 0, 0,
      -1.65322979629139, 0, 0, 0, -3.38520099840072, 0, 0, 0, 0,
      2.37672842664528e-10, 0, 0, 0, 4.06057912460171e-07, 0,
      -0.0381412688751667, -0.43480153849429, 0, 0, 0.61694301483419,
      -0.563058062167312, 0, 0, 0.434565461641863, -0.0288751648430789,
      -0.244147564072268, -0.0288751648430789, -0.244147564072268,
      -0.0288751648430788, -0.244147564072268, 0.00812130938299834,
      0.220728736729064, 0, 0, -1.65322979629139, 0.71990303962159, 0, 0,
      -3.38520099840071, 1.86001500694025e-11, 3.74437517155662e-09, 0, 0,
      -1.00053333935557e-08, 2.87185686792964e-06, 0, 0, -1.0791949353919e-05,
      5.77641387577701e-41, 3.55968365490086e-08, 0, 0, 2.04688145874663e-07,
      0.00405141090917629, 0, 0, 0.0172568068930739, 5.01929885971293e-08,
      0.0077586064349193, 5.01929885971293e-08, 0.0077586064349193,
      5.01929885971288e-08, 0.00775860643491928, 3.37319574900282e-168,
      2.26667383994995e-45, 0, 0, 2.99079807536653e-44, 1.82840607976367e-12, 0,
      0, 1.86001500694025e-11, 4.17581899802719, 0.896605188326244, 0, 0,
      0.0584153412812207, 0.766610634595159, 0, 0, 0.00812130938299834,
      1.20776131872394e-16, 5.76746088318912e-06, 0, 0, 2.58745185351789e-05,
      0.0251754521691293, 0, 0, 0.0998090677101951, 8.73897760679058e-06,
      0.0459560870828329, 8.73897760679058e-06, 0.0459560870828329,
      8.73897760679052e-06, 0.0459560870828329, -1.69947097643616e-45,
      7.48123816865641e-27, 0, 0, 6.14972084298486e-26, 4.34223220480837e-10, 0,
      0, 3.74437517155661e-09, 0.896605188326244, 4.17581899802719, 0, 0,
      0.369574756982324, 3.05750669820932, 0, 0, 0.220728736729064, 0, 0,
      2.54625528487792e-06, 0, 0, 0, 0.0112647406728735, 0, 0,
      -4.85759830671792e-06, -0.00832379331486574, -4.85759830671792e-06,
      -0.00832379331486574, 9.71519661343587e-06, 0.0166475866297316, 0, 0,
      3.63269613971272e-27, 0, 0, 0, 2.37672842664528e-10, 0, 0, 0, 0,
      4.17581899802719, 0, 0, 0, 2.03934371835519, 0, 0, 0, 0, 0,
      2.54625528487792e-06, 0, 0, 0, 0.0112647406728735, 0,
      -8.41360706999607e-06, -0.0144172329330498, 8.41360706999607e-06,
      0.0144172329330498, 0, 0, 0, 0, 0, 3.63269613971272e-27, 0, 0, 0,
      2.37672842664528e-10, 0, 0, 0, 0, 4.17581899802719, 0, 0, 0,
      2.03934371835519, 0, -8.34366626022158e-16, -1.46523198674387e-05, 0, 0,
      -6.33810675158008e-05, -0.0208858731489776, 0, 0, -0.0724274961709532,
      -2.01202227674282e-05, -0.0301174070395555, -2.01202227674282e-05,
      -0.0301174070395555, -2.0120222767428e-05, -0.0301174070395555,
      2.24355764845709e-44, -5.23668100551493e-26, 0, 0, -4.2961827159015e-25,
      -1.18606273485457e-09, 0, 0, -1.00053333935557e-08, 0.0584153412812207,
      0.369574756982324, 0, 0, 4.17581899802719, 0.351578874077324, 0, 0,
      2.03934371835519, -2.72025382833416e-06, 0.00122710696514648, 0, 0,
      0.00336984616641871, 0.0882358300187127, 0, 0, 0.291109625506176,
      0.00190345089536893, 0.147508854405482, 0.00190345089536893,
      0.147508854405482, 0.00190345089536892, 0.147508854405482,
      -1.46047635960933e-12, -3.09517210336573e-10, 0, 0, -8.28169328054988e-10,
      4.06057912460171e-07, 0, 0, 2.87185686792964e-06, 0.766610634595159,
      3.05750669820932, 0, 0, 0.351578874077324, 4.17581899802719, 0, 0,
      0.71990303962159, 0, 0, 0.000844191811386385, 0, 0, 0, 0.0799755283486644,
      0, 0, -0.00161388714667711, -0.054543773053421, -0.00161388714667711,
      -0.054543773053421, 0.00322777429335425, 0.109087546106843, 0, 0,
      -1.69521045278125e-10, 0, 0, 0, 4.06057912460171e-07, 0, 0, 0, 0,
      2.03934371835519, 0, 0, 0, 4.17581899802719, 0, 0, 0, 0, 0,
      0.000844191811386385, 0, 0, 0, 0.0799755283486644, 0,
      -0.00279533453572716, -0.0944725861650325, 0.00279533453572716,
      0.0944725861650325, 0, 0, 0, 0, 0, -1.69521045278125e-10, 0, 0, 0,
      4.06057912460171e-07, 0, 0, 0, 0, 2.03934371835519, 0, 0, 0,
      4.17581899802719, 0, 1.79934495665212e-05, -0.00453043344722784, 0, 0,
      -0.0118280208590196, -0.139637681775715, 0, 0, -0.388401739332659,
      -0.00635830388659053, -0.186361976363747, -0.00635830388659053,
      -0.186361976363747, -0.00635830388659051, -0.186361976363747,
      1.4862026092721e-11, 2.68109364350915e-09, 0, 0, 7.01984292249041e-09,
      -1.39290078253528e-06, 0, 0, -1.0791949353919e-05, 0.00812130938299834,
      0.220728736729064, 0, 0, 2.03934371835519, 0.71990303962159, 0, 0,
      4.17581899802719;

  using Tile = TA::Tensor<double>;
  using Policy = TA::SparsePolicy;
  mpqc::lcao::scf::FosterBoysLocalizer<Tile, Policy> localizer(
      KeyVal{}.assign("max_iter", 10000).assign("convergence", 1e-15));
  localizer.initialize(ao_s, {ao_x, ao_y, ao_z});

  RowMatrixXd C(33, 14);
  RowMatrixXd Uref(14, 14);
  double target_precision;
  //  see mpqc::lcao::scf::compute_angle
  // gamma < 1e-COMPUTE_ANGLE_THRESHOLD -> 0
#define COMPUTE_ANGLE_THRESHOLD 5

  // gamma < 1e-7 -> 0
#if COMPUTE_ANGLE_THRESHOLD == 7
  C << 0.000776767742576427, -3.6605282451509e-05, -0.987024180439495,
      0.0505332856990213, 0.0103102788732939, 0.198023654536438,
      4.03559829197491e-17, 1.55910787716471e-15, -0.0260343669146733,
      -1.86540117741125e-15, 2.07489834093561e-15, -2.01425648327293e-15,
      -3.0985711491265e-15, 0.0224885576359423, 0.00295719976112434,
      -0.000487139396508805, -0.0971968675735148, -0.0560261273282672,
      -0.00738294389829847, -0.213687650066721, -2.47490008110439e-15,
      1.41687725694217e-15, 0.0231821699166157, 1.22945578427567e-15,
      7.18458677718756e-15, 9.4422942632327e-16, 4.42941530470848e-15,
      -0.0397360323317157, 3.85578528860991e-16, 1.07411134800809e-16,
      6.69748218953333e-17, 1.1141557098623e-17, -3.10792969146951e-16,
      -2.88547198189128e-15, 0.080826184336932, -0.237093351644533,
      -7.29232179709167e-15, 0.0872762454681855, -0.298555090304013,
      -0.0332201374887998, -0.00383816329925286, -5.33205323914201e-15,
      -4.18443319279994e-16, 4.05234974463837e-16, -8.90135643086639e-17,
      -8.03118073281385e-16, 1.18351420823867e-16, -6.06942889340151e-16,
      0.237093351644528, 0.0808261843369315, 8.34711905120197e-16,
      -0.298555090304007, -0.0872762454681893, 0.00383816329925134,
      -0.0332201374887988, -2.74691479486124e-15, 0.00140228882283225,
      -0.000841200980844305, 0.000228283370354589, 0.0614528757574807,
      -0.00267585927798504, -0.0413656372156248, 1.23670211657106e-15,
      -1.5603002750043e-15, 0.270148915305808, 5.57283709070582e-15,
      -6.35991343126821e-15, 1.85085561513198e-15, 4.04405212157976e-15,
      -0.0306389648980741, -0.0138059040412811, 3.76128419757317e-05,
      0.0637867706827337, -0.0823913529114872, -0.0191279996914322,
      -0.558338506326475, 5.53923975429884e-15, -1.77472391950269e-14,
      0.0907175185508152, 1.34504096412449e-14, -3.60892647367994e-14,
      1.72008467466855e-14, 1.92748037677391e-14, -0.105246077382104,
      -1.03254978113202e-15, 7.45835502055374e-17, -1.94697802666788e-16,
      5.29016316513683e-15, 8.70973247559763e-16, 8.84765695545977e-15,
      0.0824429425232541, -0.241835906552213, -6.63796175288888e-15,
      0.0483606649018616, -0.165432444985214, -0.0692536154575837,
      -0.00800137221826922, -8.10448810711708e-15, 1.40789014385572e-15,
      -1.89346658953285e-16, 1.60411915043837e-16, -2.10324056589983e-16,
      -9.07605369030771e-16, 3.74636850529808e-15, 0.241835906552208,
      0.0824429425232508, -3.15443783877008e-15, -0.165432444985219,
      -0.0483606649018621, 0.00800137221826205, -0.069253615457585,
      -4.84920674395122e-15, 0.00700743980691881, 0.00267712276165067,
      0.0056769531133128, 0.00740975149563536, -0.0312452348026251,
      -0.0256171225213577, 1.08166921426221e-15, -1.60295604258143e-15,
      0.125666128060674, 4.57365798419821e-15, -5.2987974624495e-15,
      -8.4564533021426e-15, -1.62333258425e-14, 0.142184115363128,
      0.00108055712241893, -0.000651848057427765, 0.000901718896716222,
      -0.0116681308261667, -0.00293127116620374, -0.133186577862739,
      -0.136004213061135, 0.026869194737739, 0.0837804619852712,
      0.15899809874993, 0.166353873425238, 0.00978341356812485,
      0.0225979351687188, -0.037294158270942, 0.00143364782177838,
      0.000466130501247529, -0.0145902249709652, 0.00188680940613495,
      -0.0116617031142296, -0.0217674903396561, -0.0750878880868259,
      0.0148344749183826, 0.0670426020954009, 0.167991540010987,
      0.175763380840497, -0.0321636088742215, -0.074292182689662,
      0.0213094107307608, 0.0010805571224192, -0.000651848057427863,
      0.000901718896716334, -0.0116681308261666, -0.00293127116620425,
      -0.133186577862741, 0.0912715117526815, 0.104348506163788,
      0.0837804619852755, -0.223565729779162, 0.0545194559582456,
      0.0146786791451214, -0.0197716522700741, -0.037294158270946,
      0.00143364782177645, 0.000466130501247241, -0.0145902249709651,
      0.00188680940613384, -0.0116617031142287, -0.0217674903396673,
      0.0503909761745335, 0.057610781140531, 0.0670426020954097,
      -0.236211322868397, 0.0576032508501583, -0.0482571130747295,
      0.0650005937072738, 0.0213094107307701, 0.00108055712241882,
      -0.000651848057427287, 0.000901718896716292, -0.0116681308261646,
      -0.00293127116620315, -0.133186577862732, 0.0447327013084515,
      -0.13121770090152, 0.0837804619852602, 0.0645676310292318,
      -0.220873329383474, -0.0244620927132381, -0.0028262828986297,
      -0.0372941582709489, 0.00143364782177877, 0.000466130501246697,
      -0.0145902249709648, 0.00188680940612633, -0.0116617031142321,
      -0.0217674903396851, 0.0246969119122907, -0.0724452560589018,
      0.0670426020954002, 0.0682197828574002, -0.233366631690626,
      0.0804207219489353, 0.00929158898237096, 0.0213094107307792,
      -0.981967681837632, 0.000284709086421325, 0.000134339014472953,
      0.244087239864368, -0.00256608725669541, -0.068203279823324,
      -1.25513174997397e-15, 2.49562031581238e-15, -0.032501362453109,
      -3.09799953270661e-16, -1.10184671716668e-15, 7.2942413108213e-16,
      1.13682629606614e-15, -0.00944557286391486, -0.0960906696585202,
      -0.000399668261926068, -1.29953234236631e-05, -0.231696549015856,
      0.00489808847964564, 0.0597692136777229, 2.20295881654472e-15,
      -4.06913247075237e-15, 0.0373060033772037, -1.25179311355492e-16,
      9.07205108608268e-16, 2.48610157060364e-16, 4.07528338572298e-16,
      -0.00295109781929637, 1.4297854474945e-16, 5.37600871743551e-17,
      -2.77182713955743e-17, 4.29902735729858e-15, -1.0820473570769e-16,
      -2.60498952312299e-15, 0.128813603219993, -0.377858353396036,
      -1.15426284582869e-15, -0.100654266180675, 0.344318701702249,
      0.0107473384929076, 0.00124171792431742, 2.12655035444091e-15,
      7.24417780816158e-17, -7.81414840457858e-17, 1.1890554162404e-17,
      7.19884947155215e-16, -8.18113347882648e-17, -2.10622446738934e-16,
      0.37785835339604, 0.128813603219992, -5.13216963485886e-15,
      0.344318701702247, 0.100654266180671, -0.00124171792431662,
      0.0107473384929073, 6.03268774607735e-16, -0.00266042713551044,
      -7.24969048149806e-05, -0.00122013035999767, -0.0466752244231299,
      -0.00247013663880487, -0.157931715882792, -4.97589581491871e-15,
      6.21881291393915e-15, -0.415566876404381, -5.25773285122041e-15,
      5.44719547239701e-15, -3.77636124976364e-15, -5.90254085878773e-15,
      0.0464637431992585, 0.0334611065795785, 0.00149142181442292,
      -0.00474320642391708, -0.772851938279287, -0.000777923962867279,
      0.297743436214023, 2.81173210281477e-15, -4.58841016185823e-15,
      0.127259302583869, 1.62901900134544e-15, 5.75715710754443e-15,
      -7.87475363561279e-15, -1.25262910329912e-14, 0.101018624435789,
      9.99194953596156e-17, 7.00468025219071e-17, -9.34219829802839e-18,
      6.67824121562531e-15, -1.66176799220822e-16, -3.70940712391006e-15,
      0.14005018722544, -0.410819446199586, 2.26952706517736e-16,
      -0.120786973210493, 0.413188783510955, 0.0162412491505254,
      0.00187646924834674, 2.82678389029621e-15, -1.55990461268637e-16,
      3.43415596867522e-17, -3.98563280783925e-17, 9.32240499438042e-16,
      1.7020825648811e-17, -8.39997064209282e-16, 0.41081944619959,
      0.140050187225437, -5.76325737839402e-15, 0.413188783510954,
      0.120786973210489, -0.00187646924834537, 0.0162412491505254,
      1.11048548200211e-15, 0.00659920683435165, 0.000508940449310694,
      0.000909765271235383, -0.0654101041315042, -0.0074786366147989,
      -0.148959146179183, -6.85816508246803e-15, 1.05125684769098e-14,
      -0.499066210304825, -6.03803308351674e-15, 9.13468182253694e-15,
      -7.84516100122179e-15, -1.20328331667561e-14, 0.0945668672021729,
      0.000361558151585441, 0.981610316904251, 2.52430253562684e-05,
      0.000260430150005121, 0.253277683409867, -0.0190869333800856,
      1.7527022502141e-16, -9.31927329786123e-17, 0.009917796480067,
      1.98554750441052e-16, -3.47483783778485e-16, 6.39778784500779e-16,
      -2.56886857510888e-15, 0.00359679655101198, 0.000397174834003468,
      0.092656616528922, 0.000343553691355367, -0.000559169905879325,
      -0.227482128471185, 0.0153579490439111, -1.14398749257194e-18,
      2.75233453836468e-16, -0.00752017936903863, -4.04512426364963e-16,
      3.71093748966932e-16, -6.71486372647353e-16, 2.86399591509141e-15,
      -0.00443401960486776, -2.58422398543009e-18, -2.15508803565004e-18,
      -2.30342392204003e-18, -2.12132109571451e-17, -1.21443476090271e-15,
      -1.74277921945098e-16, 0.00172854151813439, -0.00507045712170167,
      -2.27803139265784e-16, 0.00442277285632576, -0.0151294472216482,
      0.504273758186281, 0.0582624028000882, 5.07758640053347e-14,
      -6.1756584246898e-17, -7.35370674941888e-17, 4.59420039934835e-18,
      -2.26688094253294e-17, 4.08561415531558e-15, -4.420623781852e-16,
      0.00507045712170143, 0.00172854151813423, 3.69260196857761e-16,
      -0.0151294472216479, -0.0044227728563266, -0.0582624028000888,
      0.504273758186281, 6.10963960256743e-14, -0.000244756099290502,
      -0.000344252497242355, -0.000435384168359957, 0.000455348461287099,
      0.00125355128522658, 0.0133117174321457, -1.52420708535824e-16,
      4.49422530613256e-16, -0.027549820203761, -1.35713345528152e-15,
      1.29698461277141e-15, 4.36705019588119e-14, 6.40205143606703e-14,
      -0.495082245780093, -0.000737823649294801, -0.0237848491641667,
      -0.000602783797108216, -0.000201550506288005, -0.8334772016955,
      0.0698302906036618, -6.42932920362872e-16, 1.73233282999585e-16,
      -0.0403246039420598, -7.21803939493138e-16, 4.1902377513486e-16,
      -1.66999927646079e-15, 8.37612421037034e-15, -0.0142087996176424,
      -6.92105177652466e-18, 2.14574914171352e-17, -1.41348511305747e-17,
      5.53192350693136e-17, -1.77344172115902e-15, -1.73746909798257e-16,
      0.00145668524386869, -0.0042730012506863, 1.52973628124161e-16,
      0.00477535303527012, -0.016335555557307, 0.640034091131815,
      0.0739477782017263, 6.54855109001485e-14, 6.8615285908767e-17,
      2.89209968782049e-17, 3.55187534510584e-18, 1.56997244453288e-17,
      5.61586730138525e-15, -3.30341696288985e-16, 0.00427300125068598,
      0.00145668524386839, 1.93361185910118e-16, -0.0163355555573061,
      -0.00477535303527112, -0.0739477782017262, 0.640034091131814,
      7.67743320783318e-14, 0.000751799608008414, 0.000654474172098166,
      0.00125822344330775, -0.00105229836602688, -0.000298780371278217,
      0.0061150721182163, -1.73203721377515e-16, 5.6751904187309e-16,
      -0.0257534219880749, -1.69566047939714e-15, 1.87487596489573e-15,
      5.45704185900182e-14, 8.22595594773918e-14, -0.629989093195035;
  Uref << 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0.461046440026197, 0.000712223885734792, 0.0688543872263418,
      0.461046406942583, 0.461046498923686, 0.589985099046646,
      -0.0688543846004076, 0.0688543555376969, -0.000712279496957578,
      0.000712282832688405, -0.0013425238594934, 0, 0, 0, -0.00756911141322762,
      0.500356898316461, 0.034400257284865, -0.0075690082984487,
      -0.00756906863156219, 0.00276160177965732, -0.0344002423889196,
      0.0344002515358348, -0.500356903904989, 0.500356905140526,
      -0.495176009352175, 0, 0, 0, -0.206449726267818, -0.0435995871700769,
      0.507369460866801, -0.206449794997088, -0.206449753912642,
      0.306478346371861, -0.507369435157263, 0.507369410411969,
      0.043599521283246, -0.0435994981944928, -0.015248747816518, 0, 0, 0,
      0.207060863278464, -0.00781487506138442, -0.332263782986654,
      0.42250540156013, -0.629566301697822, 1.14121950664725e-07,
      -0.495108376714332, -0.162844645745029, 0.00383022575632715,
      0.0116451101621917, 2.77318061397688e-08, 0, 0, 0, -0.607413919452656,
      -0.00893464033358181, -0.379869322343725, 0.483026914021896,
      0.124386928460163, 9.68338512863233e-08, 0.0978141871133932,
      0.477683531588796, -0.0112351597267193, -0.00230056345397476,
      6.75553868434559e-08, 0, 0, 0, -0.279035086227681, 0.0352227449026842,
      -0.259857229881082, -0.279035234498705, -0.279035039092543,
      0.745170544392211, 0.259857292404127, -0.259857296951607,
      -0.0352228302525796, 0.0352228805575153, 0.0695680769509894, 0, 0, 0,
      -0.141615975454417, 0.0323759433744608, 0.622721013864523,
      0.49032423085826, -0.348708259514758, 6.08812067505488e-08,
      0.44287400985283, -0.179847035662796, 0.00935049582550621,
      -0.0230255172725189, 1.47154090551181e-08, 0, 0, 0, 0.484415644787253,
      -0.00789529419072429, -0.15185871311648, -0.119564748613298,
      -0.364850859307126, 3.13084609077451e-08, 0.463362861535136,
      0.615221573669262, -0.0319860774914798, -0.0240907597651384,
      -2.62701211640497e-08, 0, 0, 0, 0.0112052254489913, 0.486252596915517,
      -0.0199865568896468, -0.00672375787402001, -0.00448147744413402,
      5.42383702344064e-08, 0.0133210599571539, 0.0333076088243284,
      0.810339034154758, 0.324086257314836, -1.88363367912098e-07, 0, 0, 0,
      0.00129455655707716, -0.654960774470282, 0.0269210526209246,
      0.00905672159389129, -0.0103512184753454, -1.06381303740402e-07,
      0.030769433070391, 0.00384834034200686, 0.093626805750828,
      0.748587500920539, -7.328977553659e-08, 0, 0, 0, 0.0151695369200042,
      0.282549570399105, 0.0495932151186627, 0.0151694822562793,
      0.0151695002582393, -0.0519792211739004, -0.0495931678872949,
      0.0495931905025895, -0.282549333650817, 0.282549647892804,
      0.86586758557591;
  target_precision = 2e-7;
#endif  // COMPUTE_ANGLE_THRESHOLD == 7

  // gamma < 1e-6 -> 0
#if COMPUTE_ANGLE_THRESHOLD == 6
  C << 0.000776767742576467, -3.66052824514382e-05, -0.987024180439494,
      -0.0505332856990214, 0.0103102788732936, 0.198023654536437,
      1.97053860240127e-15, -2.72046243428224e-16, 0.0260343669146735,
      -2.98243726401876e-16, -2.77365261102634e-15, 1.66759417179353e-15,
      -1.92392281639397e-15, -0.022488557635943, 0.00295719976112436,
      -0.000487139396509355, -0.0971968675735153, 0.0560261273282586,
      -0.00738294389829864, -0.213687650066709, 3.03475659533472e-15,
      -6.08394441943586e-16, -0.0231821699166248, -5.68429276763199e-16,
      -6.69530827038956e-15, -2.92972110837574e-15, 4.7126324343227e-15,
      0.0397360323317142, 4.15638014201192e-16, 1.06710209037619e-16,
      2.4022759301908e-17, -1.30721641188834e-16, 1.67371983409636e-17,
      -2.0474797149859e-15, -0.244922440040889, 0.052527400782007,
      9.62482430522506e-15, -0.0206191673047279, 0.310366130415551,
      -0.0236056242277973, 0.0236872019686285, -1.68084726296279e-15,
      -3.73738897199833e-16, 2.87692505784027e-16, -1.37571871199403e-16,
      7.62449098378896e-17, -1.87467407612056e-16, 2.5849082238853e-15,
      -0.052527400782004, -0.244922440040889, 2.27321952603697e-15,
      -0.310366130415543, -0.0206191673047204, -0.0236872019686292,
      -0.0236056242277955, -4.94575857860108e-16, 0.00140228882283191,
      -0.000841200980844276, 0.000228283370354598, -0.0614528757574788,
      -0.00267585927798488, -0.0413656372156226, -5.01619542385825e-15,
      2.12248924537024e-15, -0.270148915305804, -1.13209922297165e-15,
      7.35503678976881e-15, -2.34637712101554e-15, 3.09167185120756e-15,
      0.0306389648980742, -0.013805904041281, 3.76128419765954e-05,
      0.0637867706827342, 0.0823913529115074, -0.0191279996914284,
      -0.558338506326497, -2.45431254196586e-14, 7.0343491594248e-15,
      -0.090717518550787, 1.0792981229199e-14, 4.12052611356298e-14,
      -8.24015908047634e-15, 6.09666594496382e-15, 0.105246077382118,
      -1.04676153731952e-15, 3.18923830542217e-17, 1.69674081030189e-16,
      -1.39119908376855e-15, 3.09699865567919e-16, -2.92060816059757e-15,
      -0.249821599430901, 0.0535781011944878, 6.01390023885332e-15,
      -0.0114252925893873, 0.171977063740453, -0.0492103569246036,
      0.0493804210459586, -2.11311018618327e-15, 1.32628625858592e-15,
      1.99707953338543e-16, 4.29629317676152e-16, 6.57711431563277e-16,
      -4.5472932440754e-16, -2.32151684721924e-15, -0.0535781011944841,
      -0.249821599430899, 2.58381456873715e-15, -0.171977063740443,
      -0.0114252925893909, -0.0493804210459645, -0.0492103569246011,
      3.09979733021086e-16, 0.00700743980691925, 0.00267712276165064,
      0.00567695311331284, -0.00740975149563583, -0.0312452348026244,
      -0.0256171225213603, -4.8684877643734e-15, 5.51299485835054e-16,
      -0.125666128060674, 1.97478748921627e-15, 7.18361370544978e-15,
      1.02705366977252e-14, -1.34328208938657e-14, -0.142184115363127,
      0.00108055712241889, -0.000651848057427763, 0.0009017188967161,
      0.0116681308261657, -0.00293127116620412, -0.133186577862739,
      0.0929514941286823, 0.10285484595038, -0.0837804619852762,
      0.206476263901078, -0.101595073970775, 0.0237967098109902,
      0.00633233425411221, 0.0372941582709478, 0.00143364782177815,
      0.000466130501247427, -0.0145902249709648, -0.00188680940613727,
      -0.0116617031142314, -0.0217674903396635, 0.0513184939756227,
      0.0567861317534201, -0.0670426020954186, 0.21815522211377,
      -0.10734161645998, -0.0782332323503043, -0.0208179610104205,
      -0.0213094107307778, 0.0010805571224192, -0.000651848057427871,
      0.000901718896716322, 0.0116681308261659, -0.00293127116620442,
      -0.13318657786274, 0.0425991624310223, -0.131925778210354,
      -0.0837804619852757, -0.191222046908591, -0.128016152831448,
      -0.00641439257618553, -0.023774722349856, 0.0372941582709478,
      0.00143364782177628, 0.000466130501246903, -0.0145902249709653,
      -0.00188680940613907, -0.0116617031142307, -0.0217674903396556,
      0.0235189856933093, -0.0728361853435595, -0.06704260209542,
      -0.202038177794509, -0.135257156088788, 0.021087733085137,
      0.0781609471407385, -0.0213094107307774, 0.00108055712241877,
      -0.000651848057427258, 0.000901718896716389, 0.0116681308261645,
      -0.00293127116620307, -0.133186577862734, -0.135550656559699,
      0.0290709322599719, -0.0837804619852607, -0.0152542169924904,
      0.22961122680221, -0.0173823172348122, 0.0174423880957547,
      0.0372941582709457, 0.00143364782177861, 0.000466130501246492,
      -0.0145902249709654, -0.00188680940613531, -0.0116617031142329,
      -0.0217674903396636, -0.0748374796689172, 0.0160500535901319,
      -0.067042602095409, -0.0161170443192805, 0.242598772548734,
      0.0571454992651727, -0.0573429861303209, -0.0213094107307734,
      -0.981967681837633, 0.000284709086425899, 0.00013433901447311,
      -0.244087239864369, -0.00256608725669541, -0.068203279823323,
      2.81550445135251e-15, -7.71431244253054e-16, 0.0325013624531065,
      3.76203945960325e-17, 1.22089894549082e-15, -7.31542352568802e-16,
      8.0983350552368e-16, 0.00944557286391521, -0.0960906696585209,
      -0.000399668261925702, -1.29953234237002e-05, 0.231696549015859,
      0.00489808847964574, 0.0597692136777215, -4.48327749043406e-15,
      9.95045186997574e-16, -0.0373060033771995, 2.06244212014955e-16,
      -9.86428388899704e-16, -1.86129858992353e-16, 2.7760399433129e-16,
      0.00295109781929596, 1.20078078546287e-16, 5.22584635442673e-17,
      -1.95640529284275e-17, -4.39409848957934e-15, -7.85696895800522e-17,
      -2.54587243372456e-15, -0.390335660032977, 0.0837135121250556,
      6.39773930601244e-15, 0.0237797483516778, -0.357940181050702,
      0.00763686285157757, -0.00766325478311289, -1.81368886650555e-16,
      1.34809244632366e-16, -6.72759374093894e-17, 1.95764547803538e-17,
      2.248908492988e-16, -6.21126805517747e-17, 2.68580621997275e-16,
      -0.0837135121250596, -0.390335660032975, -2.81662539012657e-15,
      0.357940181050704, 0.0237797483516836, 0.00766325478311323,
      0.00763686285157707, 1.58098320712043e-16, -0.00266042713551062,
      -7.24969048150633e-05, -0.00122013035999769, 0.0466752244231261,
      -0.00247013663880476, -0.157931715882796, 1.20823239178704e-14,
      -3.60724720243756e-15, 0.41556687640438, 1.91544608595712e-15,
      -5.94518903708615e-15, 3.38020430502402e-15, -4.04844896542595e-15,
      -0.046463743199259, 0.0334611065795791, 0.00149142181442276,
      -0.00474320642391713, 0.772851938279284, -0.000777923962867671,
      0.297743436214022, -6.16689609553967e-15, 1.55449512259563e-15,
      -0.127259302583865, -5.04699999461891e-16, -6.12266983388746e-15,
      7.39504882005778e-15, -8.84448185271279e-15, -0.101018624435791,
      1.11314725121886e-16, 7.67757750541786e-17, -4.83094924082814e-17,
      -7.12547007765565e-15, -6.00326207455112e-17, -2.49380226847672e-15,
      -0.424385165090233, 0.0910159544748559, 6.37092111894528e-15,
      0.0285361359840465, -0.429534809601854, 0.0115407356326144,
      -0.0115806188033091, -5.46597455531944e-17, -1.67994035618212e-16,
      -2.24289497241684e-17, -6.97719790245175e-17, -3.06964016560303e-16,
      2.75700260440318e-18, 2.93802029125954e-16, -0.0910159544748612,
      -0.424385165090228, -3.39472083029422e-15, 0.429534809601856,
      0.0285361359840536, 0.0115806188033101, 0.0115407356326139,
      -6.41778782216758e-17, 0.00659920683435175, 0.000508940449310734,
      0.000909765271235428, 0.0654101041314964, -0.00747863661479972,
      -0.148959146179189, 1.73929486704293e-14, -5.39586394539557e-15,
      0.499066210304823, 2.5446630116165e-15, -9.17191794280062e-15,
      6.99602622339488e-15, -8.13614274309956e-15, -0.0945668672021745,
      0.000361558151589998, 0.981610316904251, 2.52430253563928e-05,
      -0.000260430150005084, 0.253277683409868, -0.0190869333800854,
      -2.37819604999373e-16, -1.2947032191024e-16, -0.00991779648006706,
      -7.62657347589219e-17, 2.07637506202189e-16, -8.38271900549649e-16,
      -2.46360207947133e-15, -0.00359679655101067, 0.000397174834003865,
      0.0926566165289221, 0.000343553691355421, 0.000559169905879172,
      -0.227482128471184, 0.0153579490439108, 1.52425552646823e-16,
      -2.02593462260494e-17, 0.00752017936903866, -7.09217860414682e-17,
      -2.79501662844518e-16, 8.74109906623553e-16, 2.77932429930573e-15,
      0.00443401960486662, -2.29145289575518e-18, 1.44166692916912e-17,
      -7.47506830352827e-18, 1.20306650896857e-17, -1.32463179908976e-15,
      -1.10033858148713e-16, -0.00523788930290933, 0.00112334627492548,
      2.48754942946009e-16, -0.00104488790719892, 0.0157279783263037,
      0.358327741650594, -0.35956607228566, 5.26301500214037e-14,
      -6.17238747383902e-17, -6.86152689395783e-17, 1.09861851532401e-18,
      9.83134101568792e-19, 4.35188982924406e-15, -3.04857468595638e-16,
      -0.00112334627492582, -0.00523788930290942, -2.94326059756206e-16,
      -0.0157279783263038, -0.0010448879071978, 0.35956607228566,
      0.358327741650595, -8.93558500367249e-15, -0.000244756099290522,
      -0.000344252497242424, -0.000435384168359963, -0.000455348461287049,
      0.00125355128522323, 0.0133117174321455, 6.62452320283842e-16,
      -2.26458496995037e-16, 0.0275498202037608, 1.17695441501227e-17,
      -1.55903524835112e-15, -2.99043931639484e-14, 4.07793396793682e-14,
      0.495082245780089, -0.000737823649294917, -0.0237848491641667,
      -0.000602783797108244, 0.00020155050628828, -0.833477201695501,
      0.069830290603661, 8.06945101768137e-16, 3.31043728566981e-16,
      0.0403246039420602, 5.08915943317695e-16, -5.78198278931432e-16,
      2.44333770529694e-15, 7.90961917605376e-15, 0.0142087996176382,
      -7.78945339446714e-18, 1.31453340393971e-17, 1.77276215021475e-18,
      9.22428266686948e-18, -1.97670899426407e-15, -3.54042906135761e-16,
      -0.00441410054460244, 0.000946672049974641, -3.66185465266507e-16,
      -0.00112818559787069, 0.0169818011186708, 0.45479655986766,
      -0.456368273266717, 6.58482620265959e-14, 6.84856647848127e-17,
      2.87480175305509e-17, 1.45346478707696e-17, 3.87241921028621e-18,
      5.95928743708735e-15, -3.71980795645226e-16, -0.000946672049975225,
      -0.00441410054460258, -8.23228321376841e-17, -0.0169818011186701,
      -0.0011281855978693, 0.456368273266716, 0.454796559867659,
      -1.01664034236297e-14, 0.000751799608008467, 0.000654474172098189,
      0.00125822344330776, 0.00105229836602664, -0.000298780371281494,
      0.00611507211821651, 7.27000082192597e-16, -5.76344046925446e-16,
      0.0257534219880745, -3.5849736834228e-16, -2.34189605137756e-15,
      -3.80549131824355e-14, 5.33087477863803e-14, 0.629989093195038;
  Uref << 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0.461046723919265, -0.000712416132578782, -0.0688543089451581,
      -0.461046626427385, -0.461046602165329, 0.589984617245198,
      -0.0688546818501385, 0.0688542238254986, -0.000711902277404933,
      0.00071178716221353, -0.00134181775845368, 0, 0, 0, 0.00756853348336047,
      0.500356840141963, 0.0343999961442002, -0.00756854771190295,
      -0.00756875816664828, -0.0027616618880189, 0.0344005916026637,
      -0.0344006822296859, 0.500356795215496, -0.50035703369589,
      0.495176032306236, 0, 0, 0, 0.206448978548292, -0.0435996406952511,
      0.507369813461096, -0.206450557802864, -0.20644911675321,
      -0.306478176005401, 0.507369614642363, -0.50736921763016,
      -0.0435992752868292, 0.043599840625715, 0.0152488758291726, 0, 0, 0,
      -0.197105681961235, 0.0116067089185036, -0.33837833187297,
      0.430342679789265, -0.627449391029344, -8.18008662215676e-07,
      -0.155079113461579, -0.493458197415383, -0.00795898484646509,
      0.00364817010944247, -3.90689219165362e-07, 0, 0, 0, 0.61071695278922,
      -0.00248865861364288, -0.374433495543616, 0.476056221606581,
      0.134658997595943, -1.12749360536321e-06, 0.480261301101576,
      0.105827636895733, -0.00880810294590135, -0.0112963294818171,
      3.07664268011241e-08, 0, 0, 0, -0.279034076226738, -0.0352241334762208,
      0.25985692228262, 0.2790364040827, 0.279034369952902, 0.745170930890042,
      0.259857165252191, -0.259856822594549, -0.0352221182397976,
      0.035223647847405, 0.0695686455392679, 0, 0, 0, -0.419428648227817,
      0.00220858522864808, -0.575119387589732, -0.452809807103517,
      0.0333819908794288, 1.01836113508471e-06, 0.532630376909958,
      -0.042488787201719, -0.0299012554580547, -0.0276919115834999,
      8.97354418958171e-08, 0, 0, 0, -0.28070247783481, -0.0332512947201373,
      0.282983300666224, 0.222883767552305, -0.503586972636698,
      -2.70878936310314e-07, 0.356576306569793, 0.639560076580968,
      0.0147134497996081, -0.0185383242183754, -2.34994575781149e-07, 0, 0, 0,
      -0.00293876103785574, -0.575802518461308, -0.0324026974804396,
      -0.0109002663807977, 0.0079611239788915, -8.44471866886392e-07,
      0.00873434376540113, -0.0236676397924134, 0.788302197957944,
      0.212494451796479, -5.12875321615772e-06, 0, 0, 0, -0.0108892584246833,
      0.577810960656244, -0.00862188951544106, -0.00289933658940047,
      -0.0079902620199477, 3.98835715117634e-07, 0.0323716915343871,
      0.0237499444763417, 0.209756736047682, 0.787565524754214,
      -1.87060875170759e-06, 0, 0, 0, 0.0151693327812283, -0.28255154335931,
      -0.0495934315076282, -0.015169454147172, -0.0151698076832966,
      -0.0519801502747559, -0.0495934989048681, 0.0495934543912873,
      -0.282544392680187, 0.282552482305971, 0.865867525588247;
  target_precision = 5e-11;
#endif  // COMPUTE_ANGLE_THRESHOLD == 6

  // gamma < 1e-5 -> 0
#if COMPUTE_ANGLE_THRESHOLD == 5
  C << 0.000776767742576582, -3.66052824514743e-05, -0.987024180439495,
      -0.0505332856990222, -0.0103102788732926, -0.198023654536436,
      -1.76421337691794e-15, -4.29311048294125e-16, -0.0260343669146668,
      1.43096866096153e-15, 3.25586655654352e-15, 7.53505475848814e-18,
      -5.81235089878742e-16, -0.0224885576359421, 0.00295719976112448,
      -0.000487139396509213, -0.097196867573515, 0.0560261273282671,
      0.00738294389829789, 0.213687650066721, -2.95176984571882e-15,
      1.31088940609652e-15, 0.0231821699166112, -3.71669441665198e-16,
      6.69133149287364e-15, -2.31298147112456e-15, 1.91040847187358e-15,
      0.0397360323317144, 4.49879341897154e-16, 1.55860573218543e-16,
      1.42706446567191e-16, 1.90279793207731e-16, 1.11581825463998e-16,
      2.44958471506483e-15, 0.249116007903545, 0.0262172476570006,
      -4.11390813977156e-15, -0.0523913939087947, -0.30660630589364,
      -0.0325558936271627, 0.00764348234926027, 1.61124908879989e-15,
      -3.0647383394654e-16, 1.90764121922586e-16, -1.36837440681852e-16,
      2.11795197398591e-16, -2.95142177542748e-16, -1.3004017891408e-15,
      0.0262172476569959, -0.249116007903549, -2.13863882226128e-15,
      0.306606305893631, -0.0523913939088036, -0.00764348234926037,
      -0.0325558936271614, -1.11395583229845e-16, 0.00140228882283206,
      -0.000841200980844307, 0.00022828337035445, -0.0614528757574813,
      0.00267585927798497, 0.0413656372156294, -6.59856051441676e-16,
      -1.40041811612146e-15, 0.27014891530581, -3.43322028382222e-15,
      -6.70635725733861e-15, -8.95871385381555e-16, 1.28242341000712e-15,
      0.0306389648980777, -0.0138059040412815, 3.76128419761369e-05,
      0.0637867706827333, 0.0823913529114933, 0.0191279996914244,
      0.558338506326456, 2.39469659278576e-14, 9.29466694080053e-16,
      0.0907175185507762, -1.39843651518348e-14, -4.69125372587265e-14,
      7.4588138081705e-15, 5.27630347857837e-16, 0.105246077382105,
      -1.04497541184922e-15, 3.01387202213914e-17, -4.96978557630314e-16,
      -3.45884947363513e-15, -7.64396500211313e-16, -8.17714000741462e-15,
      0.254099050817528, 0.0267416686737901, -1.3806022825236e-15,
      -0.0290306100013054, -0.169893706318051, -0.0678688743805997,
      0.0159342744307104, -1.71477506624195e-16, 1.33094251510597e-15,
      4.73184440391405e-16, 3.34928874273366e-16, -6.77223217840783e-16,
      -3.50674953640075e-16, -3.15663447002568e-17, 0.026741668673787,
      -0.254099050817521, -4.1254714217945e-15, 0.169893706318035,
      -0.0290306100013078, -0.0159342744307135, -0.0678688743806049,
      -6.36767123565843e-17, 0.00700743980691919, 0.00267712276165059,
      0.0056769531133125, -0.00740975149563776, 0.0312452348026236,
      0.0256171225213569, 2.34371565679856e-15, -1.19740522680043e-15,
      0.125666128060678, -4.00904074938019e-15, -8.19864628854186e-15,
      4.08059118992043e-15, -5.02001365941299e-15, -0.142184115363124,
      0.00108055712241897, -0.000651848057427729, 0.000901718896716165,
      0.0116681308261671, 0.00293127116620339, 0.133186577862743,
      -0.0815015973891158, 0.112145393214603, 0.08378046198527,
      -0.177060489108557, 0.146981596828678, 0.0168608044199342,
      0.0179470089220224, 0.0372941582709469, 0.00143364782177841,
      0.000466130501247624, -0.0145902249709648, -0.0018868094061351,
      0.0116617031142317, 0.0217674903396701, -0.0449970091801563,
      0.0619154403060118, 0.0670426020954136, -0.187075596968181,
      0.155295346288139, -0.0554309919427774, -0.0590019599407346,
      -0.0213094107307703, 0.00108055712241924, -0.000651848057427941,
      0.000901718896716354, 0.0116681308261666, 0.00293127116620344,
      0.133186577862744, -0.0563699607466851, -0.126655150395294,
      0.0837804619852715, 0.215820041296716, 0.079848083160171,
      0.0071121634384486, -0.0235753894169125, 0.0372941582709467,
      0.00143364782177646, 0.000466130501246926, -0.0145902249709651,
      -0.00188680940613358, 0.0116617031142309, 0.021767490339674,
      -0.0311218396014347, -0.069926273197345, 0.0670426020954195,
      0.228027513459117, 0.0843645462585337, -0.0233817002103593,
      0.0775056271497793, -0.0213094107307713, 0.00108055712241882,
      -0.000651848057427262, 0.000901718896716234, 0.0116681308261645,
      0.00293127116620249, 0.133186577862732, 0.13787155813579,
      0.0145097571806876, 0.0837804619852589, -0.0387595521881552,
      -0.226829679988838, -0.0239729678583848, 0.00562838049489446,
      0.0372941582709471, 0.0014336478217788, 0.00046613050124668,
      -0.0145902249709641, -0.00188680940612753, 0.0116617031142335,
      0.021767490339695, 0.0761188487815713, 0.00801083289133101,
      0.0670426020954103, -0.0409519164909229, -0.239659892546632,
      0.0788126921531264, -0.0185036672090441, -0.0213094107307703,
      -0.981967681837633, 0.000284709086429876, 0.000134339014473072,
      -0.244087239864368, 0.0025660872566952, 0.0682032798233231,
      -2.03972451337034e-15, 1.72054936333578e-17, -0.032501362453109,
      -3.44868637844255e-17, -1.31808889346712e-15, -1.23533333002545e-16,
      2.62395126053345e-16, 0.00944557286391459, -0.0960906696585206,
      -0.000399668261925366, -1.29953234232652e-05, 0.23169654901585,
      -0.00489808847964557, -0.0597692136777197, 3.70572324218744e-15,
      -2.30778835271172e-16, 0.0373060033772013, -8.24715636822899e-17,
      1.16394822058828e-15, 1.85507119613234e-17, 1.12995810639632e-16,
      0.00295109781929718, 1.33691554030387e-16, 5.29058470056474e-17,
      -3.64585071192001e-17, -4.21049869432885e-15, 6.59466466449655e-17,
      2.10343870040556e-15, 0.397018996518085, 0.0417827238154743,
      3.50247051389282e-15, 0.0604221375448114, 0.353604036935119,
      0.0105324431263477, -0.00247281011704903, -5.89310186486703e-16,
      1.395908129695e-16, -6.07668186979853e-17, 1.73068650609436e-17,
      3.72907037075515e-16, -4.61714105750072e-17, 4.77926808221256e-16,
      0.0417827238154808, -0.397018996518083, -4.73356644295069e-15,
      -0.353604036935125, 0.0604221375448043, 0.00247281011704964,
      0.0105324431263474, 7.11288166626301e-17, -0.00266042713551065,
      -7.24969048151146e-05, -0.00122013035999762, 0.0466752244231262,
      0.00247013663880395, 0.157931715882784, -2.86413248322433e-15,
      4.11044853640126e-15, -0.415566876404376, 2.97386048244264e-15,
      6.34371008243723e-15, 5.34144708346323e-16, -1.3102173990976e-15,
      -0.0464637431992587, 0.0334611065795789, 0.00149142181442265,
      -0.00474320642391758, 0.772851938279291, 0.000777923962868476,
      -0.297743436214022, 2.94111891783398e-15, -7.82709337397314e-16,
      0.127259302583877, 5.61960270131743e-16, 6.48984357927007e-15,
      1.14832437243846e-15, -2.96992560475336e-15, -0.101018624435787,
      1.03167179692729e-16, 7.35909891626801e-17, 3.27565279958269e-17,
      -7.0081449653955e-15, 1.29565306486534e-16, 3.2815825608423e-15,
      0.431651498013409, 0.0454274870578085, 4.28471504716006e-15,
      0.0725076778747344, 0.424331356802494, 0.0159165018475635,
      -0.00373688101844354, -8.21520868356212e-16, -1.72522773838465e-16,
      -5.53045163363017e-17, -6.12180651512208e-17, 2.39223361684273e-18,
      -7.63765311350958e-18, 9.09694916781992e-16, 0.0454274870578169,
      -0.431651498013403, -5.43782066665235e-15, -0.424331356802498,
      0.0725076778747262, 0.00373688101844441, 0.0159165018475639,
      2.55622273977382e-16, 0.00659920683435181, 0.000508940449310713,
      0.000909765271235254, 0.0654101041314969, 0.00747863661479905,
      0.148959146179177, -6.78313026982786e-15, 4.03317503579744e-15,
      -0.499066210304828, 3.62506059197052e-15, 1.04024542726193e-14,
      7.44399078578921e-16, -2.66420052123311e-15, -0.0945668672021742,
      0.000361558151594178, 0.981610316904251, 2.52430253561183e-05,
      -0.000260430150005242, -0.253277683409868, 0.0190869333800847,
      -8.14292871635917e-17, 1.51591630629305e-16, 0.00991779648006663,
      -3.33963949563859e-16, -1.1300716780088e-16, 2.32740068764239e-16,
      -2.49431675368119e-15, -0.00359679655100983, 0.00039717483400426,
      0.092656616528922, 0.000343553691355311, 0.000559169905879162,
      0.227482128471183, -0.01535794904391, -6.65385525879833e-17,
      -1.80916934817323e-16, -0.00752017936903832, 2.9913014183179e-16,
      2.41480484910605e-16, -3.19368843724607e-16, 2.84912254399866e-15,
      0.0044340196048649, -2.58851457194205e-18, 1.79242367298541e-17,
      9.37318789252788e-19, 2.6064073388501e-17, 1.34994083706557e-15,
      1.87587787039612e-16, 0.00532757256853958, 0.000560679703466429,
      3.95220358601964e-16, -0.0026549633710971, -0.0155374471027083,
      0.494190694906556, -0.116026237735807, 5.60106887462192e-15,
      -6.2223041088597e-17, -6.62300770822905e-17, 2.53600145243263e-18,
      1.28858407310088e-17, -4.21601492276796e-15, 4.12292234114148e-16,
      0.000560679703465831, -0.00532757256853913, 3.23380119987078e-16,
      0.0155374471027076, -0.00265496337109788, 0.116026237735807,
      0.494190694906556, -1.64283420782008e-14, -0.000244756099290522,
      -0.000344252497242408, -0.00043538416835995, -0.000455348461286901,
      -0.00125355128522258, -0.0133117174321463, -5.40966390127963e-17,
      -7.15548013104892e-17, -0.0275498202037623, 1.18842911306867e-15,
      1.2228619674291e-15, -6.1809270816195e-16, 1.57156354282057e-14,
      0.495082245780088, -0.000737823649295039, -0.0237848491641666,
      -0.000602783797108159, 0.000201550506288525, 0.833477201695503,
      -0.069830290603659, 1.25869821986143e-16, -3.754934938491e-16,
      -0.0403246039420587, 1.23218438174017e-15, 3.68484201240166e-16,
      -6.4132476048003e-16, 7.65536282745193e-15, 0.0142087996176363,
      -6.78731921282445e-18, 1.09842670848078e-17, -2.4152064689721e-17,
      -3.68084184475397e-17, 1.91927092111717e-15, 1.83809109439342e-16,
      0.00448967887945592, 0.000472498833269539, 3.44997148686185e-16,
      -0.00286661508618202, -0.016776080886937, 0.627236470519411,
      -0.147262764344065, 5.97000237491957e-15, 7.00720209310224e-17,
      2.79954139534798e-17, 1.04242429085699e-17, -4.11115862535069e-17,
      -5.84031762542398e-15, 3.36391382512224e-16, 0.000472498833269148,
      -0.00448967887945614, 2.14095090146537e-16, 0.0167760808869356,
      -0.00286661508618301, 0.147262764344064, 0.62723647051941,
      -2.001367677611e-14, 0.000751799608008464, 0.000654474172098178,
      0.00125822344330774, 0.0010522983660265, 0.000298780371283407,
      -0.00611507211821742, -2.63516997978062e-16, -4.79463996078888e-16,
      -0.0257534219880768, 1.73446401171103e-15, 1.77576829669796e-15,
      -1.6152701150581e-15, 2.0960739968297e-14, 0.629989093195039;
  Uref << 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0.461042275158979, 0.00071102449851105, 0.0688522712597961,
      0.461050451596232, -0.461047368928516, -0.589984494855899,
      0.0688500588723067, -0.0688611265877694, 0.000715468528928201,
      0.000708345635686985, -0.00133461941378128, 0, 0, 0, -0.0075682027124769,
      0.500353243208169, 0.0343999611260031, -0.00756562324679244,
      0.00756726293545596, -0.00276486282223824, 0.0344002099078577,
      -0.0344027405421775, 0.500359335589787, 0.500358447382342,
      -0.495175612107654, 0, 0, 0, -0.206451614153951, -0.0436080715589779,
      0.507369634447276, -0.206444075416085, 0.206448194897712,
      -0.306473967954649, 0.507372917676466, -0.507370203097575,
      -0.0435973583961694, -0.04359700277465, -0.0152507629748769, 0, 0, 0,
      -0.638297713174427, -0.00698317554273848, -0.29671659846733,
      0.261704683982965, -0.376585600605548, 9.02615090875604e-06,
      -0.205196120764054, -0.501908808770883, 0.0118021188596436,
      -0.0048247504240103, -1.18975221686392e-06, 0, 0, 0, -0.0663240333500158,
      0.00960499101967976, 0.408246454749735, 0.585944021673106,
      0.519617386894661, 8.74570218514175e-06, -0.461085020242565,
      -0.0528428718494496, 0.00124624391385024, -0.0108515175292418,
      1.95739079381066e-06, 0, 0, 0, 0.279039435435469, -0.035231819000895,
      0.259855419185656, 0.279027123665527, -0.279041897926873,
      0.745172173812396, 0.259854179170578, -0.259851537279787,
      -0.0352218065034276, -0.0352206414208731, -0.0695751626879916, 0, 0, 0,
      -0.0843339662056602, -0.0256358992039166, -0.493182056762376,
      0.473106104558477, 0.388762883551021, 6.23613324092477e-06,
      0.60114268113198, 0.10796177246927, -0.00561027614804597,
      0.0312463321551691, 1.58449399388365e-06, 0, 0, 0, -0.497599432804928,
      0.0212791502158645, 0.409401428465803, 0.175766218457156,
      -0.321838592308242, -1.65175702593609e-06, 0.222403863170638,
      0.631809210554787, -0.0328416488337879, 0.0115628179068049,
      -2.21333237822551e-06, 0, 0, 0, -0.0109820551017858, -0.558412641674272,
      0.0229459585177604, 0.00326953217511585, -0.00770824268530949,
      2.2781301042219e-06, 0.00968571442073734, 0.0326399544549908,
      0.794182688303302, -0.235738772093454, 3.82258974041953e-05, 0, 0, 0,
      0.00256423248641777, -0.594629952386125, 0.0244340164972885,
      -0.0107859994299298, -0.00822329810864023, -5.57504656422878e-06,
      -0.032101222636634, -0.007650211574267, -0.186300394264128,
      0.780916648311684, -9.11312734138019e-06, 0, 0, 0, 0.0151665770439361,
      0.282564507092818, 0.0495954235705004, 0.0151669019146224,
      -0.0151716858321048, 0.0519883589777033, 0.0495951214188434,
      -0.0495975364577123, 0.282513444895574, 0.282568724716018,
      0.86586721925104;
  target_precision = 1e-12;
#endif  // COMPUTE_ANGLE_THRESHOLD == 5

  auto C_ta = math::eigen_to_array<Tile, Policy>(
      TA::get_default_world(), C, TA::TiledRange1{0, size_t(C.rows())},
      TA::TiledRange1{0, size_t(C.cols())});
  auto U_ta = localizer.compute(C_ta, 3);
  auto U = math::array_to_eigen(U_ta);

  std::cout << U - Uref << std::endl;
  REQUIRE((U - Uref).lpNorm<Eigen::Infinity>() < target_precision);

  mpqc::lcao::scf::FosterBoysLocalizer<Tile, Policy> localizer1(
      KeyVal{}.assign("max_iter", 1).assign("convergence", 1e20));
  localizer1.initialize(ao_s, {ao_x, ao_y, ao_z});

  RowMatrixXd C1(33, 14);
  C1 << 0.000776767742576378, -3.66052824513071e-05, -0.987024180439495,
      -0.0505332856990213, 0.0103102788732924, 0.198023654536436,
      2.10215702220764e-15, -1.38319069185225e-15, 0.0260343669146699,
      -3.34234279946398e-16, 3.18128034557884e-15, -1.68281264085689e-15,
      -2.8381530850658e-15, 0.0224885576359428, 0.00295719976112465,
      -0.000487139396509049, -0.0971968675735157, 0.0560261273282662,
      -0.0073829438982982, -0.213687650066717, 1.70746472688205e-15,
      1.96342985566539e-15, -0.0231821699166174, -4.15608398291056e-15,
      3.07497592804207e-15, 4.08594617926574e-15, 3.90344310571251e-15,
      -0.0397360323317118, 4.37829802953787e-16, 9.59721732843351e-17,
      -3.16244782565051e-17, 2.0693849412919e-16, -3.44326070042809e-16,
      -4.96517195324482e-16, -0.201084885399029, 0.149368665832444,
      9.33428962707632e-15, 0.00594524167264372, -0.310993471106559,
      0.0333635406282294, 0.00227666181835057, 3.24164108632488e-16,
      -2.27406020152132e-16, 2.99018873861816e-16, -6.97215978059864e-17,
      -2.53894968511782e-17, 1.0629090303209e-17, 1.43311458070037e-15,
      -0.149368665832443, -0.201084885399032, -1.61311002933109e-15,
      0.310993471106555, 0.00594524167263683, 0.0022766618183517,
      -0.0333635406282284, -2.82253303961249e-15, 0.00140228882283224,
      -0.00084120098084413, 0.000228283370354482, -0.06145287575748,
      -0.00267585927798463, -0.0413656372156256, -6.41046350665813e-16,
      5.48769510053028e-15, -0.270148915305806, -4.20351370273182e-16,
      -9.54660444106974e-15, 2.7244222011112e-15, 3.76309202080312e-15,
      -0.0306389648980769, -0.0138059040412816, 3.76128419755899e-05,
      0.063786770682736, 0.0823913529114894, -0.0191279996914229,
      -0.558338506326472, -2.09897320010588e-14, 5.52688300242016e-15,
      -0.0907175185507822, 1.14411086910599e-14, -3.29147099738853e-14,
      4.67278685869521e-15, 1.70244823739226e-14, -0.10524607738212,
      -1.0170710629589e-15, -9.34751715037019e-17, 3.83534217364376e-16,
      -4.0729639616226e-15, 6.26153340540698e-16, 2.44119296259654e-15,
      -0.205107166511061, 0.152356472509798, 4.66239245353089e-15,
      0.00329431953387698, -0.172324679667018, 0.0695525662333539,
      0.00474612912568805, -9.87733470761853e-16, 1.3255109010809e-15,
      6.50288897303812e-18, 1.12218203091855e-16, -7.72872465344862e-16,
      -1.58332560975842e-15, 1.98296150423603e-15, -0.152356472509792,
      -0.205107166511059, -6.97471065096655e-16, 0.172324679667004,
      0.00329431953387851, 0.00474612912569414, -0.0695525662333623,
      -7.05983379467285e-15, 0.00700743980691895, 0.0026771227616508,
      0.0056769531133129, -0.00740975149563343, -0.0312452348026228,
      -0.0256171225213567, -2.84594268004711e-15, 1.29555390710019e-15,
      -0.125666128060676, 1.38562790022888e-15, -7.13816498037334e-15,
      -1.2525571117165e-14, -1.55683585738058e-14, 0.14218411536312,
      0.00108055712241892, -0.000651848057427688, 0.000901718896716069,
      0.0116681308261673, -0.00293127116620319, -0.133186577862742,
      0.127236313716015, 0.055045618065333, -0.0837804619852716,
      -0.20145025521725, 0.111228599211603, -0.0137356933934793,
      0.0204380180530022, -0.0372941582709446, 0.00143364782177843,
      0.000466130501247516, -0.0145902249709654, -0.00188680940613552,
      -0.0116617031142323, -0.0217674903396675, 0.0702471333045774,
      0.0303906703765384, -0.0670426020954171, -0.212844926295529,
      0.117520044715827, 0.0451569860404969, -0.0671913145901134,
      0.0213094107307691, 0.00108055712241918, -0.000651848057427842,
      0.000901718896716145, 0.0116681308261667, -0.00293127116620353,
      -0.133186577862742, -0.0159472532464168, -0.137712688994623,
      -0.0837804619852747, 0.197051920153231, 0.118846739011195,
      -0.0108319961401571, -0.0221144684438431, -0.0372941582709486,
      0.00143364782177653, 0.00046613050124713, -0.0145902249709652,
      -0.00188680940613354, -0.0116617031142304, -0.0217674903396716,
      -0.00880447406816141, -0.07603113717306, -0.0670426020954208,
      0.208197807325542, 0.125569090880644, 0.0356108923284466,
      0.0727027543644575, 0.0213094107307826, 0.00108055712241877,
      -0.000651848057427102, 0.000901718896716352, 0.0116681308261644,
      -0.00293127116620228, -0.133186577862731, -0.111289060469591,
      0.0826670709292884, -0.0837804619852571, 0.00439833506401951,
      -0.230075338222788, 0.0245676895336453, 0.00167645039085457,
      -0.0372941582709458, 0.0014336478217788, 0.000466130501246769,
      -0.0145902249709661, -0.00188680940612646, -0.0116617031142342,
      -0.0217674903396787, -0.061442659236402, 0.0456404667965255,
      -0.0670426020954071, 0.00464711896997759, -0.243089135596449,
      -0.0807678783689441, -0.00551143977435786, 0.021309410730777,
      -0.981967681837632, 0.000284709086395241, 0.000134339014472829,
      -0.244087239864368, -0.00256608725669555, -0.0682032798233228,
      1.6140447132173e-15, -1.73536712673805e-15, 0.0325013624531073,
      9.41835566122312e-17, -1.10777080413669e-15, 7.60661425423109e-16,
      1.13180345726555e-15, -0.00944557286391442, -0.0960906696585206,
      -0.00039966826192876, -1.29953234235873e-05, 0.23169654901585,
      0.00489808847964574, 0.0597692136777187, -3.09718026377307e-15,
      2.63188640529796e-15, -0.0373060033771992, -1.70415095958616e-16,
      1.10655540726649e-15, 2.48657609008897e-16, 3.65416391932522e-16,
      -0.0029510978192979, 1.3386530913552e-16, 4.81618142719001e-17,
      -1.18848981081511e-17, -4.16562805052163e-15, -1.23901356349143e-16,
      -1.7941136909559e-15, -0.320471253886627, 0.238050530430006,
      1.89131150872078e-15, -0.00685654996517817, 0.358663682807264,
      -0.010793732102234, -0.000736542863615244, 5.27059103018523e-16,
      1.31215733759472e-16, -7.25562596577864e-17, 1.00143003466627e-17,
      2.28481348308807e-16, -1.2927226780328e-16, 2.37925109637797e-16,
      -0.238050530430009, -0.320471253886626, -5.62202993522382e-15,
      -0.358663682807267, -0.00685654996518301, -0.000736542863615647,
      0.0107937321022338, 8.16587876747958e-16, -0.00266042713551044,
      -7.24969048150534e-05, -0.00122013035999764, 0.0466752244231254,
      -0.00247013663880362, -0.157931715882789, 4.22894090114767e-15,
      -9.05626621144745e-15, 0.415566876404377, -9.37433600557009e-16,
      7.53703131048877e-15, -3.52539593492477e-15, -5.49970228857809e-15,
      0.0464637431992584, 0.0334611065795786, 0.00149142181442379,
      -0.00474320642391754, 0.772851938279293, -0.000777923962867647,
      0.297743436214024, -2.19806102735842e-15, 4.1877939678722e-15,
      -0.127259302583871, -1.01386494098609e-15, 4.76848668906989e-15,
      -8.07479541765755e-15, -1.19391265103086e-14, 0.101018624435788,
      9.99922609181219e-17, 9.70168701409234e-17, -7.62074893667179e-17,
      -6.6725680842564e-15, -1.63199502801374e-16, -2.18148533571193e-15,
      -0.348426392750947, 0.258815998640297, 1.00934344193069e-15,
      -0.00822798623829371, 0.430403025034776, -0.0163113586170279,
      -0.00111305474987255, 8.30075658249856e-16, -1.71405340685154e-16,
      2.22897990955671e-18, -3.51916197311766e-17, -2.56216427925584e-16,
      3.15292822803758e-17, -1.19671708704393e-16, -0.258815998640299,
      -0.34842639275094, -6.20877289237523e-15, -0.430403025034775,
      -0.00822798623829979, -0.00111305474987283, 0.0163113586170288,
      1.57126206757945e-15, 0.00659920683435165, 0.000508940449310862,
      0.000909765271235123, 0.0654101041314978, -0.00747863661479887,
      -0.148959146179182, 7.43885132938904e-15, -1.23763549099409e-14,
      0.499066210304827, -2.64240654792503e-15, 1.000225704012e-14,
      -7.24747755060985e-15, -1.12822681052861e-14, 0.0945668672021747,
      0.000361558151559139, 0.981610316904251, 2.52430253565102e-05,
      -0.000260430150005351, 0.253277683409867, -0.0190869333800842,
      -3.28653910345529e-16, 1.64081576545464e-16, -0.00991779648006658,
      3.17605887894946e-17, -4.39857330983167e-16, -6.87208543400444e-16,
      -2.73689043352087e-15, 0.00359679655100986, 0.000397174834000947,
      0.092656616528922, 0.00034355369135544, 0.000559169905879666,
      -0.227482128471184, 0.0153579490439099, 1.57743082501968e-16,
      -1.30064685848313e-16, 0.00752017936903829, 1.8565951314317e-16,
      3.82112245849363e-16, 1.00046120186813e-15, 2.99211912056413e-15,
      -0.00443401960486508, -2.68589668616168e-18, 2.26864600721584e-17,
      -1.03999072066866e-17, 3.33945252381335e-17, -9.9432147098185e-16,
      -1.27938108723552e-16, -0.0043003832969843, 0.00319438487066812,
      1.65180829380674e-16, 0.000301278467617242, -0.0157597691688775,
      -0.506450583615704, -0.0345591830150014, -3.81220521515597e-14,
      -6.19405506756542e-17, -7.79557596710952e-17, 4.86589258820157e-18,
      2.04581560860368e-17, 4.1927842428812e-15, -3.77843289193074e-16,
      -0.00319438487066774, -0.004300383296984, -2.65642466319598e-16,
      0.0157597691688764, 0.000301278467617043, -0.0345591830150006,
      0.506450583615703, 5.93732437932687e-14, -0.000244756099290498,
      -0.000344252497242406, -0.000435384168359972, -0.000455348461287231,
      0.00125355128522259, 0.0133117174321461, 1.31675462252498e-16,
      -7.24908549441084e-16, 0.0275498202037626, 3.47528738628971e-16,
      1.85234764718925e-15, 3.19814842587187e-14, 5.91622144016146e-14,
      -0.495082245780088, -0.00073782364929418, -0.0237848491641666,
      -0.000602783797108244, 0.000201550506288872, -0.833477201695501,
      0.0698302906036568, 1.06342054860814e-15, -6.25257268113016e-16,
      0.0403246039420586, -1.81653992054307e-16, 1.34417903109727e-15,
      2.25886059823882e-15, 8.80379221723056e-15, -0.0142087996176364,
      -6.31656834405272e-18, 1.10380835417559e-17, 1.01315038467258e-17,
      -4.61801293038765e-17, -1.56513561807355e-15, -3.07767948189494e-16,
      -0.00362404074531992, 0.00269198816199773, -3.14371725186622e-16,
      0.000325296164088569, -0.0170161263036874, -0.642796960431793,
      -0.0438631892542256, -4.76269035255768e-14, 6.92787058569652e-17,
      2.98302951936603e-17, 2.32169623856658e-18, -3.46926185798699e-17,
      5.75256157700933e-15, -3.25228334591889e-16, -0.00269198816199769,
      -0.00362404074531956, -1.75147377186258e-16, 0.0170161263036858,
      0.000325296164088111, -0.0438631892542252, 0.642796960431792,
      7.42482404180029e-14, 0.000751799608008418, 0.000654474172098202,
      0.00125822344330779, 0.00105229836602682, -0.000298780371283471,
      0.00611507211821741, 2.02767534905681e-16, -8.78223480185965e-16,
      0.0257534219880772, 5.93924603023809e-16, 2.58332569163118e-15,
      4.14407373288704e-14, 7.62917298139682e-14, -0.629989093195039;
  RowMatrixXd U1ref(14, 14);
  U1ref << 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0.838243768712187, 0.0108415063660903, 0.0528567547502203,
      0.251097420462515, -0.252080092458232, 0.408911077162743,
      -0.0232972491935711, 0.00860681268575769, -0.00305120704986135,
      0.00267201921860237, 0.000405257132086747, 0, 0, 0, 0.0044823714443139,
      0.431771374943499, 0.0437703383752363, -0.0222906895019945,
      0.0102799258945381, 0.000230868974345315, -0.00988272549416146,
      0.0238910704812146, 0.476988647513169, -0.529760030745831,
      -0.549729596296761, 0, 0, 0, 0.208310421499577, -0.0227879740578296,
      0.569761396917625, -0.449698509783336, 0.173862466976027,
      -0.146367508135221, -0.315750493544573, 0.523468993603638,
      -0.0467657860569087, 0.0409013155034332, -0.000977118185417492, 0, 0, 0,
      -0.0312275903542826, -0.000428385164385465, 0.0661210867585299,
      0.770651035002302, -0.0535943598237032, -0.471038121979345,
      -0.226463367546346, 0.352999369769446, 0.0100180217551127,
      -0.00156061886346089, 0.00183364954317236, 0, 0, 0, 0.0848771130551899,
      0.00116324551515324, -0.121370109884345, 0.146142388464042,
      0.725151708327059, 0.173708757614866, -0.555507529645122,
      -0.303148719692651, -0.00733722159263083, -0.0119312666336213,
      0.00159279952334632, 0, 0, 0, -0.491740356856404, -0.0192384700859108,
      0.283407601967158, 0.226913551618679, -0.16600184609657,
      0.714503159293934, -0.188989893040995, 0.216534420067473,
      -0.040786969630513, 0.0249785713572685, -0.05521282218593, 0, 0, 0,
      0.0351833339537974, 0.000522915544901572, 0.439723021866411,
      0.253259015915479, 0.517616940673029, 0.0736763908212978,
      0.683181609172562, -0.016729902857769, -0.00243275275885878,
      0.0287706729834155, -0.00769519084358986, 0, 0, 0, 0.0417302871030616,
      0.00051721377629168, -0.612225942506977, -0.0574678734778577,
      0.286007616416101, 0.201882385745881, 0.190588998259692,
      0.678133180183247, 0.0314892019535173, 0.0192094664667149,
      -0.00538055577340157, 0, 0, 0, -0.000728931629521008, -0.431594589937054,
      0.027148025547958, -0.00536824032991703, -0.0073654413148543,
      0.0108522626176656, -0.0238272024772016, -0.0175505167205006,
      0.819552955660375, 0.374254134191797, 0.0133702529637186, 0, 0, 0,
      -0.000815609275339577, 0.608963240552261, -0.0188733065393378,
      -0.00143436057982489, -0.00806039991540981, -0.0211513717566441,
      -0.0144901040216196, -0.0262756036579571, -0.0168522819472675,
      0.748093759494921, -0.259738048636299, 0, 0, 0, -0.0310759579947603,
      0.505424905415857, 0.0443795377315057, -0.000724233311133207,
      -0.000974983355703762, 0.0452985694526273, -0.0151910393648117,
      0.0282412496102879, 0.309061764696328, -0.126484574810685,
      0.791840333041421;
  auto C1_ta = math::eigen_to_array<Tile, Policy>(
      TA::get_default_world(), C1, TA::TiledRange1{0, size_t(C1.rows())},
      TA::TiledRange1{0, size_t(C1.cols())});
  auto U1_ta = localizer1.compute(C1_ta, 3);
  auto U1 = math::array_to_eigen(U1_ta);

  std::cout << U1 - U1ref << std::endl;
  REQUIRE((U1 - U1ref).lpNorm<Eigen::Infinity>() < 1e-14);
}