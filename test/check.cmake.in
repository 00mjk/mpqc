set(overall_result_code 0)
set(MPQC_INTEGRAL_FACTORY_LIST "@MPQC_INTEGRAL_FACTORY_LIST@")
foreach(intf IN LISTS MPQC_INTEGRAL_FACTORY_LIST)
  execute_process(COMMAND make -f check.mk ${CHECKLEVEL}_chk MPQCRUN_ARGS=--integral=${intf} RESULT_VARIABLE result_code ERROR_QUIET)
  if(NOT "${result_code}" STREQUAL "0")
    set(overall_result_code 1)
  endif()
endforeach()

if(${overall_result_code} EQUAL 0)
  message(STATUS "CHECKS PASSED")
else()
  message(FATAL_ERROR "CHECKS FAILED")
endif()
